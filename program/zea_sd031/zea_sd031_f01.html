<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ZEA_SD031_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEA_SD031_F01</h2>
<h3> Description: Include YE12_PJ034_F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YE12_PJ034_F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA .<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;고객&nbsp;데이터<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_KNA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_BPDATA<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;판매오더&nbsp;HEADER&nbsp;ALV<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA1.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;GT_DATA1&nbsp;BY&nbsp;VBELN&nbsp;ODDAT&nbsp;ASCENDING.<br />
<br />
   </div>
   <div class="codeComment">
*CLEAR&nbsp;GS_BPDATA.<br />
<br />
***&nbsp;판매오더&nbsp;ITEM&nbsp;ALV<br />
****&nbsp;&nbsp;SELECT&nbsp;*<br />
****&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A<br />
****&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT010&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
****&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;C~MATNR<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;C~SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
******&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;D&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;D~MATNR<br />
******&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT190&nbsp;AS&nbsp;E&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;E~MATNR<br />
****&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA2.<br />
****<br />
****&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;VBELN&nbsp;POSNR&nbsp;DESCENDING.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY1.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY1.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;ZEA_KNA1-CUSCODE&nbsp;IS&nbsp;INITIAL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY1&nbsp;BY&nbsp;VBELN.<br />
*<br />
*&nbsp;&nbsp;ELSE.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY1<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY1&nbsp;BY&nbsp;VBELN.<br />
*<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_0100 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;the&nbsp;Screen&nbsp;CustCtrl&nbsp;Name&nbsp;to&nbsp;Link&nbsp;Container&nbsp;To<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_0100 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID1-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SDT040'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_TOOLBAR[]<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_ALV_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_ALV_0100 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID1-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_DATA .<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-03'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-07'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-08'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-10'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-12'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-15'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-17'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-23'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA-05'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA9-05'<br />
&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA9-02'.<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;'0100'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DISPLAY_DATA .<br />
<br />
   </div>
   <div class="codeComment">
*SELECT&nbsp;SINGLE&nbsp;*<br />
*&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_DISPLAY1.<br />
**&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;GS_BPDATA-CUSCODE.<br />
*<br />
*IF&nbsp;ZEA_KNA1-CUSCODE&nbsp;IS&nbsp;INITIAL.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY1<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
*&nbsp;&nbsp;ELSE.<br />
*ENDIF.<br />
<br />
***&nbsp;ALV1&nbsp;데이터&nbsp;채우기<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY1.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA1&nbsp;INTO&nbsp;GS_DATA1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA1&nbsp;TO&nbsp;GS_DISPLAY1.<br />
<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
*TOTAMT&nbsp;"&nbsp;이거&nbsp;아이템&nbsp;테이블&nbsp;전체&nbsp;합산해서&nbsp;넣어줘야함.<br />
*STATUS&nbsp;"&nbsp;상태테이블<br />
*&nbsp;&nbsp;&nbsp;1.&nbsp;초록&nbsp;:&nbsp;아이템&nbsp;테이블&nbsp;작성&nbsp;완료<br />
*&nbsp;&nbsp;&nbsp;2.&nbsp;노랑&nbsp;:&nbsp;아이템&nbsp;테이블&nbsp;미작성.<br />
*&nbsp;&nbsp;&nbsp;3.&nbsp;빨강&nbsp;:&nbsp;삭제/취소<br />
*&nbsp;&nbsp;&nbsp;4.&nbsp;회색&nbsp;:&nbsp;완료된&nbsp;건.<br />
*IT_FIELD_COLORS&nbsp;"&nbsp;셀별&nbsp;색깔<br />
<br />
<br />
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY1&nbsp;TO&nbsp;GT_DISPLAY1.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;Cell&nbsp;단위&nbsp;색상&nbsp;테이블에&nbsp;사용할&nbsp;작업공간<br />
&nbsp;&nbsp;DATA:&nbsp;LS_CELL_COLOR&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GS_DISPLAY1-CELL_COLOR.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;GS_DISPLAY.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;오늘과&nbsp;같거나&nbsp;이전이면&nbsp;비행기는&nbsp;출발<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-FLDATE&nbsp;LE&nbsp;SY-DATUM.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아이콘은&nbsp;SE38&nbsp;에서&nbsp;SHOWICON&nbsp;프로그램을&nbsp;실행하면&nbsp;확인가능<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;ICON_OKAY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-CANCELLED&nbsp;EQ&nbsp;ABAP_ON.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;취소된&nbsp;예약건이면&nbsp;빨간색<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-LIGHT&nbsp;=&nbsp;'1'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;취소가&nbsp;안된&nbsp;예약건이면&nbsp;초록색<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-LIGHT&nbsp;=&nbsp;'3'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;흡연자일&nbsp;경우<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-SMOKER&nbsp;EQ&nbsp;ABAP_ON.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_CELL_COLOR.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;흡연여부&nbsp;필드에&nbsp;주황색&nbsp;배경(C710)으로&nbsp;표시한다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_CELL_COLOR-FNAME&nbsp;=&nbsp;'SMOKER'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_CELL_COLOR-COLOR-COL&nbsp;=&nbsp;7.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_CELL_COLOR-COLOR-INT&nbsp;=&nbsp;1.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_CELL_COLOR-COLOR-INV&nbsp;=&nbsp;0.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;LS_CELL_COLOR&nbsp;INTO&nbsp;TABLE&nbsp;GS_DISPLAY-CELL_COLOR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY&nbsp;TO&nbsp;GT_DISPLAY.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
*****&nbsp;ALV2&nbsp;데이터&nbsp;채우기<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A<br />
**&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;D&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;D~MATNR<br />
**&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT190&nbsp;AS&nbsp;E&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;E~MATNR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ORDER&nbsp;BY&nbsp;PRIMARY&nbsp;KEY.<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
**<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
**<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
**<br />
***신규&nbsp;필드------------------------------------------------------------*<br />
**<br />
***TOTAMT&nbsp;"&nbsp;이거&nbsp;아이템&nbsp;테이블&nbsp;전체&nbsp;합산해서&nbsp;넣어줘야함.<br />
***STATUS&nbsp;"&nbsp;상태테이블<br />
***&nbsp;&nbsp;&nbsp;1.&nbsp;초록&nbsp;:&nbsp;아이템&nbsp;테이블&nbsp;작성&nbsp;완료<br />
***&nbsp;&nbsp;&nbsp;2.&nbsp;노랑&nbsp;:&nbsp;아이템&nbsp;테이블&nbsp;미작성.<br />
***&nbsp;&nbsp;&nbsp;3.&nbsp;빨강&nbsp;:&nbsp;삭제/취소<br />
***&nbsp;&nbsp;&nbsp;4.&nbsp;회색&nbsp;:&nbsp;완료된&nbsp;건.<br />
***IT_FIELD_COLORS&nbsp;"&nbsp;셀별&nbsp;색깔<br />
**<br />
**<br />
***--------------------------------------------------------------------*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
**<br />
**&nbsp;&nbsp;ENDLOOP.<br />
**<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA_CONDITION<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA_CONDITION .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZEA_KNA1-CUSCODE&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY1.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY1&nbsp;BY&nbsp;VBELN&nbsp;DESCENDING.<br />
<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY1&nbsp;LINES&nbsp;GV_LINES.<br />
&nbsp;&nbsp;IF&nbsp;GT_DISPLAY1&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S033&nbsp;.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY&nbsp;LIKE&nbsp;'I'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ELSEIF&nbsp;GT_DISPLAY1&nbsp;IS&nbsp;INITIAL&nbsp;AND&nbsp;ZEA_KNA1-CUSCODE&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ELSEIF&nbsp;GT_DISPLAY1&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Module&nbsp;INIT_DATA_0100&nbsp;OUTPUT<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
MODULE INIT_DATA_0100 OUTPUT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;ZEA_KNA1.<br />
&nbsp;&nbsp;ZEA_KNA1-CUSCODE&nbsp;&nbsp;=&nbsp;GS_BPDATA-CUSCODE.<br />
&nbsp;&nbsp;ZEA_KNA1-SAKNR&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-SAKNR.<br />
&nbsp;&nbsp;ZEA_KNA1-BPCUS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-BPCUS.<br />
&nbsp;&nbsp;ZEA_KNA1-BPCSNR&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-BPCSNR.<br />
&nbsp;&nbsp;ZEA_KNA1-BPHAED&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-BPHAED.<br />
&nbsp;&nbsp;ZEA_KNA1-BPSTAT&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-BPSTAT.<br />
&nbsp;&nbsp;ZEA_KNA1-ZLSCH&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-ZLSCH.<br />
&nbsp;&nbsp;ZEA_KNA1-LAND1&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-LAND1.<br />
&nbsp;&nbsp;ZEA_KNA1-BPADRR&nbsp;&nbsp;&nbsp;=&nbsp;GS_BPDATA-BPADRR.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
*&nbsp;여신&nbsp;신호등<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;LS_KNKK&nbsp;TYPE&nbsp;ZEA_KNKK.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_KNKK<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LS_KNKK<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;LS_KNKK-STATUS_K.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'G'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON&nbsp;=&nbsp;ICON_GREEN_LIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'Y'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON&nbsp;=&nbsp;ICON_YELLOW_LIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'R'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON&nbsp;=&nbsp;ICON_RED_LIGHT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON&nbsp;=&nbsp;ICON_LIGHT_OUT.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDMODULE.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_0100_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_0100_2 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_0100_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_0100_2 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SDT050'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Internal&nbsp;Output&nbsp;Table&nbsp;Structure&nbsp;Name<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Save&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Output&nbsp;Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Catalog<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Sort&nbsp;Criteria<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Criteria<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Wrong&nbsp;Parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Program&nbsp;Errors<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Too&nbsp;many&nbsp;Rows&nbsp;in&nbsp;Ready&nbsp;for&nbsp;Input&nbsp;Grid<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_0100_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_0100_2 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE.<br />
<br />
&nbsp;&nbsp;GS_VARIANT2-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GV_SAVE2&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
&nbsp;&nbsp;"&nbsp;'U'&nbsp;:&nbsp;저장한&nbsp;사용자만&nbsp;사용가능<br />
&nbsp;&nbsp;"&nbsp;'X'&nbsp;:&nbsp;Layout을&nbsp;저장하면&nbsp;모든&nbsp;사용자가&nbsp;사용&nbsp;가능<br />
&nbsp;&nbsp;"&nbsp;'A'&nbsp;:&nbsp;Layout을&nbsp;저장할&nbsp;때&nbsp;'U'/'X'&nbsp;선택&nbsp;가능<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'D'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-EXCP_FNAME&nbsp;=&nbsp;'LIGHT'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등<br />
*&nbsp;&nbsp;GS_LAYOUT-EXCP_LED&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등&nbsp;모양&nbsp;변경<br />
*&nbsp;&nbsp;GS_LAYOUT-CTAB_FNAME&nbsp;=&nbsp;'IT_FIELD_COLORS'.&nbsp;"&nbsp;셀&nbsp;별&nbsp;색상<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_0100_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_0100_2 .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;자재명&nbsp;플랜트명&nbsp;같은건&nbsp;C500<br />
*&nbsp;수량은&nbsp;C300<br />
*&nbsp;돈&nbsp;관련은&nbsp;노랑색<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GS_FIELDCAT-KEY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;ABAP_OFF.&nbsp;&nbsp;"&nbsp;키필드는&nbsp;수정&nbsp;불가능<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;"&nbsp;이외&nbsp;필드&nbsp;수정&nbsp;가능<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'VBELN'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;'판매오더번호'.<br />
&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_SDT050'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'VBELN'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-HOTSPOT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'POSNR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F01.&nbsp;"&nbsp;문서&nbsp;INDEX<br />
&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;4.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-HOTSPOT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F02.&nbsp;"&nbsp;자재코드<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F08.&nbsp;"&nbsp;자재명<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;28.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'CALQTY'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F09.&nbsp;"&nbsp;재고&nbsp;수량<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_MMT190'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C300'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'CALQTY'.<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;7.<br />
<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'AUQUA'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F03.&nbsp;"&nbsp;주문&nbsp;수량<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_SDT050'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C300'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'AUQUA'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F04.&nbsp;"&nbsp;단위<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F05.&nbsp;"&nbsp;판매단가<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_SDT050'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'AUAMO'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F06.&nbsp;"&nbsp;주문&nbsp;금액<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ZEA_SDT050'.<br />
&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'NETPR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F07.&nbsp;"&nbsp;통화코드<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_HEADER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DATA.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
&nbsp;&nbsp;DATA&nbsp;LT_SDT040&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT040.<br />
&nbsp;&nbsp;DATA&nbsp;LS_SDT040&nbsp;TYPE&nbsp;ZEA_SDT040.<br />
&nbsp;&nbsp;DATA&nbsp;LV_YEAR&nbsp;TYPE&nbsp;N&nbsp;LENGTH&nbsp;4.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;&nbsp;맨&nbsp;처음에&nbsp;입력필드&nbsp;확인하기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;ZEA_SDT040-ODDAT&nbsp;IS&nbsp;INITIAL<br />
&nbsp;&nbsp;OR&nbsp;(&nbsp;GS_RBGROUP-RA2&nbsp;EQ&nbsp;ABAP_ON&nbsp;AND&nbsp;ZEA_SDT040-SADDR&nbsp;IS&nbsp;INITIAL&nbsp;)<br />
&nbsp;&nbsp;OR&nbsp;ZEA_SDT040-VDATU&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;WITH&nbsp;'값을&nbsp;입력해주세요.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GV_MODE1&nbsp;=&nbsp;ABAP_OFF.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
******&nbsp;판매오더번호&nbsp;채번<br />
***&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'&nbsp;"&nbsp;채번&nbsp;과정<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;number<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_VBELN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;number&nbsp;range&nbsp;object<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-VBELN&nbsp;&nbsp;"&nbsp;free&nbsp;number<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;not&nbsp;found<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;is&nbsp;not&nbsp;internal<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Object&nbsp;not&nbsp;defined&nbsp;in&nbsp;TNRO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;1<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;used&nbsp;up.&nbsp;Change&nbsp;not&nbsp;possible.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffer&nbsp;is&nbsp;full<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
***&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
***&nbsp;&nbsp;ENDIF.<br />
***<br />
***&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'00'&nbsp;IN&nbsp;ZEA_SDT040-VBELN&nbsp;&nbsp;WITH&nbsp;'SB'.<br />
<br />
***&nbsp;인터널&nbsp;테이블에&nbsp;데이터&nbsp;넣기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY1.<br />
&nbsp;&nbsp;GS_DISPLAY1-VBELN&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
&nbsp;&nbsp;GS_DISPLAY1-CUSCODE&nbsp;=&nbsp;ZEA_KNA1-CUSCODE.&nbsp;"&nbsp;고객코드&nbsp;-&gt;&nbsp;같은&nbsp;테이블의&nbsp;나머지&nbsp;내용&nbsp;같이<br />
&nbsp;&nbsp;IF&nbsp;GS_RBGROUP-RA1&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY1-SADDR&nbsp;=&nbsp;ZEA_KNA1-BPADRR.<br />
&nbsp;&nbsp;ELSEIF&nbsp;GS_RBGROUP-RA2&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY1-SADDR&nbsp;=&nbsp;ZEA_SDT040-SADDR.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;GS_DISPLAY1-VDATU&nbsp;=&nbsp;ZEA_SDT040-VDATU.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_DISPLAY1-ADATU&nbsp;=&nbsp;ZEA_SDT040-VDATU&nbsp;+&nbsp;3&nbsp;."&nbsp;예상납기일<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_DISPLAY1-ADATU&nbsp;=&nbsp;ZEA_SDT040-VDATU&nbsp;."&nbsp;예상납기일<br />
&nbsp;&nbsp;ZEA_SDT040-ADATU&nbsp;=&nbsp;ZEA_SDT040-VDATU&nbsp;."&nbsp;예상납기일<br />
&nbsp;&nbsp;GS_DISPLAY1-ODDAT&nbsp;=&nbsp;ZEA_SDT040-ODDAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;*&nbsp;&nbsp;GS_DISPLAY1-TOAMT&nbsp;=&nbsp;ZEA_SDT050-<br />
*&nbsp;&nbsp;GS_DISPLAY1-WAERS&nbsp;=&nbsp;ZEA_SDT040-WAERS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_DISPLAY1-WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;GS_DISPLAY1-STATUS2&nbsp;=&nbsp;ZEA_SDT040-STATUS2.<br />
&nbsp;&nbsp;GS_DISPLAY1-ERDAT&nbsp;=&nbsp;SY-DATUM.&nbsp;"&nbsp;생성일자를&nbsp;오늘로<br />
&nbsp;&nbsp;GS_DISPLAY1-ERZET&nbsp;=&nbsp;SY-UZEIT.&nbsp;"&nbsp;생성시간을&nbsp;현재&nbsp;시간으로<br />
&nbsp;&nbsp;GS_DISPLAY1-ERNAM&nbsp;=&nbsp;SY-UNAME.&nbsp;"&nbsp;생성자를&nbsp;현재&nbsp;로그인한&nbsp;사용자ID<br />
&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY1&nbsp;TO&nbsp;GT_DISPLAY1.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;"&nbsp;생성&nbsp;관련&nbsp;정보를&nbsp;먼저&nbsp;설정<br />
**&nbsp;&nbsp;ZEA_SDT040-ERDAT&nbsp;=&nbsp;SY-DATUM.&nbsp;"&nbsp;생성일자를&nbsp;오늘로<br />
**&nbsp;&nbsp;ZEA_SDT040-ERZET&nbsp;=&nbsp;SY-UZEIT.&nbsp;"&nbsp;생성시간을&nbsp;현재&nbsp;시간으로<br />
**&nbsp;&nbsp;ZEA_SDT040-ERNAM&nbsp;=&nbsp;SY-UNAME.&nbsp;"&nbsp;생성자를&nbsp;현재&nbsp;로그인한&nbsp;사용자ID<br />
**&nbsp;&nbsp;ZEA_SDT040-CUSCODE&nbsp;=&nbsp;ZEA_KNA1-CUSCODE.&nbsp;"&nbsp;고객코드&nbsp;-&gt;&nbsp;같은&nbsp;테이블의&nbsp;나머지&nbsp;내용&nbsp;같이&nbsp;들어감<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;GS_RBGROUP-RA1&nbsp;=&nbsp;ABAP_ON.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-SADDR&nbsp;=&nbsp;ZEA_KNA1-BPADRR.<br />
**&nbsp;&nbsp;ELSEIF&nbsp;GS_RBGROUP-RA2&nbsp;=&nbsp;ABAP_ON.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;ZEA_SDT040-ADATU&nbsp;=&nbsp;ZEA_SDT040-VDATU&nbsp;+&nbsp;3&nbsp;."&nbsp;예상납기일<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;ZEA_SDT040-VBELN&nbsp;IS&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E000&nbsp;WITH&nbsp;'CHECK&nbsp;KEY&nbsp;FIELD.'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
**&nbsp;&nbsp;ELSEIF&nbsp;ZEA_SDT040-CUSCODE&nbsp;IS&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E000&nbsp;WITH&nbsp;'CHECK&nbsp;KEY&nbsp;FIELD.'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
**&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
*&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT040.<br />
*<br />
**&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_SDT040&nbsp;TO&nbsp;GS_DISPLAY1.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY1&nbsp;TO&nbsp;GT_DISPLAY1.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY1&nbsp;BY&nbsp;VBELN.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S015.&nbsp;&nbsp;"&nbsp;데이터&nbsp;성공적으로&nbsp;저장되었습니다.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
**&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.&nbsp;"&nbsp;데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E016.<br />
**&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
*아이템&nbsp;생성---------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;LT_SDT050&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT050,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT050&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT050,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DISPLAY2&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GT_DATA2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_DISPLAY2&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;GT_DATA2,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_UNIQUE&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GT_DATA2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GT_UNIQUE&nbsp;&nbsp;&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;GT_DATA2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;SY-TABIX.&nbsp;"&nbsp;POSNR&nbsp;설정위한&nbsp;인덱스&nbsp;변수&nbsp;선언<br />
<br />
&nbsp;&nbsp;LV_INDEX&nbsp;=&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_PRICE&nbsp;&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GT_DATA2.<br />
<br />
<br />
***&nbsp;-&gt;&nbsp;재고테이블&nbsp;변경전&nbsp;(플랜트별로&nbsp;재고나누어져있게&nbsp;바뀜)<br />
***&nbsp;완제품&nbsp;24종&nbsp;선택&nbsp;-&gt;&nbsp;모든데이터&nbsp;있는거&nbsp;아니면&nbsp;다&nbsp;안나오는데&nbsp;..&nbsp;맞나<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;FROM&nbsp;ZEA_MMT010&nbsp;AS&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR&nbsp;&nbsp;&nbsp;"&nbsp;자재명<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~SPRAS&nbsp;EQ&nbsp;@SY-LANGU<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;C&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;C~MATNR&nbsp;&nbsp;&nbsp;"&nbsp;가격<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT190&nbsp;AS&nbsp;D&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;D~MATNR&nbsp;&nbsp;&nbsp;"&nbsp;재고<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DATA2<br />
&nbsp;&nbsp;WHERE&nbsp;MATTYPE&nbsp;EQ&nbsp;'완제품'<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;D~WERKS&nbsp;EQ&nbsp;'10001'&nbsp;"&nbsp;RDC만<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;C~LOEKZ&nbsp;NE&nbsp;'X'.&nbsp;"&nbsp;삭제된&nbsp;가격&nbsp;제외<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DATA2-VALID_EN&nbsp;&gt;=&nbsp;SY-DATUM&nbsp;AND&nbsp;(&nbsp;GS_PRICE&nbsp;IS&nbsp;INITIAL&nbsp;OR&nbsp;GS_DATA2-VALID_EN&nbsp;&lt;&nbsp;GS_PRICE-VALID_EN&nbsp;).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_PRICE&nbsp;=&nbsp;GS_DATA2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
*&nbsp;2.&nbsp;가장&nbsp;최신&nbsp;날짜의&nbsp;레코드&nbsp;찾기<br />
*&nbsp;&nbsp;&nbsp;&nbsp;루프를&nbsp;사용하여&nbsp;각&nbsp;MATNR에&nbsp;대해&nbsp;가장&nbsp;최신의&nbsp;VALID_EN&nbsp;날짜를&nbsp;가진&nbsp;레코드를&nbsp;선택합니다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;MATNR&nbsp;VALID_EN&nbsp;ASCENDING.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;CHANGE&nbsp;OF&nbsp;GS_DATA2-MATNR.&nbsp;&nbsp;&nbsp;"&nbsp;자재별&nbsp;가격&nbsp;1개만&nbsp;뜨도록&nbsp;설정<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;=&nbsp;LV_INDEX&nbsp;+&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-VBELN&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;LV_INDEX&nbsp;*&nbsp;10.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-MEINS&nbsp;&nbsp;&nbsp;=&nbsp;'PKG'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WAERS&nbsp;&nbsp;&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERNAM&nbsp;&nbsp;&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERDAT&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERZET&nbsp;&nbsp;&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDON.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
**************&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
**************<br />
**************&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
**************<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;&nbsp;GS_DISPLAY2.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;MATNR&nbsp;MAKTX<br />
**************<br />
**************<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-VBELN&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;SY-TABIX&nbsp;*&nbsp;10.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-MEINS&nbsp;&nbsp;&nbsp;=&nbsp;'PKG'.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WAERS&nbsp;&nbsp;&nbsp;=&nbsp;'KRW'.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERNAM&nbsp;&nbsp;&nbsp;=&nbsp;SY-UNAME.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERDAT&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERZET&nbsp;&nbsp;&nbsp;=&nbsp;SY-UZEIT.<br />
**************&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
**************&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
*--------------------------------------------------------------------*<br />
****인덱스&nbsp;생성<br />
*&nbsp;&nbsp;SELECT&nbsp;MAX(&nbsp;POSNR&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;ZEA_SDT050-POSNR<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
*<br />
*&nbsp;&nbsp;ZEA_SDT050-POSNR&nbsp;=&nbsp;ZEA_SDT050-POSNR&nbsp;+&nbsp;10.<br />
*&nbsp;&nbsp;ZEA_SDT050-VBELN&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
*<br />
*<br />
****&nbsp;필드들<br />
*&nbsp;&nbsp;"&nbsp;생성&nbsp;관련&nbsp;정보를&nbsp;먼저&nbsp;설정<br />
*&nbsp;&nbsp;ZEA_SDT050-ERDAT&nbsp;=&nbsp;SY-DATUM.&nbsp;"&nbsp;생성일자를&nbsp;오늘로<br />
*&nbsp;&nbsp;ZEA_SDT050-ERZET&nbsp;=&nbsp;SY-UZEIT.&nbsp;"&nbsp;생성시간을&nbsp;현재&nbsp;시간으로<br />
*&nbsp;&nbsp;ZEA_SDT050-ERNAM&nbsp;=&nbsp;SY-UNAME.&nbsp;"&nbsp;생성자를&nbsp;현재&nbsp;로그인한&nbsp;사용자ID<br />
*<br />
*&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;LS_SDT050.<br />
*<br />
*&nbsp;&nbsp;LS_SDT050-VBELN&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
*&nbsp;&nbsp;LS_SDT050-POSNR&nbsp;=&nbsp;ZEA_SDT050-POSNR.<br />
****<br />
*&nbsp;&nbsp;LS_SDT050-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
*&nbsp;&nbsp;LS_SDT050-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
*&nbsp;&nbsp;LS_SDT050-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
*<br />
<br />
*&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT050&nbsp;FROM&nbsp;LS_SDT050.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;LV_SUBRC&nbsp;EQ&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S015.&nbsp;"데이터가&nbsp;성공적으로&nbsp;저장되었습니다.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.&nbsp;"&nbsp;INSERT&nbsp;UPDATE&nbsp;DELETE&nbsp;뒤에&nbsp;DB&nbsp;TABLE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S016&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY1&nbsp;BY&nbsp;VBELN&nbsp;DESCENDING.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_DOUBLE_CLICK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_DOUBLE_CLICK  USING PS_ROW     TYPE LVC_S_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_COL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;LVC_S_COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_MSG&nbsp;&nbsp;&nbsp;TYPE&nbsp;STRING,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_COUNT&nbsp;TYPE&nbsp;I.<br />
<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY1&nbsp;INTO&nbsp;GS_DISPLAY1&nbsp;INDEX&nbsp;PS_ROW-INDEX.<br />
<br />
&nbsp;&nbsp;"&nbsp;더블클릭한&nbsp;GO_ALV_GIRD1의&nbsp;와&nbsp;관련있는&nbsp;정보만&nbsp;취급하기&nbsp;위해<br />
&nbsp;&nbsp;"&nbsp;기존에&nbsp;갖고&nbsp;있던&nbsp;데이터를&nbsp;전부&nbsp;지우고,&nbsp;새롭게&nbsp;데이터를&nbsp;조회한다.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_BPDATA.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;COUNT(*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'오더&nbsp;생성&nbsp;취소'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'저장하지&nbsp;않은&nbsp;오더는&nbsp;삭제됩니다.&nbsp;저장하겠습니까?'&nbsp;GV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;조회모드로&nbsp;변경한다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GV_MODE&nbsp;=&nbsp;GC_MODE_DISPLAY.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;고객정보<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_KNA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_BPDATA<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;GS_DISPLAY1-CUSCODE.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;헤더&nbsp;정보&nbsp;가져오기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GS_DATA1.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_DATA1<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY1-VBELN.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA1&nbsp;TO&nbsp;ZEA_SDT040.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY1&nbsp;TO&nbsp;ZEA_SDT040.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;GV_PRESSEDTAB&nbsp;=&nbsp;'TAB1'.<br />
&nbsp;&nbsp;GV_SUBSCREEN&nbsp;=&nbsp;'0110'.<br />
&nbsp;&nbsp;GO_TAB-%_SCROLLPOSITION&nbsp;&nbsp;=&nbsp;'TAB2'.<br />
&nbsp;&nbsp;"&nbsp;더블클릭할&nbsp;때&nbsp;탭의&nbsp;포지션이&nbsp;자꾸&nbsp;바뀌어서&nbsp;그거&nbsp;고정시켜줌.<br />
&nbsp;&nbsp;"&nbsp;근데&nbsp;계속&nbsp;고정&nbsp;탭스트립이&nbsp;바뀔&nbsp;필요가&nbsp;없으니까&nbsp;더블클릭&nbsp;할때만&nbsp;작동하게.<br />
<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_RBGROUP.<br />
&nbsp;&nbsp;IF&nbsp;ZEA_SDT040-SADDR&nbsp;EQ&nbsp;ZEA_KNA1-BPADRR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_RBGROUP-RA1&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_RBGROUP-RA2&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;아이템&nbsp;정보&nbsp;가져오기.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY1-VBELN.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;A~MATNR,&nbsp;SUM(&nbsp;A~CALQTY&nbsp;)&nbsp;AS&nbsp;CALQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_SDT050&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR&nbsp;"&nbsp;재고테이블<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;B~VBELN&nbsp;EQ&nbsp;@GS_DISPLAY1-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GROUP&nbsp;BY&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;@DATA(LT_MMT190).<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;LT_MMT190&nbsp;BY&nbsp;MATNR.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;POSNR.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_MMT190&nbsp;INTO&nbsp;DATA(LS_MMT190)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;MATNR&nbsp;=&nbsp;GS_DISPLAY2-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-CALQTY&nbsp;=&nbsp;LS_MMT190-CALQTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2&nbsp;TRANSPORTING&nbsp;CALQTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY2&nbsp;LINES&nbsp;GV_LINES.<br />
&nbsp;&nbsp;IF&nbsp;GT_DISPLAY2&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;GT_DATA2&nbsp;의&nbsp;데이터가&nbsp;변경되었으므로,<br />
&nbsp;&nbsp;"&nbsp;변경된&nbsp;데이터를&nbsp;ALV에&nbsp;출력하기&nbsp;위해&nbsp;ALV를&nbsp;새로고침&nbsp;한다.<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REFRESH_TABLE_DISPLAY<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;LEAVE&nbsp;SCREEN.&nbsp;"&nbsp;스크린을&nbsp;새로고침하는것.<br />
&nbsp;&nbsp;"&nbsp;NEXT&nbsp;DYNPRO&nbsp;가&nbsp;100이기때문에&nbsp;100으로&nbsp;돌아감.<br />
&nbsp;&nbsp;"&nbsp;화면을&nbsp;버린다&nbsp;-&nbsp;가&nbsp;이것.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_EVENT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_EVENT_0100 .<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_DOUBLE_CLICK&nbsp;FOR&nbsp;GO_ALV_GRID1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_0100 .<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT2&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT_0100.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_0100 .<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DATA_SAVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DATA_SAVE .<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CONFIRM_SAVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CONFIRM_SAVE .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-AUQUA&nbsp;&gt;&nbsp;GS_DISPLAY2-CALQTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E040.&nbsp;"&nbsp;재고수량을&nbsp;초과하는&nbsp;구매는&nbsp;불가합니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
**---&nbsp;저장&nbsp;메시지&nbsp;띄우기<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLEBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'판매오더&nbsp;저장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_QUESTION&nbsp;&nbsp;=&nbsp;'저장하시겠습니까?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_1&nbsp;&nbsp;=&nbsp;'저장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_1&nbsp;&nbsp;=&nbsp;'@2K@'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_2&nbsp;&nbsp;=&nbsp;'나가기'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_2&nbsp;&nbsp;=&nbsp;'ICON_EXIT'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_BUTTON&nbsp;=&nbsp;'1'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY_CANCEL&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_ANSWER.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;GV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'1'.&nbsp;"&nbsp;저장<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_DATA.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;'저장에&nbsp;성공했습니다.'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'2'.&nbsp;"&nbsp;나가기<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_DATA .<br />
<br />
&nbsp;&nbsp;"&nbsp;GV_ANSWER&nbsp;가&nbsp;1일&nbsp;때만&nbsp;작동한다.<br />
&nbsp;&nbsp;"&nbsp;저장&nbsp;과정&nbsp;중&nbsp;오류가&nbsp;발생하면&nbsp;GV_ANSWER&nbsp;를&nbsp;E&nbsp;로&nbsp;변경한다.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;판매오더번호&nbsp;채번<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'&nbsp;"&nbsp;채번&nbsp;과정<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_VBELN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;number&nbsp;range&nbsp;object<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-VBELN&nbsp;&nbsp;"&nbsp;free&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;not&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;is&nbsp;not&nbsp;internal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Object&nbsp;not&nbsp;defined&nbsp;in&nbsp;TNRO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;used&nbsp;up.&nbsp;Change&nbsp;not&nbsp;possible.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffer&nbsp;is&nbsp;full<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'00'&nbsp;IN&nbsp;ZEA_SDT040-VBELN&nbsp;&nbsp;WITH&nbsp;'SB'.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GO_ALV_GRID2-&gt;CHECK_CHANGED_DATA(&nbsp;).<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_SDT040&nbsp;TYPE&nbsp;ZEA_SDT040,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_SDT050&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT050,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT050&nbsp;TYPE&nbsp;ZEA_SDT050.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_DISPLAY1&nbsp;LIKE&nbsp;GS_DISPLAY1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;SY-TABIX.&nbsp;"&nbsp;POSNR&nbsp;설정위한&nbsp;인덱스&nbsp;변수&nbsp;선언<br />
<br />
&nbsp;&nbsp;LV_INDEX&nbsp;=&nbsp;0.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***--&nbsp;아이템&nbsp;데이터&nbsp;저장<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_DISPLAY1-TOAMT&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LS_DISPLAY1-VBELN&nbsp;=&nbsp;ZEA_SDT040-VBELN.&nbsp;"&nbsp;판매오더&nbsp;번호<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-VBELN&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-AUAMO&nbsp;=&nbsp;GS_DISPLAY2-AUQUA&nbsp;*&nbsp;GS_DISPLAY2-NETPR.&nbsp;"&nbsp;주문금액<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WAERS&nbsp;=&nbsp;'KRW'.&nbsp;"주문&nbsp;통화<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-AUQUA&nbsp;&lt;&gt;&nbsp;0.&nbsp;"&nbsp;구매수량이&nbsp;0이&nbsp;아닌건만&nbsp;저장<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2-POSNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;=&nbsp;LV_INDEX&nbsp;+&nbsp;1.&nbsp;"&nbsp;POSNR(인덱스&nbsp;필드&nbsp;저장)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;LV_INDEX&nbsp;*&nbsp;10.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DISPLAY1-TOAMT&nbsp;=&nbsp;LS_DISPLAY1-TOAMT&nbsp;+&nbsp;GS_DISPLAY2-AUAMO.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;화면에&nbsp;TOAMT&nbsp;새로&nbsp;업데이트하게.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-TOAMT&nbsp;=&nbsp;LS_DISPLAY1-TOAMT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-WAERS&nbsp;=&nbsp;'KRW'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;LS_SDT050.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_SDT050&nbsp;TO&nbsp;LT_SDT050.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT050&nbsp;FROM&nbsp;TABLE&nbsp;LT_SDT050.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;WITH&nbsp;'데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_ANSWER&nbsp;=&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.&nbsp;&nbsp;&nbsp;"&nbsp;SAVE_DATA&nbsp;를&nbsp;중단한다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***--&nbsp;헤더&nbsp;데이터&nbsp;저장<br />
   </div>
   <div class="code">
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_SDT040&nbsp;TO&nbsp;LS_SDT040.<br />
&nbsp;&nbsp;LS_SDT040-VBELN&nbsp;=&nbsp;ZEA_SDT040-VBELN.<br />
&nbsp;&nbsp;LS_SDT040-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;LS_SDT040-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;LS_SDT040-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT040-ADATU&nbsp;=&nbsp;ZEA_SDT040-VDATU&nbsp;.&nbsp;"&nbsp;예상납기일<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;라디오&nbsp;버튼을&nbsp;회사주소로&nbsp;선택한&nbsp;경우&nbsp;직접입력된&nbsp;값이&nbsp;아닌&nbsp;회사주소로&nbsp;헤더에&nbsp;저장한다.<br />
&nbsp;&nbsp;IF&nbsp;GS_RBGROUP-RA1&nbsp;EQ&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT040-SADDR&nbsp;=&nbsp;ZEA_KNA1-BPADRR.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_KNA1&nbsp;TO&nbsp;LS_SDT040.&nbsp;"&nbsp;새로&nbsp;생성<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT040&nbsp;FROM&nbsp;LS_SDT040.<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;'주문이&nbsp;정상적으로&nbsp;저장되었습니다.'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY1&nbsp;FROM&nbsp;LS_DISPLAY1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TRANSPORTING&nbsp;TOAMT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_KNA1-CUSCODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY1&nbsp;BY&nbsp;VBELN&nbsp;DESCENDING.<br />
<br />
GV_MODE = GC_MODE_SAVED. " 아이템 수정 못하게.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;WITH&nbsp;'데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_ANSWER&nbsp;=&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.&nbsp;&nbsp;&nbsp;"&nbsp;SAVE_DATA&nbsp;를&nbsp;중단한다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_ALV_0100_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_ALV_0100_2 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_EVENT_0100_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_EVENT_0100_2 .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_READY_FOR_INPUT&nbsp;=&nbsp;1.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REGISTER_EDIT_EVENT&nbsp;&nbsp;"&nbsp;EDIT&nbsp;이벤트&nbsp;등록<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED&nbsp;"&nbsp;Event&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Error<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
SET HANDLER LCL_EVENT_HANDLER=&gt;ON_TOOLBAR FOR GO_ALV_GRID2.<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_USER_COMMAND&nbsp;FOR&nbsp;GO_ALV_GRID2.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_SCREEN_DISPLAY<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_SCREEN_DISPLAY .<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;GO_ALV_GRID2&nbsp;IS&nbsp;BOUND<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;GO_ALV_GRID2-&gt;IS_READY_FOR_INPUT(&nbsp;)&nbsp;EQ&nbsp;1.<br />
<br />
&nbsp;&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT(&nbsp;0&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_SCREEN_CREATE_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_SCREEN_CREATE_0100.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SCREEN-NAME&nbsp;EQ&nbsp;'TAB1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-ACTIVE&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_SCREEN_CREATE_ITEM_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_SCREEN_CREATE_ITEM_0100 .<br />
<br />
&nbsp;&nbsp;IF&nbsp;GO_ALV_GRID2&nbsp;IS&nbsp;BOUND&nbsp;AND&nbsp;GO_ALV_GRID2-&gt;IS_READY_FOR_INPUT(&nbsp;)&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT(&nbsp;1&nbsp;).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_FIELDCAT2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FIELDCAT2  USING    PT_TAB  TYPE STANDARD TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PT_FCAT&nbsp;TYPE&nbsp;LVC_T_FCAT.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LO_DREF&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;DATA.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;LO_DREF&nbsp;LIKE&nbsp;PT_TAB.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LT_TAB&gt;&nbsp;TYPE&nbsp;TABLE.<br />
&nbsp;&nbsp;ASSIGN&nbsp;LO_DREF-&gt;*&nbsp;TO&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_SALV_TABLE=&gt;FACTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;=&nbsp;DATA(LR_TABLE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;CX_SALV_MSG.&nbsp;"&nbsp;ALV:&nbsp;General&nbsp;Error&nbsp;Class&nbsp;with&nbsp;Message<br />
&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;PT_FCAT&nbsp;=&nbsp;CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_COLUMNS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE-&gt;GET_COLUMNS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_AGGREGATIONS&nbsp;=&nbsp;LR_TABLE-&gt;GET_AGGREGATIONS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT_0100 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'VBELN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SADDR'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;25.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ODDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VBELN&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-VBELN,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CUSCODE&nbsp;TYPE&nbsp;ZEA_SDT040-CUSCODE,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SADDR&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-SADDR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VDATU&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-VDATU,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADATU&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-ADATU,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ODDAT&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-ODDAT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOAMT&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-TOAMT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAERS&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-WAERS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STATUS2&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-STATUS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERNAM&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-ERNAM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERDAT&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-ERDAT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERZET&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-ERZET,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-AENAM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-AEDAT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT040-AEZET,<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_SCREEN_SAVED_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_SCREEN_SAVED_0100 .<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GO_ALV_GRID2&nbsp;IS&nbsp;BOUND&nbsp;AND&nbsp;GO_ALV_GRID2-&gt;IS_READY_FOR_INPUT(&nbsp;)&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT(&nbsp;0&nbsp;).<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_BUTTON_CLICK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_BUTTON_CLICK  USING    P_ES_ROW_NO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_ES_COL_ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;P_SENDER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLER_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLER_TOOLBAR  USING PO_OBJECT TYPE REF TO CL_ALV_EVENT_TOOLBAR_SET<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
<br />
&nbsp;&nbsp;"&nbsp;Internal&nbsp;Table&nbsp;PO_OBJECT-&gt;MT_TOOLBAR&nbsp;를&nbsp;위한&nbsp;작업공간<br />
&nbsp;&nbsp;"&nbsp;PO_OBJECT-&gt;MT_TOOLBAR&nbsp;&gt;&gt;&gt;&nbsp;클래스의&nbsp;Attribute&nbsp;(&nbsp;Public&nbsp;,&nbsp;Instance&nbsp;)<br />
&nbsp;&nbsp;DATA&nbsp;LS_TOOLBAR&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LV_GASO&nbsp;TYPE&nbsp;I.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LV_ELEC&nbsp;TYPE&nbsp;I.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-MATNR&nbsp;BETWEEN&nbsp;30000000&nbsp;AND&nbsp;30000005&nbsp;.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_GASO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY2-MATNR&nbsp;BETWEEN&nbsp;30000012&nbsp;AND&nbsp;30000017.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_GASO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_ELEC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;구분자&nbsp;=&gt;&gt;&nbsp;|<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;3.&nbsp;"&nbsp;구분자<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;전체조회<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_NO_FILTER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;|&nbsp;전체조회&nbsp;:&nbsp;{&nbsp;SY-TFILL&nbsp;}&nbsp;|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;가솔린<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_GASOLINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_CAR.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;|&nbsp;가솔린&nbsp;:&nbsp;{&nbsp;LV_GREEN&nbsp;}&nbsp;&nbsp;|.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;|&nbsp;가솔린&nbsp;:&nbsp;{&nbsp;LV_GASO&nbsp;}&nbsp;&nbsp;|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;전기차<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_ELECTRIC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_CAR.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;|&nbsp;전기차&nbsp;:&nbsp;{&nbsp;LV_YELLOW&nbsp;}&nbsp;&nbsp;|.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;|&nbsp;전기차&nbsp;:&nbsp;{&nbsp;LV_ELEC&nbsp;}&nbsp;&nbsp;|.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_USER_COMMAND  USING PV_UCOMM TYPE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID2.&nbsp;"PO_SENDER&nbsp;가&nbsp;GO_ALV_GRID&nbsp;일&nbsp;때<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;PV_UCOMM.&nbsp;&nbsp;"&nbsp;선택한&nbsp;버튼&nbsp;(PV_UCOMM은&nbsp;SY-UCOMM&nbsp;타입)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_NO_FILTER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;NO_FILTER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_GASOLINE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GASOLINE_FILTER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_ELECTRIC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;ELECTRIC_FILTER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;NO_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM NO_FILTER .<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FILTER .<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV에&nbsp;Filter&nbsp;정보를&nbsp;적용하는&nbsp;과정<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_FILTER_CRITERIA<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;=&nbsp;GT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Conditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E000&nbsp;WITH&nbsp;'필터&nbsp;적용에&nbsp;실패하였습니다'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV가&nbsp;새로고침될&nbsp;때,&nbsp;현재&nbsp;라인,&nbsp;열을&nbsp;유지할&nbsp;지<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;"&nbsp;적용된&nbsp;Filter&nbsp;기준으로&nbsp;데이터를&nbsp;출력<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GASOLINE_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GASOLINE_FILTER .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BT'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000000'.<br />
&nbsp;&nbsp;GS_FILTER-HIGH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000005'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BT'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000012'.<br />
&nbsp;&nbsp;GS_FILTER-HIGH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000017'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;ELECTRIC_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM ELECTRIC_FILTER .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BT'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000006'.<br />
&nbsp;&nbsp;GS_FILTER-HIGH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000011'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'MATNR'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'BT'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000018'.<br />
&nbsp;&nbsp;GS_FILTER-HIGH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'30000023'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.0 - E.G.Mellodew. 1998-2024. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
