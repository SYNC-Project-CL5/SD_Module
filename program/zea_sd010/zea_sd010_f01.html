<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ZEA_SD010_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEA_SD010_F01</h2>
<h3> Description: Include YE12_PJ020_F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;YE12_PJ020_F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT020&nbsp;AS&nbsp;A&nbsp;INNER&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;C&nbsp;ON&nbsp;B~MATNR&nbsp;EQ&nbsp;C~MATNR<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~WERKS&nbsp;EQ&nbsp;ZEA_SDT020-WERKS.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;SAPNR&nbsp;SP_YEAR&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DATA2.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;리스트&nbsp;박스에서&nbsp;보여줄&nbsp;데이터<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_T001W<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_LIST.<br />
<br />
<br />
   </div>
   <div class="codeComment">
****&nbsp;판매계획&nbsp;ITEM&nbsp;ALV<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT030&nbsp;AS&nbsp;A<br />
*&nbsp;&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA2.<br />
<br />
*****&nbsp;팝업<br />
**REFRESH&nbsp;GT_DISPLAY3.<br />
**SELECT&nbsp;*<br />
**&nbsp;&nbsp;FROM&nbsp;ZEA_SDT030<br />
**&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY3<br />
**&nbsp;WHERE&nbsp;SP_YEAR&nbsp;EQ&nbsp;2023&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;GV_LIST.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_0100 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_0100 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SDT020'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_TOOLBAR[]<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DISPLAY_DATA .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;GS_DISPLAY.<br />
<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY&nbsp;TO&nbsp;GT_DISPLAY.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_DATA .<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-03'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-07'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-08'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-10'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-12'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-15'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-17'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-23'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA-05'.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;--&gt;&gt;&nbsp;이부분&nbsp;메세지&nbsp;처음&nbsp;시작부터&nbsp;뜨길래&nbsp;지움&nbsp;.<br />
<br />
**&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;LINES&nbsp;GV_LINES.<br />
<br />
**&nbsp;&nbsp;IF&nbsp;GT_DISPLAY&nbsp;IS&nbsp;INITIAL.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.&nbsp;"&nbsp;해당&nbsp;조건의&nbsp;데이터가&nbsp;존재하지&nbsp;않습니다.<br />
**&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
**&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
*&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY2&nbsp;LINES&nbsp;GV_LINES.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;GT_DISPLAY2&nbsp;IS&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
*&nbsp;만약&nbsp;현재&nbsp;프로그램이&nbsp;배치&nbsp;모드에서&nbsp;실행&nbsp;중이라면&nbsp;프로그램을&nbsp;종료합니다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;NOT&nbsp;SY-BATCH&nbsp;IS&nbsp;INITIAL.&nbsp;EXIT.&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;0100.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_0100 .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FIELDCAT.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
*&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'STATUS'.<br />
*&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;GS_FIELDCAT-REF_TABLE&nbsp;=&nbsp;'ICON'.<br />
*&nbsp;&nbsp;GS_FIELDCAT-ICON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
*&nbsp;&nbsp;GS_FIELDCAT-REF_FIELD&nbsp;=&nbsp;'ID'.<br />
*&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F09.&nbsp;"&nbsp;상세계획여부<br />
*&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'SAPNR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F01.&nbsp;"&nbsp;판매계획번호<br />
&nbsp;&nbsp;GS_FIELDCAT-HOTSPOT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'SP_YEAR'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F02.&nbsp;"&nbsp;판매계획&nbsp;년도<br />
&nbsp;&nbsp;GS_FIELDCAT-JUST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WERKS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F03.&nbsp;"&nbsp;&nbsp;플랜트ID<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'PNAME1'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F10.&nbsp;"&nbsp;&nbsp;플랜트명<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;16.<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;GS_FIELDCAT-JUIST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.&nbsp;"&nbsp;C&nbsp;/&nbsp;R&nbsp;/&nbsp;L<br />
   </div>
   <div class="code">
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'SAPQU'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F04.&nbsp;"&nbsp;&nbsp;판매계획&nbsp;수량<br />
&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F05.&nbsp;"&nbsp;&nbsp;단위<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'TOTREV'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F06.&nbsp;"&nbsp;&nbsp;목표&nbsp;매출<br />
&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F07.&nbsp;"&nbsp;&nbsp;통화코드<br />
&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'LOEKZ'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F08.&nbsp;"&nbsp;&nbsp;삭제여부<br />
&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'생성자'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;10.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'생성일'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;11.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'ERZET'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'입력시간'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'AENAM'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'변경자'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;13.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'변경일'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;14.<br />
&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'AEZET'.<br />
&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'변경시간'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;신규&nbsp;필드&nbsp;추가<br />
*&nbsp;&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
*&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'RATE'.<br />
*&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;100.<br />
*&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F02.&nbsp;"&nbsp;Rate<br />
*&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE.<br />
<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GV_SAVE&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
&nbsp;&nbsp;"&nbsp;'U'&nbsp;:&nbsp;저장한&nbsp;사용자만&nbsp;사용가능<br />
&nbsp;&nbsp;"&nbsp;'X'&nbsp;:&nbsp;Layout을&nbsp;저장하면&nbsp;모든&nbsp;사용자가&nbsp;사용&nbsp;가능<br />
&nbsp;&nbsp;"&nbsp;'A'&nbsp;:&nbsp;Layout을&nbsp;저장할&nbsp;때&nbsp;'U'/'X'&nbsp;선택&nbsp;가능<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'B'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-EXCP_FNAME&nbsp;=&nbsp;'LIGHT'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등<br />
*&nbsp;&nbsp;GS_LAYOUT-EXCP_LED&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등&nbsp;모양&nbsp;변경<br />
*&nbsp;&nbsp;GS_LAYOUT-CTAB_FNAME&nbsp;=&nbsp;'IT_FIELD_COLORS'.&nbsp;"&nbsp;셀&nbsp;별&nbsp;색상<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
<br />
&nbsp;&nbsp;GS_LAYOUT-NO_TOOLBAR&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_LAYOUT-NO_ROWINS&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_LAYOUT-NO_ROWMOVE&nbsp;=&nbsp;'X'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_EVENT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_EVENT_0100 .<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_DOUBLE_CLICK&nbsp;FOR&nbsp;GO_ALV_GRID.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_HOTSPOT_CLICK&nbsp;FOR&nbsp;GO_ALV_GRID.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_DOUBLE_CLICK<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_DOUBLE_CLICK  USING PS_ROW     TYPE LVC_S_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_COL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;LVC_S_COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_MSG&nbsp;TYPE&nbsp;STRING.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;TOP&nbsp;에서&nbsp;더블&nbsp;클릭한&nbsp;라인의&nbsp;SAPNR&nbsp;를&nbsp;가져와서<br />
*&nbsp;해당&nbsp;CARRID&nbsp;와&nbsp;관련있는&nbsp;ZEA_SDT030&nbsp;만&nbsp;조회한&nbsp;후<br />
*&nbsp;GO_ALV_GRID2&nbsp;에&nbsp;가져온&nbsp;결과를&nbsp;출력한다.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;TOP의&nbsp;데이터&nbsp;중&nbsp;더블&nbsp;클릭한&nbsp;데이터를&nbsp;GS_DATA&nbsp;에&nbsp;전달한다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_SDT020&nbsp;INTO&nbsp;GS_SDT020&nbsp;INDEX&nbsp;PS_ROW-INDEX.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;PS_ROW-INDEX.<br />
<br />
&nbsp;&nbsp;"&nbsp;더블클릭한&nbsp;GO_ALV_GIRD의&nbsp;SAPNR와&nbsp;관련있는&nbsp;정보만&nbsp;취급하기&nbsp;위해<br />
&nbsp;&nbsp;"&nbsp;기존에&nbsp;갖고&nbsp;있던&nbsp;데이터를&nbsp;전부&nbsp;지우고,&nbsp;새롭게&nbsp;데이터를&nbsp;조회한다.<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT030&nbsp;AS&nbsp;A&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;C<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;C~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAPNR&nbsp;&nbsp;&nbsp;EQ&nbsp;GS_DISPLAY-SAPNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SP_YEAR&nbsp;EQ&nbsp;GS_DISPLAY-SP_YEAR.<br />
<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;POSNR&nbsp;MATNR&nbsp;ASCENDING.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;검색된&nbsp;수&nbsp;말해주기.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY2&nbsp;LINES&nbsp;GV_LINES.<br />
&nbsp;&nbsp;IF&nbsp;GT_DISPLAY2&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.&nbsp;"&nbsp;해당&nbsp;조건의&nbsp;데이터가&nbsp;존재하지&nbsp;않습니다.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;GT_DISPLAY2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAPNR&nbsp;EQ&nbsp;GS_DISPLAY-SAPNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SP_YEAR&nbsp;EQ&nbsp;GS_DISPLAY-SP_YEAR.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;SAPNR&nbsp;SP_YEAR.<br />
<br />
*--------------------------------------------------------------------*<br />
<br />
<br />
*&nbsp;&nbsp;GS_SDT020_2&nbsp;=&nbsp;GS_DISPLAY.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT020-SAPNR&nbsp;=&nbsp;GS_DISPLAY-SAPNR.<br />
&nbsp;&nbsp;ZEA_SDT020-SP_YEAR&nbsp;=&nbsp;GS_DISPLAY-SP_YEAR.<br />
&nbsp;&nbsp;ZEA_SDT020-SAPQU&nbsp;=&nbsp;GS_DISPLAY-SAPQU.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT020-WERKS&nbsp;=&nbsp;GS_DISPLAY-WERKS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GV_LIST&nbsp;=&nbsp;GS_DISPLAY-WERKS.<br />
&nbsp;&nbsp;ZEA_SDT020-TOTREV&nbsp;=&nbsp;GS_DISPLAY-TOTREV.<br />
&nbsp;&nbsp;ZEA_SDT020-MEINS&nbsp;=&nbsp;GS_DISPLAY-MEINS.<br />
&nbsp;&nbsp;ZEA_SDT020-WAERS&nbsp;=&nbsp;GS_DISPLAY-WAERS.<br />
<br />
&nbsp;&nbsp;GV_MODE1&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_GUI_CFW=&gt;SET_NEW_OK_CODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NEW_CODE&nbsp;=&nbsp;'ENTER'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;New&nbsp;OK_CODE<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;"&nbsp;GT_DATA2&nbsp;의&nbsp;데이터가&nbsp;변경되었으므로,<br />
*&nbsp;&nbsp;"&nbsp;변경된&nbsp;데이터를&nbsp;ALV에&nbsp;출력하기&nbsp;위해&nbsp;ALV를&nbsp;새로고침&nbsp;한다.<br />
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REFRESH_TABLE_DISPLAY<br />
**&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_DETAIL_0100 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_DETAIL_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT2.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE2.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'B'.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_VARIANT2-REPORT&nbsp;=&nbsp;SY-REPID.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GV_SAVE2&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
&nbsp;&nbsp;"&nbsp;'U'&nbsp;:&nbsp;저장한&nbsp;사용자만&nbsp;사용가능<br />
&nbsp;&nbsp;"&nbsp;'X'&nbsp;:&nbsp;Layout을&nbsp;저장하면&nbsp;모든&nbsp;사용자가&nbsp;사용&nbsp;가능<br />
&nbsp;&nbsp;"&nbsp;'A'&nbsp;:&nbsp;Layout을&nbsp;저장할&nbsp;때&nbsp;'U'/'X'&nbsp;선택&nbsp;가능<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-EXCP_FNAME&nbsp;=&nbsp;'LIGHT'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등<br />
*&nbsp;&nbsp;GS_LAYOUT-EXCP_LED&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등&nbsp;모양&nbsp;변경<br />
*&nbsp;&nbsp;GS_LAYOUT-CTAB_FNAME&nbsp;=&nbsp;'IT_FIELD_COLORS'.&nbsp;"&nbsp;셀&nbsp;별&nbsp;색상<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-NO_TOOLBAR&nbsp;=&nbsp;'X'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-NO_ROWINS&nbsp;&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;GS_LAYOUT-NO_ROWMOVE&nbsp;=&nbsp;'X'.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_DETAIL_0100 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SDT030'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_TOOLBAR[]<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid2&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_ALV_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_ALV_0100 .<br />
<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_ALV_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_ALV_DETAIL_0100 .<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_EVENT_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_EVENT_DETAIL_0100 .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_READY_FOR_INPUT&nbsp;=&nbsp;1.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;REGISTER_EDIT_EVENT&nbsp;&nbsp;"&nbsp;EDIT&nbsp;이벤트&nbsp;등록<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_EVENT_ID&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_EVT_MODIFIED&nbsp;"&nbsp;Event&nbsp;ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Error<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_TOOLBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FOR&nbsp;GO_ALV_GRID2.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_USER_COMMAND&nbsp;&nbsp;FOR&nbsp;GO_ALV_GRID2.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_SP_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_SP_DATA .<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;맨&nbsp;처음에&nbsp;입력필드&nbsp;확인하기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT020-SAPNR&nbsp;IS&nbsp;INITIAL<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT020-SP_YEAR&nbsp;&nbsp;IS&nbsp;INITIAL<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;OR&nbsp;ZEA_SDT020-WERKS&nbsp;IS&nbsp;INITIAL.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;OR&nbsp;GV_LIST&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E000&nbsp;WITH&nbsp;'값을&nbsp;입력해주세요.'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GV_MODE1&nbsp;=&nbsp;ABAP_OFF.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GV_MODE1&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;이미&nbsp;생성된&nbsp;판매계획이&nbsp;있는지&nbsp;확인하는&nbsp;과정<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;COUNT(*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT020<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;SP_YEAR&nbsp;EQ&nbsp;ZEA_SDT020-SP_YEAR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;&nbsp;&nbsp;EQ&nbsp;ZEA_SDT020-WERKS.&nbsp;"&nbsp;아이템의&nbsp;판매계획번호를&nbsp;GT_CHECK&nbsp;라는&nbsp;인터널&nbsp;테이블에&nbsp;넣음<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;GV_LIST.<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;없으면&nbsp;신규생성하기.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S034&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;.&nbsp;"이미&nbsp;생성된&nbsp;판매운영계획입니다.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_DATA_CASE2.&nbsp;&nbsp;"&nbsp;판매계획을&nbsp;한번도&nbsp;사용안했으면&nbsp;해당&nbsp;로직을&nbsp;탐<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_DATA_CASE1.&nbsp;"&nbsp;판매계획번호를&nbsp;한번이라도&nbsp;사용되지&nbsp;않으면&nbsp;해당&nbsp;로직을&nbsp;탐<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_READY_FOR_INPUT&nbsp;=&nbsp;1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_DETAIL_0100 .<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT2&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT_0100.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_TOOLBAR_DETAIL_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_TOOLBAR_DETAIL_0100 .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GT_TOOLBAR[]&nbsp;=&nbsp;VALUE&nbsp;#(<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_APPEND_ROW&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_COPY&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_COPY_ROW&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_CUT&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_DELETE_ROW&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_INSERT_ROW&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_MOVE_ROW&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_PASTE&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_PASTE_NEW_ROW&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_LOC_UNDO&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_REFRESH&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_CHECK&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_GRAPH&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_HELP&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_INFO&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_VIEWS&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(&nbsp;CL_GUI_ALV_GRID=&gt;MC_FC_PRINT&nbsp;)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
*<br />
**&nbsp;&nbsp;MC_FC_DATA_SAVE<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLER_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLER_TOOLBAR USING PO_OBJECT TYPE REF TO CL_ALV_EVENT_TOOLBAR_SET<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;"&nbsp;Internal&nbsp;Table&nbsp;PO_OBJECT-&gt;MT_TOOLBAR&nbsp;를&nbsp;위한&nbsp;작업공간<br />
&nbsp;&nbsp;"&nbsp;PO_OBJECT-&gt;MT_TOOLBAR&nbsp;&gt;&gt;&gt;&nbsp;클래스의&nbsp;Attribute&nbsp;(&nbsp;Public&nbsp;,&nbsp;Instance&nbsp;)<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_TOOLBAR&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID2.<br />
   </div>
   <div class="codeComment">
*&nbsp;구분자&nbsp;=&gt;&gt;&nbsp;|<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;3.&nbsp;"&nbsp;구분자<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;행추가<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.&nbsp;"&nbsp;행추가<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_INSERT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_REPORT_CALL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L01.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;'PAST_DATA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_USER_COMMAND  USING PV_UCOMM TYPE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;PV_UCOMM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PAST_DATA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;0110&nbsp;STARTING&nbsp;AT&nbsp;35&nbsp;6.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_DATA_CASE2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_DATA_CASE2 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;LT_SDT020&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT020.<br />
*&nbsp;&nbsp;DATA&nbsp;LS_SDT020&nbsp;TYPE&nbsp;ZEA_SDT020.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;LV_YEAR&nbsp;TYPE&nbsp;N&nbsp;LENGTH&nbsp;4.<br />
<br />
&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'판매운영계획&nbsp;작성'<br />
'판매운영계획이 생성되었습니다. 내용을 작성하시겠습니까?' GV_ANSWER.<br />
&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
   </div>
   <div class="codeComment">
***<br />
***<br />
***&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'&nbsp;"&nbsp;채번&nbsp;과정<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;number<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SAPNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;number&nbsp;range&nbsp;object<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-SAPNR&nbsp;&nbsp;"&nbsp;free&nbsp;number<br />
***&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;not&nbsp;found<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;is&nbsp;not&nbsp;internal<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Object&nbsp;not&nbsp;defined&nbsp;in&nbsp;TNRO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;1<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;used&nbsp;up.&nbsp;Change&nbsp;not&nbsp;possible.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffer&nbsp;is&nbsp;full<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
***&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
***&nbsp;&nbsp;ENDIF.<br />
***<br />
***&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'00'&nbsp;IN&nbsp;ZEA_SDT020-SAPNR&nbsp;WITH&nbsp;'SP'.<br />
***&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'000000'&nbsp;IN&nbsp;ZEA_SDT020-SAPNR&nbsp;WITH&nbsp;ZEA_SDT020-SP_YEAR.<br />
***<br />
***<br />
***&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LIST&nbsp;INTO&nbsp;VALUE&nbsp;WITH&nbsp;KEY&nbsp;KEY&nbsp;=&nbsp;GV_LIST.<br />
***&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST_TEXT&nbsp;=&nbsp;VALUE-TEXT.<br />
***&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY.<br />
&nbsp;&nbsp;GS_DISPLAY-SP_YEAR&nbsp;=&nbsp;ZEA_SDT020-SP_YEAR.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_DISPLAY-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-WERKS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_DISPLAY-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;GS_DISPLAY-PNAME1&nbsp;&nbsp;=&nbsp;GV_LIST_TEXT.<br />
&nbsp;&nbsp;GS_DISPLAY-SAPNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-SAPNR.<br />
&nbsp;&nbsp;GS_DISPLAY-ERNAM&nbsp;&nbsp;&nbsp;=&nbsp;SY-UNAME.&nbsp;&nbsp;"&nbsp;생성일자를&nbsp;오늘로<br />
&nbsp;&nbsp;GS_DISPLAY-ERDAT&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.&nbsp;&nbsp;"&nbsp;생성시간을&nbsp;현재&nbsp;시간으로<br />
&nbsp;&nbsp;GS_DISPLAY-ERZET&nbsp;&nbsp;&nbsp;=&nbsp;SY-UZEIT.&nbsp;&nbsp;"&nbsp;생성자를&nbsp;현재&nbsp;로그인한&nbsp;사용자ID<br />
&nbsp;&nbsp;GS_DISPLAY-MEINS&nbsp;&nbsp;&nbsp;=&nbsp;'PKG'.<br />
&nbsp;&nbsp;GS_DISPLAY-WAERS&nbsp;&nbsp;&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY&nbsp;TO&nbsp;GT_DISPLAY.<br />
<br />
   </div>
   <div class="codeComment">
*-아이템&nbsp;테이블&nbsp;생성-------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;CREATE_ITEM_NUMBER.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;PLANT_SEARCH_SELECT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM PLANT_SEARCH_SELECT .<br />
<br />
   </div>
   <div class="codeComment">
*RANGES&nbsp;R_WERKS&nbsp;FOR&nbsp;ZEA_T001W-WERKS.<br />
*<br />
*&nbsp;&nbsp;REFRESH&nbsp;R_WERKS[].<br />
*&nbsp;&nbsp;CLEAR&nbsp;R_WERKS.<br />
*&nbsp;&nbsp;R_WERKS-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
*&nbsp;&nbsp;R_WERKS-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
*&nbsp;&nbsp;R_WERKS-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-WERKS.<br />
*&nbsp;&nbsp;R_WERKS-HIGH&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''.<br />
*&nbsp;&nbsp;APPEND&nbsp;R_WERKS.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;ZEA_SDT020-WERKS&nbsp;IS&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;R_WERKS[].<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;R_WERKS.<br />
*&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT020<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;IN&nbsp;R_WERKS.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;RANGES&nbsp;R_WERKS&nbsp;FOR&nbsp;ZEA_T001W-WERKS.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZEA_T001W-WERKS&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;WERKS가&nbsp;초기값이면&nbsp;모든&nbsp;데이터를&nbsp;선택<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT020&nbsp;AS&nbsp;A&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;SAPNR&nbsp;DESCENDING.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;WERKS&nbsp;값이&nbsp;있으면&nbsp;해당&nbsp;범위만&nbsp;선택<br />
&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;R_WERKS[].<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;R_WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_WERKS-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_WERKS-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_WERKS-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_T001W-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_WERKS.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*SAPNR&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-SAPNR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SP_YEAR&nbsp;TYPE&nbsp;ZEA_SDT020-SP_YEAR,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-WERKS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNAME1&nbsp;&nbsp;TYPE&nbsp;ZEA_T001W-PNAME1,&nbsp;"&nbsp;플랜트명&nbsp;새로&nbsp;추가.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAPQU&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-SAPQU,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEINS&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-MEINS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOTREV&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-TOTREV,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WAERS&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-WAERS,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOEKZ&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-LOEKZ,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERNAM&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-ERNAM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERDAT&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-ERDAT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ERZET&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-ERZET,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-AENAM,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-AEDAT,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;&nbsp;TYPE&nbsp;ZEA_SDT020-AEZET,<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;&nbsp;A~SAPNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~SP_YEAR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~PNAME1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~SAPQU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~MEINS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~TOTREV<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~WAERS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~LOEKZ<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~ERNAM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~ERDAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~ERZET<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AENAM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AEDAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AEZET<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT020&nbsp;AS&nbsp;A&nbsp;&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~WERKS&nbsp;IN&nbsp;R_WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;SAPNR&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT020&nbsp;AS&nbsp;A&nbsp;INNER&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;B&nbsp;"""<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~WERKS&nbsp;EQ&nbsp;ZEA_T001W-WERKS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_T001W-PNAME1&nbsp;=&nbsp;GS_DISPLAY-PNAME1.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;LINES&nbsp;GV_LINES.<br />
<br />
<br />
&nbsp;&nbsp;IF&nbsp;GT_DISPLAY&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.&nbsp;"&nbsp;해당&nbsp;조건의&nbsp;데이터가&nbsp;존재하지&nbsp;않습니다.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
*&nbsp;플랜트&nbsp;이름&nbsp;출력<br />
<br />
**&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_T001W&nbsp;AS&nbsp;A<br />
**&nbsp;&nbsp;INNER&nbsp;JOIN&nbsp;ZEA_SDT020&nbsp;AS&nbsp;B<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS<br />
**&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;GS_PNAME<br />
**&nbsp;&nbsp;WHERE&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS.<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_FIELDCAT2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FIELDCAT2  USING    PT_TAB  TYPE STANDARD TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PT_FCAT&nbsp;TYPE&nbsp;LVC_T_FCAT.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LO_DREF&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;DATA.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;LO_DREF&nbsp;LIKE&nbsp;PT_TAB.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LT_TAB&gt;&nbsp;TYPE&nbsp;TABLE.<br />
&nbsp;&nbsp;ASSIGN&nbsp;LO_DREF-&gt;*&nbsp;TO&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_SALV_TABLE=&gt;FACTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;=&nbsp;DATA(LR_TABLE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;CX_SALV_MSG.&nbsp;"&nbsp;ALV:&nbsp;General&nbsp;Error&nbsp;Class&nbsp;with&nbsp;Message<br />
&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;PT_FCAT&nbsp;=&nbsp;CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_COLUMNS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE-&gt;GET_COLUMNS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_AGGREGATIONS&nbsp;=&nbsp;LR_TABLE-&gt;GET_AGGREGATIONS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT_0100 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SAPNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SP_YEAR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'POSNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WERKS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PNAME1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;12.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MATNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;26.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-JUST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SAPQU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'총&nbsp;계획&nbsp;수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'NETPR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;6.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'1월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'2월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'3월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY4'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'4월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY5'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'5월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY6'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'6월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY7'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'7월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY8'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'8월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY9'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'9월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY10'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'10월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY11'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'11월&nbsp;계획수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SPQTY12'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'12월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERZET'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AENAM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AEZET'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GS_FIELDCAT-KEY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;ABAP_OFF.&nbsp;&nbsp;"&nbsp;키필드는&nbsp;수정&nbsp;불가능<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EDIT&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;"&nbsp;이외&nbsp;필드&nbsp;수정&nbsp;가능<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_ITEM_NUMBER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_ITEM_NUMBER.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;LV_SBELNR&nbsp;TYPE&nbsp;ZEA_SDT060-SBELNR.<br />
*&nbsp;&nbsp;DATA&nbsp;LT_SDT020&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT020.<br />
*&nbsp;&nbsp;DATA&nbsp;LS_SDT020&nbsp;TYPE&nbsp;ZEA_SDT020.<br />
*<br />
*&nbsp;&nbsp;DATA&nbsp;LT_SDT030&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT030.<br />
*&nbsp;&nbsp;DATA&nbsp;LS_SDT030&nbsp;TYPE&nbsp;ZEA_SDT030.<br />
<br />
<br />
*---&nbsp;아이템&nbsp;테이블에&nbsp;저장<br />
<br />
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;LS_DISPLAY2&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GT_DATA2,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_MMT010&nbsp;&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_MMT010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_MMT010&nbsp;&nbsp;&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_MMT010,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_DISPLAY2&nbsp;LIKE&nbsp;TABLE&nbsp;OF&nbsp;GT_DATA2,<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;SY-TABIX.&nbsp;"&nbsp;POSNR&nbsp;설정위한&nbsp;인덱스&nbsp;변수&nbsp;선언<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DATA2&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;GT_DATA2&nbsp;&nbsp;,<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_DATA2&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;LS_DATA2.<br />
<br />
***&nbsp;내가&nbsp;데이터로&nbsp;만들고싶은&nbsp;자재들을&nbsp;가져옴(조인필요)<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT010<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;LT_MMT010<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATTYPE&nbsp;EQ&nbsp;'완제품'.<br />
*<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_MMT010&nbsp;INTO&nbsp;LS_MMT010.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;LS_MMT010&nbsp;TO&nbsp;GS_DISPLAY2.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT010&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;C~MATNR&nbsp;AND&nbsp;C~SPRAS&nbsp;EQ&nbsp;@SY-LANGU<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;&nbsp;AS&nbsp;C&nbsp;ON&nbsp;B~WERKS&nbsp;EQ&nbsp;C~WERKS<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DATA2<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATTYPE&nbsp;EQ&nbsp;'완제품'&nbsp;AND&nbsp;B~LOEKZ&nbsp;NE&nbsp;'X'.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;드롭다운&nbsp;리스트&nbsp;사용<br />
   </div>
   <div class="code">
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LIST&nbsp;INTO&nbsp;VALUE&nbsp;WITH&nbsp;KEY&nbsp;KEY&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST_TEXT&nbsp;=&nbsp;VALUE-TEXT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2.&nbsp;가장&nbsp;최신&nbsp;날짜의&nbsp;레코드&nbsp;찾기<br />
*&nbsp;&nbsp;&nbsp;&nbsp;루프를&nbsp;사용하여&nbsp;각&nbsp;MATNR에&nbsp;대해&nbsp;가장&nbsp;최신의&nbsp;VALID_EN&nbsp;날짜를&nbsp;가진&nbsp;레코드를&nbsp;선택합니다.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;MATNR&nbsp;VALID_EN&nbsp;ASCENDING.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;CHANGE&nbsp;OF&nbsp;GS_DATA2-MATNR.&nbsp;&nbsp;&nbsp;"&nbsp;자재별&nbsp;가격&nbsp;1개만&nbsp;뜨도록&nbsp;설정<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;=&nbsp;LV_INDEX&nbsp;+&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SAPNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-SAPNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SP_YEAR&nbsp;=&nbsp;ZEA_SDT020-SP_YEAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;LV_INDEX&nbsp;*&nbsp;10.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-WERKS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-PNAME1&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST_TEXT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-MEINS&nbsp;=&nbsp;'PKG'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-NETPR&nbsp;=&nbsp;GS_DATA2-NETPR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WAERS&nbsp;=&nbsp;'KRW'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERNAM&nbsp;&nbsp;&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERDAT&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERZET&nbsp;&nbsp;&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDON.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MSG_DATA_MISS<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MSG_DATA_MISS .<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GT_DISPLAY의&nbsp;라인수와&nbsp;ZEA_SDT020의&nbsp;라인수가&nbsp;다르면(DB저장이&nbsp;안된상황)<br />
*&nbsp;나가기&nbsp;전에&nbsp;'저장되지&nbsp;않은&nbsp;데이터는&nbsp;삭제됩니다.&nbsp;저장하시겠습니까?'<br />
*&nbsp;&nbsp;팝업과&nbsp;함께&nbsp;저장&nbsp;OR&nbsp;나가기&nbsp;버튼&nbsp;만들기.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;라인&nbsp;수&nbsp;계산<br />
&nbsp;&nbsp;DATA:&nbsp;LV_LINES_DISPLAY&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_LINES_DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;C.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;IT_ZEA_SDT020&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT020.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_GT_DISPLAY&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;GT_DISPLAY.<br />
<br />
**<br />
**&nbsp;&nbsp;"&nbsp;데이터베이스&nbsp;테이블&nbsp;ZEA_SDT020에서&nbsp;데이터를&nbsp;읽어옵니다.<br />
**&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;ZEA_SDT020&nbsp;INTO&nbsp;TABLE&nbsp;IT_ZEA_SDT020.<br />
***<br />
***&nbsp;&nbsp;SELECT&nbsp;*&nbsp;FROM&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;TABLE&nbsp;IT_GT_DISPLAY.<br />
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;LT_SDT020&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT020,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT020&nbsp;TYPE&nbsp;ZEA_SDT020.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY&nbsp;TO&nbsp;LS_SDT020.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT020&nbsp;FROM&nbsp;LS_SDT020.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;LS_SDT020&nbsp;TO&nbsp;LT_SDT020.<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GT_DATA&nbsp;TO&nbsp;LT_SDT020.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GT_DISPLAY&nbsp;TO&nbsp;LT_SDT020.<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;LT_SDT020&nbsp;LINES&nbsp;LV_LINES_DISPLAY.<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;IT_ZEA_SDT020&nbsp;LINES&nbsp;LV_LINES_DB.<br />
<br />
&nbsp;&nbsp;"&nbsp;라인&nbsp;수가&nbsp;다르면&nbsp;팝업&nbsp;생성<br />
&nbsp;&nbsp;IF&nbsp;LV_LINES_DISPLAY&nbsp;&gt;&nbsp;LV_LINES_DB.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLEBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'판매운영계획&nbsp;저장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_QUESTION&nbsp;&nbsp;=&nbsp;'저장되지&nbsp;않은&nbsp;데이터는&nbsp;삭제됩니다.&nbsp;저장하시겠습니까?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_1&nbsp;&nbsp;=&nbsp;'저장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_1&nbsp;&nbsp;=&nbsp;'@2L@'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_2&nbsp;&nbsp;=&nbsp;'나가기'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_2&nbsp;&nbsp;=&nbsp;'@2O@'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_BUTTON&nbsp;=&nbsp;'1'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY_CANCEL&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'1'.&nbsp;"&nbsp;저장<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_DATA.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;'저장에&nbsp;성공했습니다.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'2'.&nbsp;"&nbsp;나가기<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;OK_CODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CANC'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'EXIT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BACK'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;COMFIRM_SAVE<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM COMFIRM_SAVE .<br />
<br />
   </div>
   <div class="codeComment">
**---&nbsp;저장&nbsp;메시지&nbsp;띄우기<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA:&nbsp;LV_LINES_DISPLAY&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_LINES_DB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;C.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITLEBAR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'판매운영계획&nbsp;저장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_QUESTION&nbsp;&nbsp;=&nbsp;'저장하시겠습니까?'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_1&nbsp;&nbsp;=&nbsp;'저장'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_1&nbsp;&nbsp;=&nbsp;'@2K@'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXT_BUTTON_2&nbsp;&nbsp;=&nbsp;'나가기'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ICON_BUTTON_2&nbsp;&nbsp;=&nbsp;'ICON_EXIT'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULT_BUTTON&nbsp;=&nbsp;'1'<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DISPLAY_CANCEL&nbsp;=&nbsp;'X'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_ANSWER.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;LV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'1'.&nbsp;"&nbsp;저장<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SAVE_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;WITH&nbsp;'저장에&nbsp;성공했습니다.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'2'.&nbsp;"&nbsp;나가기<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;PROGRAM.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID2-&gt;SET_READY_FOR_INPUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_READY_FOR_INPUT&nbsp;=&nbsp;0.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SAVE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SAVE_DATA .<br />
<br />
&nbsp;&nbsp;GO_ALV_GRID2-&gt;CHECK_CHANGED_DATA(&nbsp;).<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_SDT020&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT020,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT020&nbsp;TYPE&nbsp;ZEA_SDT020,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_SDT030&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT030,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT030&nbsp;TYPE&nbsp;ZEA_SDT030.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LV_SUM&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,&nbsp;"&nbsp;총&nbsp;판매수량<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_SUM_2&nbsp;TYPE&nbsp;F.&nbsp;"&nbsp;총&nbsp;목표&nbsp;매출<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;LT_SDT020&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT020.<br />
*&nbsp;&nbsp;DATA&nbsp;LS_SDT020&nbsp;TYPE&nbsp;ZEA_SDT020.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;LV_YEAR&nbsp;TYPE&nbsp;N&nbsp;LENGTH&nbsp;4.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'판매운영계획&nbsp;작성'<br />
*&nbsp;&nbsp;'판매운영계획이&nbsp;생성되었습니다.&nbsp;내용을&nbsp;작성하시겠습니까?'&nbsp;GV_ANSWER.<br />
*&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'&nbsp;"&nbsp;채번&nbsp;과정<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SAPNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;number&nbsp;range&nbsp;object<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-SAPNR&nbsp;&nbsp;"&nbsp;free&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;not&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;is&nbsp;not&nbsp;internal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Object&nbsp;not&nbsp;defined&nbsp;in&nbsp;TNRO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;used&nbsp;up.&nbsp;Change&nbsp;not&nbsp;possible.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffer&nbsp;is&nbsp;full<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'00'&nbsp;IN&nbsp;ZEA_SDT020-SAPNR&nbsp;WITH&nbsp;'SP'.<br />
&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'000000'&nbsp;IN&nbsp;ZEA_SDT020-SAPNR&nbsp;WITH&nbsp;ZEA_SDT020-SP_YEAR.<br />
<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LIST&nbsp;INTO&nbsp;VALUE&nbsp;WITH&nbsp;KEY&nbsp;KEY&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST_TEXT&nbsp;=&nbsp;VALUE-TEXT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;총&nbsp;판매&nbsp;수량<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SAPQU&nbsp;&nbsp;&nbsp;=&nbsp;(<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY1&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY2&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY3&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY4&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY5&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY6&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY7&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY8&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY9&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY10&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY11&nbsp;+<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SPQTY12&nbsp;).<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SAPNR&nbsp;=&nbsp;ZEA_SDT020-SAPNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;LS_SDT030.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_SDT030&nbsp;TO&nbsp;LT_SDT030.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT030&nbsp;FROM&nbsp;LS_SDT030.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;SY-SUBRC&nbsp;TO&nbsp;LV_SUBRC.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;LT_SDT030&nbsp;INTO&nbsp;LS_SDT030.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_SUM&nbsp;=&nbsp;LV_SUM&nbsp;+&nbsp;LS_SDT030-SAPQU.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_SUM_2&nbsp;=&nbsp;LV_SUM_2&nbsp;+&nbsp;(&nbsp;LS_SDT030-SAPQU&nbsp;*&nbsp;LS_SDT030-NETPR&nbsp;).<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;LS_SDT030-SAPNR&nbsp;=&nbsp;ZEA_SDT020-SAPNR.&nbsp;"""<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;WITH&nbsp;KEY&nbsp;SAPNR&nbsp;=&nbsp;ZEA_SDT020-SAPNR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;=&nbsp;ZEA_SDT020-WERKS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;GS_DISPLAY-SAPNR&nbsp;=&nbsp;ZEA_SDT020-SAPNR.<br />
&nbsp;&nbsp;GS_DISPLAY-SAPQU&nbsp;=&nbsp;LV_SUM.<br />
&nbsp;&nbsp;GS_DISPLAY-TOTREV&nbsp;=&nbsp;LV_SUM_2.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY&nbsp;TO&nbsp;LS_SDT020.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT020&nbsp;FROM&nbsp;LS_SDT020.<br />
*&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT020&nbsp;FROM&nbsp;LS_SDT020.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;LS_SDT020&nbsp;TO&nbsp;ZEA_SDT020.<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT020.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT020&nbsp;SET&nbsp;SAPQU&nbsp;=&nbsp;LV_SUM&nbsp;WHERE&nbsp;SAPNR&nbsp;EQ&nbsp;ZEA_SDT020-SAPNR.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;FROM&nbsp;ZEA_SDT030&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELDS&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAPNR&nbsp;EQ&nbsp;@ZEA_SDT020-SAPNR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;@ZEA_SDT020-WERKS<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;@GV_LIST<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DISPLAY2.<br />
<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;SELECT&nbsp;FROM&nbsp;ZEA_SDT020<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELDS&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAPNR&nbsp;EQ&nbsp;@ZEA_SDT020-SAPNR<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;@ZEA_SDT020-WERKS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;@GV_LIST<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DISPLAY.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT&nbsp;FROM&nbsp;ZEA_SDT020&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~WERKS&nbsp;EQ&nbsp;A~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELDS&nbsp;a~*,&nbsp;b~pname1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SAPNR&nbsp;EQ&nbsp;@ZEA_SDT020-SAPNR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;@ZEA_SDT020-WERKS<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~WERKS&nbsp;EQ&nbsp;@GV_LIST<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DISPLAY.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100&nbsp;.<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_DETAIL_0100.<br />
<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_DATA_CHANGED<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_DATA_CHANGED<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;PR_DATA_CHANGED&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_CHANGED_DATA_PROTOCOL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
<br />
&nbsp;&nbsp;DATA(LT_MOD)&nbsp;=&nbsp;PR_DATA_CHANGED-&gt;MT_MOD_CELLS[].<br />
<br />
&nbsp;&nbsp;IF&nbsp;LT_MOD[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_CHANGED&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;F4_HELP<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM F4_HELP .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_RETURN_TAB&nbsp;TYPE&nbsp;DDSHRETVAL&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_RETURN_TAB&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_RETURN_TAB.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_DSELC&nbsp;TYPE&nbsp;DSELC&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DSELC&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_DSELC.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_VALUE&nbsp;&nbsp;TYPE&nbsp;SEAHLPRES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_VALUE&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;SEAHLPRES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_FIELD&nbsp;&nbsp;TYPE&nbsp;DFIES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDS&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;DFIES.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;BEGIN&nbsp;OF&nbsp;LT_WERKS&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;TYPE&nbsp;ZEA_STKO-WERKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNAME1&nbsp;TYPE&nbsp;ZEA_T001W-PNAME1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LT_WERKS.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_MAP&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;DSELC&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;LT_WERKS,&nbsp;LT_WERKS[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_VALUE,&nbsp;LT_VALUE[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDS,&nbsp;LT_FIELDS[].<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;WERKS,&nbsp;PNAME1<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@LT_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_T001W<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;BETWEEN&nbsp;'10002'&nbsp;AND&nbsp;'10009'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;WHERE&nbsp;WERKS&nbsp;NE&nbsp;'10001'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;NE&nbsp;''.<br />
<br />
<br />
&nbsp;&nbsp;SORT&nbsp;LT_WERKS&nbsp;BY&nbsp;WERKS.<br />
<br />
<br />
   </div>
   <div class="codeComment">
***&nbsp;필드&nbsp;카탈로그&nbsp;부분<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'F4IF_INT_TABLE_VALUE_REQUEST'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETFIELD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WERKS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;return&nbsp;field&nbsp;in&nbsp;FIELD_TAB<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPPROG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-REPID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Current&nbsp;program<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Screen&nbsp;number<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPROFIELD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_STKO-BOMID'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'직영점'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Title&nbsp;for&nbsp;the&nbsp;hit&nbsp;list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Value&nbsp;return:&nbsp;C:&nbsp;cell&nbsp;by&nbsp;cell,&nbsp;S:&nbsp;structured<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELD_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_FIELDS[]<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_WERKS[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Table&nbsp;of&nbsp;values:&nbsp;entries&nbsp;cell&nbsp;by&nbsp;cell<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_RETURN_TAB[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPFLD_MAPPING&nbsp;=&nbsp;LT_MAP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER_ERROR&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Incorrect&nbsp;parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_VALUES_FOUND&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;No&nbsp;values&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_RETURN_TAB&nbsp;INTO&nbsp;LS_RETURN_TAB&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_T001W-WERKS&nbsp;=&nbsp;LS_RETURN_TAB-FIELDVAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_WERKS&nbsp;WITH&nbsp;KEY&nbsp;WERKS&nbsp;=&nbsp;ZEA_T001W-WERKS&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_T001W-WERKS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_WERKS-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_T001W-PNAME1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_WERKS-PNAME1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_0110<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_0110 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON3'&nbsp;"&nbsp;Name&nbsp;of&nbsp;the&nbsp;Screen&nbsp;CustCtrl&nbsp;Name&nbsp;to&nbsp;Link&nbsp;Container&nbsp;To<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'컨테이너&nbsp;생성에&nbsp;실패했습니다.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER3.&nbsp;&nbsp;&nbsp;"&nbsp;Parent&nbsp;Container<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'ALV&nbsp;생성에&nbsp;실패했습니다.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_0110<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_0110 .<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT3&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT_0110.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_0110<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_0110 .<br />
<br />
&nbsp;&nbsp;"&nbsp;판매계획&nbsp;아이템&nbsp;테이블<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID3-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;=&nbsp;'ZEA_SDT010'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Internal&nbsp;Output&nbsp;Table&nbsp;Structure&nbsp;Name<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT&nbsp;&nbsp;"&nbsp;Layout<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Save&nbsp;Layout<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT3&nbsp;&nbsp;&nbsp;"&nbsp;Layout<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY3&nbsp;"&nbsp;Output&nbsp;Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;=&nbsp;GT_FIELDCAT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Field&nbsp;Catalog<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT_0110<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT_0110 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SP_YEAR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WERKS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MATNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;26.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C500'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-JUST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SAVQU'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'총&nbsp;판매&nbsp;수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;&nbsp;=&nbsp;'C311'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'TOTSAL'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'NETPR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WAERS'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;6.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'1월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY2'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'2월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY3'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'3월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY4'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'4월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY5'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'5월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY6'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'6월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY7'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'7월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY8'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'8월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY9'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'9월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY10'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'10월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY11'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'11월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SVQTY12'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-OUTPUTLEN&nbsp;=&nbsp;9.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'12월&nbsp;판매수량'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERZET'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AENAM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AEZET'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_FIELDCAT3<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FIELDCAT3  USING    PT_TAB  TYPE STANDARD TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PT_FCAT&nbsp;TYPE&nbsp;LVC_T_FCAT.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LO_DREF&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;DATA.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;LO_DREF&nbsp;LIKE&nbsp;PT_TAB.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LT_TAB&gt;&nbsp;TYPE&nbsp;TABLE.<br />
&nbsp;&nbsp;ASSIGN&nbsp;LO_DREF-&gt;*&nbsp;TO&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_SALV_TABLE=&gt;FACTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;=&nbsp;DATA(LR_TABLE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;CX_SALV_MSG.&nbsp;"&nbsp;ALV:&nbsp;General&nbsp;Error&nbsp;Class&nbsp;with&nbsp;Message<br />
&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;PT_FCAT&nbsp;=&nbsp;CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_COLUMNS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE-&gt;GET_COLUMNS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_AGGREGATIONS&nbsp;=&nbsp;LR_TABLE-&gt;GET_AGGREGATIONS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_PAST_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_PAST_DATA .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_INDEX&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;SY-TABIX.&nbsp;"&nbsp;POSNR&nbsp;설정위한&nbsp;인덱스&nbsp;변수&nbsp;선언<br />
&nbsp;&nbsp;"&nbsp;이전년도&nbsp;데이터를&nbsp;가져오기<br />
   </div>
   <div class="codeComment">
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPQTY1&nbsp;SPQTY2&nbsp;SPQTY3&nbsp;SPQTY4&nbsp;SPQTY5&nbsp;SPQTY6&nbsp;SPQTY7&nbsp;SPQTY8<br />
****&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SPQTY9&nbsp;SPQTY10&nbsp;SPQTY11&nbsp;SPQTY12<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT030&nbsp;AS&nbsp;A&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SP_YEAR&nbsp;EQ&nbsp;2023&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;ZEA_SDT020-WERKS.<br />
***<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SAPNR&nbsp;=&nbsp;ZEA_SDT020-SAPNR.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SP_YEAR&nbsp;=&nbsp;ZEA_SDT020-SP_YEAR.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WERKS&nbsp;=&nbsp;ZEA_SDT020-WERKS.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;TABLE&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SV_YEAR&nbsp;AS&nbsp;SP_YEAR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~MATNR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAKTX<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SAVQU&nbsp;AS&nbsp;SAPQU<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MEINS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY1&nbsp;&nbsp;AS&nbsp;SPQTY1<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY2&nbsp;&nbsp;AS&nbsp;SPQTY2<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY3&nbsp;&nbsp;AS&nbsp;SPQTY3<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY4&nbsp;&nbsp;AS&nbsp;SPQTY4<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY5&nbsp;&nbsp;AS&nbsp;SPQTY5<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY6&nbsp;&nbsp;AS&nbsp;SPQTY6<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY7&nbsp;&nbsp;AS&nbsp;SPQTY7<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY8&nbsp;&nbsp;AS&nbsp;SPQTY8<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY9&nbsp;&nbsp;AS&nbsp;SPQTY9<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY10&nbsp;AS&nbsp;SPQTY10<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY11&nbsp;AS&nbsp;SPQTY11<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SVQTY12&nbsp;AS&nbsp;SPQTY12<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT030&nbsp;AS&nbsp;A&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SP_YEAR&nbsp;EQ&nbsp;2023&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;ZEA_SDT030-WERKS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;MATNR.<br />
*<br />
<br />
***&nbsp;이게&nbsp;오리지날<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT030&nbsp;AS&nbsp;A<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_SDT020&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~SP_YEAR&nbsp;EQ&nbsp;B~SP_YEAR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~SAPNR&nbsp;EQ&nbsp;B~SAPNR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DISPLAY2<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~SP_YEAR&nbsp;EQ&nbsp;2023&nbsp;AND&nbsp;A~WERKS&nbsp;EQ&nbsp;@GV_LIST.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;MATNR.<br />
<br />
**&nbsp;1.&nbsp;전년도&nbsp;판매데이터&nbsp;불러오기<br />
*&nbsp;&nbsp;SELECT<br />
*&nbsp;&nbsp;&nbsp;SV_YEAR&nbsp;AS&nbsp;SP_YEAR,<br />
*&nbsp;&nbsp;&nbsp;A~WERKS,<br />
*&nbsp;&nbsp;&nbsp;A~MATNR,<br />
*&nbsp;&nbsp;&nbsp;MAKTX,<br />
*&nbsp;&nbsp;&nbsp;SAVQU&nbsp;AS&nbsp;SAPQU,<br />
*&nbsp;&nbsp;&nbsp;MEINS,<br />
*&nbsp;&nbsp;&nbsp;C~NETPR,<br />
*&nbsp;&nbsp;&nbsp;C~WAERS,<br />
*&nbsp;&nbsp;&nbsp;C~VALID_EN,<br />
*&nbsp;&nbsp;&nbsp;SVQTY1&nbsp;&nbsp;AS&nbsp;SPQTY1,<br />
*&nbsp;&nbsp;&nbsp;SVQTY2&nbsp;&nbsp;AS&nbsp;SPQTY2,<br />
*&nbsp;&nbsp;&nbsp;SVQTY3&nbsp;&nbsp;AS&nbsp;SPQTY3,<br />
*&nbsp;&nbsp;&nbsp;SVQTY4&nbsp;&nbsp;AS&nbsp;SPQTY4,<br />
*&nbsp;&nbsp;&nbsp;SVQTY5&nbsp;&nbsp;AS&nbsp;SPQTY5,<br />
*&nbsp;&nbsp;&nbsp;SVQTY6&nbsp;&nbsp;AS&nbsp;SPQTY6,<br />
*&nbsp;&nbsp;&nbsp;SVQTY7&nbsp;&nbsp;AS&nbsp;SPQTY7,<br />
*&nbsp;&nbsp;&nbsp;SVQTY8&nbsp;&nbsp;AS&nbsp;SPQTY8,<br />
*&nbsp;&nbsp;&nbsp;SVQTY9&nbsp;&nbsp;AS&nbsp;SPQTY9,<br />
*&nbsp;&nbsp;&nbsp;SVQTY10&nbsp;AS&nbsp;SPQTY10,<br />
*&nbsp;&nbsp;&nbsp;SVQTY11&nbsp;AS&nbsp;SPQTY11,<br />
*&nbsp;&nbsp;&nbsp;SVQTY12&nbsp;AS&nbsp;SPQTY12<br />
*&nbsp;&nbsp;FROM&nbsp;ZEA_SDT010&nbsp;AS&nbsp;A<br />
*&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR&nbsp;AND&nbsp;B~SPRAS&nbsp;EQ&nbsp;@SY-LANGU<br />
*&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;C&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;C~MATNR<br />
*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DATA2<br />
*&nbsp;&nbsp;WHERE&nbsp;SV_YEAR&nbsp;EQ&nbsp;2023&nbsp;AND&nbsp;A~WERKS&nbsp;EQ&nbsp;@GV_LIST&nbsp;AND&nbsp;C~LOEKZ&nbsp;NE&nbsp;'X'.<br />
*<br />
*&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;MATNR.<br />
<br />
<br />
*&nbsp;1.&nbsp;전년도&nbsp;판매데이터&nbsp;불러오기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SELECT<br />
&nbsp;&nbsp;&nbsp;SV_YEAR&nbsp;AS&nbsp;SP_YEAR,<br />
&nbsp;&nbsp;&nbsp;B~WERKS,<br />
&nbsp;&nbsp;&nbsp;B~MATNR,<br />
&nbsp;&nbsp;&nbsp;MAKTX,<br />
&nbsp;&nbsp;&nbsp;SAVQU&nbsp;AS&nbsp;SAPQU,<br />
&nbsp;&nbsp;&nbsp;MEINS,<br />
&nbsp;&nbsp;&nbsp;D~NETPR,<br />
&nbsp;&nbsp;&nbsp;D~WAERS,<br />
&nbsp;&nbsp;&nbsp;D~VALID_EN,<br />
&nbsp;&nbsp;&nbsp;SVQTY1&nbsp;&nbsp;AS&nbsp;SPQTY1,<br />
&nbsp;&nbsp;&nbsp;SVQTY2&nbsp;&nbsp;AS&nbsp;SPQTY2,<br />
&nbsp;&nbsp;&nbsp;SVQTY3&nbsp;&nbsp;AS&nbsp;SPQTY3,<br />
&nbsp;&nbsp;&nbsp;SVQTY4&nbsp;&nbsp;AS&nbsp;SPQTY4,<br />
&nbsp;&nbsp;&nbsp;SVQTY5&nbsp;&nbsp;AS&nbsp;SPQTY5,<br />
&nbsp;&nbsp;&nbsp;SVQTY6&nbsp;&nbsp;AS&nbsp;SPQTY6,<br />
&nbsp;&nbsp;&nbsp;SVQTY7&nbsp;&nbsp;AS&nbsp;SPQTY7,<br />
&nbsp;&nbsp;&nbsp;SVQTY8&nbsp;&nbsp;AS&nbsp;SPQTY8,<br />
&nbsp;&nbsp;&nbsp;SVQTY9&nbsp;&nbsp;AS&nbsp;SPQTY9,<br />
&nbsp;&nbsp;&nbsp;SVQTY10&nbsp;AS&nbsp;SPQTY10,<br />
&nbsp;&nbsp;&nbsp;SVQTY11&nbsp;AS&nbsp;SPQTY11,<br />
&nbsp;&nbsp;&nbsp;SVQTY12&nbsp;AS&nbsp;SPQTY12<br />
&nbsp;&nbsp;FROM&nbsp;ZEA_MMT010&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT010&nbsp;AS&nbsp;B&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;B~MATNR<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;C~MATNR&nbsp;AND&nbsp;C~SPRAS&nbsp;EQ&nbsp;@SY-LANGU<br />
&nbsp;&nbsp;LEFT&nbsp;JOIN&nbsp;ZEA_SDT090&nbsp;AS&nbsp;D&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;D~MATNR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;RIGHT&nbsp;JOIN&nbsp;ZEA_MMT010&nbsp;AS&nbsp;D&nbsp;ON&nbsp;A~MATNR&nbsp;EQ&nbsp;D~MATNR<br />
   </div>
   <div class="code">
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DATA2<br />
&nbsp;&nbsp;WHERE&nbsp;SV_YEAR&nbsp;EQ&nbsp;2023<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~WERKS&nbsp;EQ&nbsp;@GV_LIST<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;D~LOEKZ&nbsp;NE&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~MATTYPE&nbsp;EQ&nbsp;'완제품'.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;MATNR.<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;2.&nbsp;가장&nbsp;최신&nbsp;날짜의&nbsp;레코드&nbsp;찾고&nbsp;데이터&nbsp;변경해주기<br />
   </div>
   <div class="code">
&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;MATNR&nbsp;VALID_EN&nbsp;ASCENDING.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;CHANGE&nbsp;OF&nbsp;GS_DATA2-MATNR.&nbsp;&nbsp;&nbsp;"&nbsp;자재별&nbsp;가격&nbsp;1개만&nbsp;뜨도록&nbsp;설정<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_INDEX&nbsp;=&nbsp;LV_INDEX&nbsp;+&nbsp;1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SAPNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-SAPNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SP_YEAR&nbsp;=&nbsp;ZEA_SDT020-SP_YEAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;LV_INDEX&nbsp;*&nbsp;10.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT020-WERKS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-PNAME1&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST_TEXT.<br />
   </div>
   <div class="codeComment">
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-MEINS&nbsp;=&nbsp;'PKG'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-NETPR&nbsp;=&nbsp;GS_DATA2-NETPR.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-WAERS&nbsp;=&nbsp;'KRW'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERNAM&nbsp;&nbsp;&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERDAT&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ERZET&nbsp;&nbsp;&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDON.<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_DETAIL_0100.<br />
&nbsp;&nbsp;LEAVE&nbsp;TO&nbsp;SCREEN&nbsp;0.<br />
<br />
<br />
<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.0 - E.G.Mellodew. 1998-2024. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
