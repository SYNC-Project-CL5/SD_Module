<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>ZEA_SD060_F01</title>
<style type="text/css">
.code{ font-family:"Courier New", Courier, monospace; color:#000; font-size:14px; background-color:#F2F4F7 }
  .codeComment {font-family:"Courier New", Courier, monospace; color:#0000F0; font-size:14px; background-color:#F2F4F7 }
  .normalBold{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; font-weight:800 }
  .normalBoldLarge{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
</style>
<style type="text/css">
  .normal{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px }
  .footer{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:12px; text-align: center }
  h2{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:16px; font-weight:800 }
  h3{ font-family:Arial, Helvetica, sans-serif; color:#000; font-size:14px; font-weight:800 }
  .outerTable{
   background-color:#E0E7ED;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-right-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
  .innerTable{
   background-color:#F2F4F7;
   width:100%;
   border-top-width: thin;
   border-right-width: thin;
   border-bottom-width: thin;
   border-left-width: thin;
   border-top-style: solid;
   border-right-style: solid;
   border-bottom-style: solid;
   border-left-style: solid;
  }
</style>
</head>
<body>
<table class="outerTable">
  <tr class="normalBoldLarge">
     <td><h2>Code listing for: ZEA_SD060_F01</h2>
<h3> Description: Include ZALV_GRID_DISPLAY_F01</h3></td>
   </tr>
  <tr>
     <td>
     <table class="innerTable">
       <tr>
          <td>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZALV_GRID_DISPLAY_F01<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT_0100 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'VBELN'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-HOTSPOT&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CUSCODE'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C501'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ICON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'출고&nbsp;문서&nbsp;유/무'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-ICON&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-KEY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_OFF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'STATUS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'COLOR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'LIGHT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MARK'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'BPCUS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'고객명'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'TOAMT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C310'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERNAM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ERZET'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AENAM'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AEDAT'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AEZET'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;CLEAR&nbsp;GS_FIELDCAT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-FIELDNAME&nbsp;=&nbsp;'CARRID'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;필드&nbsp;이름<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F01.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;출력&nbsp;되는&nbsp;컬럼명<br />
*&nbsp;&nbsp;&nbsp;GS_FIELDCAT-HOTSPOT&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;HOTSPOT&nbsp;설정<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-ICON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;"&nbsp;'X'&nbsp;&nbsp;&nbsp;"&nbsp;아이콘&nbsp;필드<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;컬럼을&nbsp;합산처리하도록&nbsp;옵션을&nbsp;켬<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-DO_SUM&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;"&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;"'X'.&nbsp;&nbsp;&nbsp;"&nbsp;컬럼을&nbsp;숨김&nbsp;처리<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-TECH&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;"'X'.&nbsp;&nbsp;&nbsp;"&nbsp;컬럼을&nbsp;삭제&nbsp;처리<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;컬럼명&nbsp;위에&nbsp;마우스를&nbsp;올렸을&nbsp;때&nbsp;텍스트<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-TOOLTIP&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-F03.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;가운데&nbsp;정렬,&nbsp;'L':&nbsp;왼쪽&nbsp;정렬,&nbsp;'R':&nbsp;오른쪽&nbsp;정렬<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-JUST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'C'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CURRENCY&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;통화&nbsp;단위&nbsp;참조<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CHECKBOX&nbsp;&nbsp;=&nbsp;ABAP_ON&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;체크박스<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-INTTYPE&nbsp;&nbsp;&nbsp;=&nbsp;I.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;내부&nbsp;타입<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-INTLEN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;20.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;내부&nbsp;길이<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C500'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;색상<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_FIELDCAT&nbsp;TO&nbsp;GT_FIELDCAT.<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
<br />
&nbsp;&nbsp;GV_SAVE1&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
&nbsp;&nbsp;"&nbsp;'U'&nbsp;:&nbsp;저장한&nbsp;사용자만&nbsp;사용가능<br />
&nbsp;&nbsp;"&nbsp;'X'&nbsp;:&nbsp;Layout을&nbsp;저장하면&nbsp;모든&nbsp;사용자가&nbsp;사용&nbsp;가능<br />
&nbsp;&nbsp;"&nbsp;'A'&nbsp;:&nbsp;Layout을&nbsp;저장할&nbsp;때&nbsp;'U'/'X'&nbsp;선택&nbsp;가능<br />
&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;'A'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;ABAP_ON.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'B'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;=&nbsp;'A'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;A:&nbsp;다중&nbsp;행,&nbsp;다중&nbsp;열&nbsp;선택,&nbsp;선택&nbsp;박스&nbsp;생성<br />
&nbsp;&nbsp;"&nbsp;(셀&nbsp;단위,&nbsp;전체&nbsp;선택도&nbsp;가능)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;=&nbsp;'B'.&nbsp;"&nbsp;B&nbsp;:&nbsp;단일&nbsp;행,&nbsp;다중&nbsp;열&nbsp;선택,&nbsp;기본&nbsp;값<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;기본값으로&nbsp;해도&nbsp;Ctrl&nbsp;+&nbsp;y로&nbsp;강제로&nbsp;드래그&nbsp;할&nbsp;수는&nbsp;있음<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;=&nbsp;'C'.&nbsp;"&nbsp;C&nbsp;:&nbsp;다중&nbsp;행,&nbsp;다중&nbsp;열&nbsp;선택,&nbsp;줄&nbsp;단위&nbsp;선택<br />
<br />
*&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T10.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
*&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
*&nbsp;&nbsp;GS_LAYOUT-EXCP_FNAME&nbsp;=&nbsp;'LIGHT'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등<br />
*&nbsp;&nbsp;GS_LAYOUT-EXCP_LED&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;신호등&nbsp;모양&nbsp;변경<br />
*&nbsp;&nbsp;GS_LAYOUT-CTAB_FNAME&nbsp;=&nbsp;'IT_FIELD_COLORS'.&nbsp;"&nbsp;셀&nbsp;별&nbsp;색상<br />
*&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DATA.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~STATUS2&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DISPLAY_DATA .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STYLE&nbsp;TYPE&nbsp;LVC_S_STYL.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;GS_DISPLAY.<br />
<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY&nbsp;TO&nbsp;GT_DISPLAY.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;ICON.<br />
&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;LINES&nbsp;GV_LINES.<br />
&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_DATA .<br />
<br />
&nbsp;&nbsp;CHECK&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-03'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-07'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-08'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-10'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-12'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-15'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-17'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA5-23'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OR&nbsp;SY-UNAME&nbsp;EQ&nbsp;'ACA-05'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;LINES&nbsp;GV_LINES.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;GT_DISPLAY&nbsp;IS&nbsp;INITIAL.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S013&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S006&nbsp;WITH&nbsp;GV_LINES.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;0100.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INIT_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INIT_DATA .<br />
<br />
   </div>
   <div class="codeComment">
*EX------------------------------------------------------------------*<br />
*&nbsp;&nbsp;BUTTXT&nbsp;=&nbsp;'Hide&nbsp;Details'(L04).<br />
*<br />
**&nbsp;Exercise&nbsp;4에&nbsp;의해&nbsp;Tabstrips&nbsp;생성&nbsp;및&nbsp;Tab&nbsp;Title&nbsp;정의<br />
*&nbsp;&nbsp;TAB1&nbsp;=&nbsp;'Flight&nbsp;connections'(L01).<br />
*&nbsp;&nbsp;TAB2&nbsp;=&nbsp;'Flight&nbsp;date'(L02).<br />
*&nbsp;&nbsp;TAB3&nbsp;=&nbsp;'Flight&nbsp;type'(L03).<br />
*<br />
*&nbsp;&nbsp;TAB_BLOCK-ACTIVETAB&nbsp;=&nbsp;'COMM2'.&nbsp;&nbsp;"&nbsp;눌려진&nbsp;제목&nbsp;부분<br />
*&nbsp;&nbsp;TAB_BLOCK-DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'1200'.&nbsp;&nbsp;&nbsp;"&nbsp;출력될&nbsp;내용&nbsp;부분<br />
*<br />
**&nbsp;AIRLINE&nbsp;(&nbsp;SO_CAR&nbsp;)&nbsp;에&nbsp;AA&nbsp;~&nbsp;QF&nbsp;인&nbsp;데이터이면서&nbsp;AZ&nbsp;는&nbsp;제외하는&nbsp;조건을<br />
*&nbsp;초기조건으로&nbsp;지정해라<br />
*&nbsp;&nbsp;SO_CAR-SIGN&nbsp;=&nbsp;'I'.<br />
*&nbsp;&nbsp;SO_CAR-OPTION&nbsp;=&nbsp;'BT'.<br />
*&nbsp;&nbsp;SO_CAR-LOW&nbsp;=&nbsp;'AA'.<br />
*&nbsp;&nbsp;SO_CAR-HIGH&nbsp;=&nbsp;'QF'.<br />
*&nbsp;&nbsp;APPEND&nbsp;SO_CAR.&nbsp;"&nbsp;첫번째&nbsp;조건을&nbsp;추가<br />
*<br />
*&nbsp;&nbsp;CLEAR&nbsp;SO_CAR.&nbsp;"&nbsp;Header&nbsp;Line을&nbsp;초기화<br />
*&nbsp;&nbsp;SO_CAR-SIGN&nbsp;=&nbsp;'E'.<br />
*&nbsp;&nbsp;SO_CAR-OPTION&nbsp;=&nbsp;'EQ'.<br />
*&nbsp;&nbsp;SO_CAR-LOW&nbsp;=&nbsp;'AZ'.<br />
*&nbsp;&nbsp;APPEND&nbsp;SO_CAR.&nbsp;"&nbsp;두번째&nbsp;조건을&nbsp;추가<br />
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_SSCREEN<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_SSCREEN .<br />
<br />
   </div>
   <div class="codeComment">
*EX------------------------------------------------------------------*<br />
*&nbsp;&nbsp;IF&nbsp;BUTTXT&nbsp;EQ&nbsp;TEXT-L06.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;SCREEN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SCREEN-GROUP1&nbsp;EQ&nbsp;'MOD'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SCREEN-ACTIVE&nbsp;=&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;SCREEN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*&nbsp;&nbsp;ENDIF.<br />
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SSCR_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SSCR_USER_COMMAND .<br />
<br />
   </div>
   <div class="codeComment">
*EX------------------------------------------------------------------*<br />
*&nbsp;&nbsp;CASE&nbsp;SY-UCOMM.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CLICK_DETAIL'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;BUTTXT&nbsp;EQ&nbsp;TEXT-L06.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUTTXT&nbsp;=&nbsp;'추가조건&nbsp;숨김'(L07).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUTTXT&nbsp;=&nbsp;'조회조건&nbsp;추가'(L06).<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*&nbsp;&nbsp;ENDCASE.<br />
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_INPUT<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_INPUT .<br />
<br />
<br />
   </div>
   <div class="codeComment">
*EX------------------------------------------------------------------*<br />
*&nbsp;&nbsp;"&nbsp;출발에&nbsp;대한&nbsp;점검<br />
*&nbsp;&nbsp;SELECT&nbsp;COUNT(*)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;SPFLI<br />
*&nbsp;&nbsp;&nbsp;WHERE&nbsp;COUNTRYFR&nbsp;EQ&nbsp;PA_CTRF<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CITYFROM&nbsp;&nbsp;IN&nbsp;SO_CITYF.<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E010.<br />
*&nbsp;&nbsp;ENDIF.<br />
*--------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_0100 .<br />
<br />
<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER_1<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE1.<br />
<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_VARIANT-VARIANT&nbsp;=&nbsp;PA_LAYO.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_1-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;''<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_TOOLBAR_EXCLUDING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_TOOLBAR[]<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_0100 .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT_0100.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT_0100&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT2&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT_0100.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_EVENT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_EVENT_0100 .<br />
<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_TOOLBAR&nbsp;FOR&nbsp;GO_ALV_GRID_1.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_DOUBLE_CLICK&nbsp;FOR&nbsp;GO_ALV_GRID_1.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_USER_COMMAND&nbsp;FOR&nbsp;GO_ALV_GRID_1.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_HOTSPOT_CLICK&nbsp;FOR&nbsp;GO_ALV_GRID_1.<br />
&nbsp;&nbsp;SET&nbsp;HANDLER&nbsp;LCL_EVENT_HANDLER=&gt;ON_BUTTON_CLICK&nbsp;FOR&nbsp;GO_ALV_GRID_1.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_ALV_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_ALV_0100 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_1-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;LS_STABLE.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_2-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_4-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_FIELDCAT_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FIELDCAT_0100 USING PT_TAB TYPE STANDARD TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PT_FCAT&nbsp;TYPE&nbsp;LVC_T_FCAT.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LO_DREF&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;DATA.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;LO_DREF&nbsp;LIKE&nbsp;PT_TAB.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LT_TAB&gt;&nbsp;TYPE&nbsp;TABLE.<br />
&nbsp;&nbsp;ASSIGN&nbsp;LO_DREF-&gt;*&nbsp;TO&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_SALV_TABLE=&gt;FACTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;=&nbsp;DATA(LR_TABLE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;CX_SALV_MSG.&nbsp;"&nbsp;ALV:&nbsp;General&nbsp;Error&nbsp;Class&nbsp;with&nbsp;Message<br />
&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;PT_FCAT&nbsp;=&nbsp;CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_COLUMNS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE-&gt;GET_COLUMNS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_AGGREGATIONS&nbsp;=&nbsp;LR_TABLE-&gt;GET_AGGREGATIONS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_FIELDCAT2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FIELDCAT2 USING PT_TAB TYPE STANDARD TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PT_FCAT&nbsp;TYPE&nbsp;LVC_T_FCAT.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LO_DREF&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;DATA.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;LO_DREF&nbsp;LIKE&nbsp;PT_TAB.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LT_TAB&gt;&nbsp;TYPE&nbsp;TABLE.<br />
&nbsp;&nbsp;ASSIGN&nbsp;LO_DREF-&gt;*&nbsp;TO&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_SALV_TABLE=&gt;FACTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;=&nbsp;DATA(LR_TABLE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;CX_SALV_MSG.&nbsp;"&nbsp;ALV:&nbsp;General&nbsp;Error&nbsp;Class&nbsp;with&nbsp;Message<br />
&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;PT_FCAT&nbsp;=&nbsp;CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_COLUMNS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE-&gt;GET_COLUMNS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_AGGREGATIONS&nbsp;=&nbsp;LR_TABLE-&gt;GET_AGGREGATIONS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FILTER .<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV에&nbsp;Filter&nbsp;정보를&nbsp;적용하는&nbsp;과정<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_1-&gt;SET_FILTER_CRITERIA<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;=&nbsp;GT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Filter&nbsp;Conditions<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E000&nbsp;WITH&nbsp;'필터&nbsp;적용에&nbsp;실패하였습니다'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;ALV가&nbsp;새로고침될&nbsp;때,&nbsp;현재&nbsp;라인,&nbsp;열을&nbsp;유지할&nbsp;지<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;"&nbsp;적용된&nbsp;Filter&nbsp;기준으로&nbsp;데이터를&nbsp;출력<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_1-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLER_TOOLBAR<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLER_TOOLBAR<br />
&nbsp;&nbsp;USING&nbsp;PO_OBJECT&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_EVENT_TOOLBAR_SET<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;"&nbsp;Internal&nbsp;Table&nbsp;PO_OBJECT-&gt;MT_TOOLBAR&nbsp;를&nbsp;위한&nbsp;작업공간<br />
&nbsp;&nbsp;"&nbsp;PO_OBJECT-&gt;MT_TOOLBAR&nbsp;&gt;&gt;&gt;&nbsp;클래스의&nbsp;Attribute&nbsp;(&nbsp;Public&nbsp;,&nbsp;Instance&nbsp;)<br />
&nbsp;&nbsp;DATA&nbsp;LS_TOOLBAR&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;LV_INVOICE&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_OK&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_ING&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;I.<br />
<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID_1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_DISPLAY-ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_INVOICE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_OK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_INVOICE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_NO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_INVOICE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_ING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;구분자&nbsp;=&gt;&gt;&nbsp;|<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;3.&nbsp;"&nbsp;구분자<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;출고&nbsp;문서처리&nbsp;O/X<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.&nbsp;"&nbsp;출고&nbsp;문서처리&nbsp;O/X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_INVOICE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L09&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_INVOICE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;출고&nbsp;문서&nbsp;처리&nbsp;O<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.&nbsp;"&nbsp;출고&nbsp;문서처리&nbsp;O<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_INVOICE_OK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L10&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_OK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;출고&nbsp;문서&nbsp;처리&nbsp;진행중<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.&nbsp;"&nbsp;출고&nbsp;문서처리&nbsp;진행중<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_INVOICE_ING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L11&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_ING.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;출고&nbsp;문서&nbsp;처리&nbsp;X<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.&nbsp;"&nbsp;출고&nbsp;문서처리&nbsp;X<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_INVOICE_NO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;TEXT-L07&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_NO.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
&nbsp;&nbsp;ENDCASE.<br />
   </div>
   <div class="codeComment">
**&nbsp;구분자&nbsp;=&gt;&gt;&nbsp;|<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;3.&nbsp;"&nbsp;구분자<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
**&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;예약취소<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;0.&nbsp;"&nbsp;버튼<br />
*&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_BOOKING_CANCEL.<br />
*&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;=&nbsp;'예약취소'.<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
**&nbsp;CONSTANTS&nbsp;GC_CHANGE_CLASS&nbsp;TYPE&nbsp;SY-UCOMM&nbsp;VALUE&nbsp;'CHANGE_CLASS'.<br />
*<br />
**&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;좌석등급변경<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_CHANGE_CLASS.<br />
*&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-L02.&nbsp;"&nbsp;좌석등급변경<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
**&nbsp;구분자&nbsp;=&gt;&gt;&nbsp;|<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-BUTN_TYPE&nbsp;=&nbsp;3.&nbsp;"&nbsp;구분자<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
*&nbsp;&nbsp;DATA&nbsp;LV_TOTAL&nbsp;TYPE&nbsp;I.<br />
*&nbsp;&nbsp;DATA&nbsp;LV_GREEN&nbsp;TYPE&nbsp;I.<br />
*&nbsp;&nbsp;DATA&nbsp;LV_YELLOW&nbsp;TYPE&nbsp;I.<br />
*&nbsp;&nbsp;DATA&nbsp;LV_RED&nbsp;TYPE&nbsp;I.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_TOTAL.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_DISPLAY-LIGHT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'1'.&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_RED.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'2'.&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_YELLOW.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'3'.&nbsp;ADD&nbsp;1&nbsp;TO&nbsp;LV_GREEN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
*<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*<br />
**&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;Totals:&nbsp;&nbsp;#,###<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_CLEAR_FILTER.<br />
**&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_DISPLAY.<br />
*&nbsp;&nbsp;DATA&nbsp;LV_LINES&nbsp;TYPE&nbsp;I.<br />
*&nbsp;&nbsp;LV_LINES&nbsp;=&nbsp;LINES(&nbsp;GT_DISPLAY&nbsp;).<br />
*&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-L03&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_LINES.&nbsp;"&nbsp;Totals<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
**&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;완료된&nbsp;예약:&nbsp;#,###<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_GREEN_FILTER.<br />
*&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-L04&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_GREEN.&nbsp;"&nbsp;완료된&nbsp;예약<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
**&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;완료된&nbsp;예약:&nbsp;#,###<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_YELLOW_FILTER.<br />
*&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-L05&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_YELLOW.&nbsp;"&nbsp;예정된&nbsp;예약<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
*<br />
**&nbsp;버튼&nbsp;추가&nbsp;=&gt;&gt;&nbsp;완료된&nbsp;예약:&nbsp;#,###<br />
*&nbsp;&nbsp;CLEAR&nbsp;LS_TOOLBAR.<br />
*&nbsp;&nbsp;LS_TOOLBAR-FUNCTION&nbsp;=&nbsp;GC_RED_FILTER.<br />
*&nbsp;&nbsp;LS_TOOLBAR-TEXT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-L06&nbsp;&&&nbsp;':'&nbsp;&&&nbsp;LV_RED.&nbsp;"&nbsp;취소된&nbsp;예약<br />
*&nbsp;&nbsp;APPEND&nbsp;LS_TOOLBAR&nbsp;TO&nbsp;PO_OBJECT-&gt;MT_TOOLBAR.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_USER_COMMAND<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_UCOMM&nbsp;&nbsp;&nbsp;-&gt;&gt;&nbsp;PO_UCOMM<br />
*&&nbsp;&nbsp;&nbsp;--&gt;&nbsp;SENDER&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&gt;&nbsp;PO_SENDER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_USER_COMMAND USING PV_UCOMM TYPE SY-UCOMM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PO_SENDER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GO_ALV_GRID_1.&nbsp;"PO_SENDER&nbsp;가&nbsp;GO_ALV_GRID&nbsp;일&nbsp;때<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;PV_UCOMM.&nbsp;&nbsp;"&nbsp;선택한&nbsp;버튼&nbsp;(PV_UCOMM은&nbsp;SY-UCOMM&nbsp;타입)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_INVOICE.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SELECT_DATA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;INVOICE_FILTER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_INVOICE_OK.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SELECT_DATA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;INVOICE_OK_FILTER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_INVOICE_NO.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SELECT_DATA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;INVOICE_NO_FILTER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_INVOICE_ING.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SELECT_DATA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;INVOICE_ING_FILTER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SET_ALV_FILTER.<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;GC_BOOKING_CANCEL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;예약&nbsp;취소<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;BOOKING_CANCEL&nbsp;USING&nbsp;PO_SENDER.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_HOTSPOT_CLICK<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW_ID<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_COLUMN_ID<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;SENDER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_HOTSPOT_CLICK USING PS_ROW_ID TYPE LVC_S_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_COLUMN_ID&nbsp;TYPE&nbsp;&nbsp;LVC_S_COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;선택한&nbsp;행이&nbsp;인터널테이블에&nbsp;있는&nbsp;정상적인&nbsp;데이터인지&nbsp;체크<br />
   </div>
   <div class="code">
&nbsp;&nbsp;CHECK&nbsp;PS_ROW_ID-ROWTYPE&nbsp;IS&nbsp;INITIAL.<br />
<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;PS_ROW_ID-INDEX.<br />
<br />
&nbsp;&nbsp;CASE&nbsp;PS_COLUMN_ID-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'VBELN'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SBELNR_DATA.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~VBELN&nbsp;EQ&nbsp;@GS_DISPLAY-VBELN.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;기존&nbsp;셀렉트&nbsp;문&nbsp;(강사님께&nbsp;내일&nbsp;여쭤보ㅛ6기)<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;A~STATUS&nbsp;A~VBELN&nbsp;A~POSNR&nbsp;A~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~MAKTX&nbsp;A~AUQUA&nbsp;A~MEINS&nbsp;A~NETPR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AUAMO&nbsp;A~WAERS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;헤더<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;TEXT<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;C~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~VBELN&nbsp;EQ&nbsp;GS_DISPLAY-VBELN.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY2_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
<br />
&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
   </div>
   <div class="codeComment">
**&nbsp;&nbsp;&nbsp;HOTSPOT&nbsp;옵션이&nbsp;적용된&nbsp;필드들&nbsp;중에서<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;PS_COLUMN_ID-FIELDNAME.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CLASS'.&nbsp;"&nbsp;클릭한&nbsp;필드가&nbsp;CLASS&nbsp;필드일&nbsp;때<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;좌석&nbsp;변경<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CHANGE_CLASS&nbsp;USING&nbsp;PO_SENDER.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_DOUBLE_CLICK<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_ROW<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;E_COLUMN<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;SENDER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_DOUBLE_CLICK USING PS_ROW TYPE LVC_S_ROW<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_COL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TYPE&nbsp;&nbsp;LVC_S_COL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER&nbsp;&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;선택한&nbsp;행이&nbsp;인터널테이블에&nbsp;있는&nbsp;정상적인&nbsp;데이터인지&nbsp;체크<br />
*&nbsp;&nbsp;CHECK&nbsp;PS_ROW-ROWTYPE&nbsp;IS&nbsp;INITIAL.<br />
*<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;PS_ROW-INDEX.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT110<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SBELNR&nbsp;EQ&nbsp;GS_DISPLAY-SBELNR.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CONNID&nbsp;EQ&nbsp;GS_DISPLAY-CONNID.<br />
*<br />
*&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
<br />
<br />
*&nbsp;&nbsp;CASE&nbsp;PS_COL-FIELDNAME.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CARRID'&nbsp;OR&nbsp;'CARRNAME'.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;항공사ID&nbsp;또는&nbsp;항공사명을&nbsp;더블&nbsp;클릭하면<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;TRANSACTION&nbsp;BC402MCAR&nbsp;를&nbsp;호출한다<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;PS_ROW-ROWTYPE&nbsp;IS&nbsp;INITIAL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;PS_ROW-INDEX..<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SET&nbsp;PARAMETER&nbsp;ID&nbsp;'CAR'&nbsp;FIELD&nbsp;GS_DISPLAY-CARRID.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;TRANSACTION&nbsp;'BC402MCAR'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SKIP&nbsp;FIRST&nbsp;SCREEN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*<br />
*&nbsp;&nbsp;ENDCASE.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_BUTTON_CLICK<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;text<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_ROW_NO<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;ES_COL_ID<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--&gt;&nbsp;SENDER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_BUTTON_CLICK USING PS_ROW_NO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PS_COL_ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PO_SENDER.<br />
<br />
   </div>
   <div class="codeComment">
****&nbsp;MAKE&nbsp;DISPLAY_DATA&nbsp;에서&nbsp;다음과&nbsp;같이&nbsp;버튼&nbsp;필드를&nbsp;설정한다.<br />
*FORM&nbsp;MAKE_DISPLAY_DATA&nbsp;.<br />
*<br />
*&nbsp;&nbsp;DATA&nbsp;LS_STYLE&nbsp;TYPE&nbsp;LVC_S_STYL.&nbsp;&nbsp;"&nbsp;GS_DISPLAY-STYLE&nbsp;의&nbsp;작업공간<br />
*<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
*<br />
*&nbsp;&nbsp;"&nbsp;GT_DATA&nbsp;의&nbsp;데이터를&nbsp;GT_DISPLAY&nbsp;로&nbsp;옮긴다.<br />
*&nbsp;&nbsp;"&nbsp;옮기는&nbsp;중&nbsp;추가로&nbsp;작업할&nbsp;내용들도&nbsp;같이&nbsp;기록한다.<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA&nbsp;INTO&nbsp;GS_DATA.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA&nbsp;TO&nbsp;GS_DISPLAY.&nbsp;"&nbsp;동일한&nbsp;필드명에게&nbsp;값&nbsp;전달<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;내일부터&nbsp;출발하는&nbsp;비행기들은&nbsp;취소가&nbsp;가능하도록&nbsp;버튼을&nbsp;생성함.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-FLDATE&nbsp;&gt;&nbsp;SY-DATUM.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-CANCEL_BTTXT&nbsp;=&nbsp;TEXT-L01.&nbsp;"'일정&nbsp;취소'(L01).<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;CANCEL_BTTXT&nbsp;라는&nbsp;필드는&nbsp;스타일을&nbsp;버튼으로&nbsp;취급하는&nbsp;정보를<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Internal&nbsp;Table&nbsp;인&nbsp;GS_DISPLAY-STYLE&nbsp;에&nbsp;한&nbsp;줄&nbsp;추가한다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;LS_STYLE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STYLE-FIELDNAME&nbsp;=&nbsp;'CANCEL_BTTXT'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STYLE-STYLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;CL_GUI_ALV_GRID=&gt;MC_STYLE_BUTTON.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;LS_STYLE&nbsp;TO&nbsp;GS_DISPLAY-STYLE.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;GS_DATA&nbsp;와&nbsp;그리고&nbsp;내일부터&nbsp;출발하는&nbsp;비행기들만&nbsp;CANCLE_BTTXT&nbsp;필드와<br />
*&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;STYLE&nbsp;필드에&nbsp;특별한&nbsp;값들이&nbsp;저장된&nbsp;GS_DISPLAY&nbsp;를&nbsp;GT_DISPLAY&nbsp;로&nbsp;한&nbsp;줄&nbsp;추가한다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY&nbsp;TO&nbsp;GT_DISPLAY.<br />
*<br />
*&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*ENDFORM.<br />
*--------------------------------------------------------------------*<br />
*&nbsp;SET_ALV_LAYOUT_0100에서&nbsp;다음과&nbsp;같이&nbsp;세팅<br />
*GS_LAYOUT-STYLEFNAME&nbsp;&nbsp;=&nbsp;'STYLE'.<br />
<br />
*--------------------------------------------------------------------*<br />
*&nbsp;구현&nbsp;예시)<br />
*&nbsp;&nbsp;METHOD&nbsp;ON_BUTTON_CLICK.&nbsp;"&nbsp;위&nbsp;정의에&nbsp;대한&nbsp;구현<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LV_MSG&nbsp;TYPE&nbsp;STRING.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;ES_COL_ID-FIELDNAME.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CANCEL_BTTXT'.&nbsp;"&nbsp;일정&nbsp;취소&nbsp;버튼인지<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;현재&nbsp;선택하신&nbsp;버튼은&nbsp;&1&nbsp;번째&nbsp;줄의&nbsp;&2&nbsp;열&nbsp;입니다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&1&nbsp;=&nbsp;ES_ROW_NO-ROW_ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;내가&nbsp;선택한&nbsp;버튼의&nbsp;행&nbsp;위치<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&2&nbsp;=&nbsp;ES_COL_ID-FIELDNAME&nbsp;&nbsp;=&nbsp;내가&nbsp;선택한&nbsp;버튼의&nbsp;열&nbsp;위치<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_MSG&nbsp;=&nbsp;'현재&nbsp;선택하신&nbsp;버튼은&nbsp;'&nbsp;&&&nbsp;ES_ROW_NO-ROW_ID&nbsp;&&&nbsp;'번째&nbsp;줄의'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&&&nbsp;ES_COL_ID-FIELDNAME&nbsp;&&&nbsp;'&nbsp;열&nbsp;입니다.'.<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_MSG&nbsp;=&nbsp;|현재&nbsp;선택하신&nbsp;버튼은&nbsp;{&nbsp;ES_ROW_NO-ROW_ID&nbsp;}|&nbsp;&&<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&nbsp;번째&nbsp;줄의&nbsp;{&nbsp;ES_COL_ID-FIELDNAME&nbsp;}&nbsp;열&nbsp;입니다.|.<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_MSG&nbsp;=&nbsp;|현재&nbsp;선택하신&nbsp;버튼은&nbsp;{&nbsp;ES_ROW_NO-ROW_ID&nbsp;}&nbsp;번째&nbsp;줄의&nbsp;{&nbsp;ES_COL_ID-FIELDNAME&nbsp;}&nbsp;열&nbsp;입니다.&nbsp;|.<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;LV_MSG&nbsp;TYPE&nbsp;'I'.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LV_ANSWER&nbsp;TYPE&nbsp;C.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'POPUP_TO_CONFIRM_STEP_2_BUTTON'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DEFAULTOPTION&nbsp;&nbsp;=&nbsp;'Y'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Cursorpositionierung&nbsp;auf&nbsp;Antwort&nbsp;Ja&nbsp;oder&nbsp;Nein<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXTLINE1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;TEXT-M01&nbsp;"'예약을&nbsp;취소하시겠습니까?'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TEXTLINE2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SPACE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;zweite&nbsp;Zeile&nbsp;des&nbsp;Dialogfensters<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TITEL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;TEXT-T03&nbsp;"&nbsp;확인<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_COLUMN&nbsp;&nbsp;&nbsp;=&nbsp;25&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Startspalte&nbsp;des&nbsp;Dialogfensters<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;START_ROW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Startzeile&nbsp;des&nbsp;Dialogfensters<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CANCEL_DISPLAY&nbsp;=&nbsp;''&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Abbrechen-Knopf&nbsp;anzeigen<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ANSWER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LV_ANSWER.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ausgewählte&nbsp;Antwort&nbsp;des&nbsp;Endanwenders<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LV_MSG&nbsp;=&nbsp;|내가&nbsp;선택한&nbsp;버튼의&nbsp;값은&nbsp;{&nbsp;LV_ANSWER&nbsp;}&nbsp;이다.|.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;LV_MSG&nbsp;TYPE&nbsp;'I'.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;LV_ANSWER.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'J'.&nbsp;"&nbsp;Yes&nbsp;예&nbsp;버튼&nbsp;눌렀을&nbsp;때<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ES_ROW_NO-ROW_ID&nbsp;:&nbsp;내가&nbsp;버튼을&nbsp;누른&nbsp;행&nbsp;번호<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"GT_DISPLAY&nbsp;에서&nbsp;내가&nbsp;누른&nbsp;버튼이&nbsp;있는&nbsp;행을&nbsp;삭제하겠다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;GT_DISPLAY&nbsp;INDEX&nbsp;ES_ROW_NO-ROW_ID.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행의&nbsp;스크롤&nbsp;바&nbsp;고정,&nbsp;가로&nbsp;스크롤바도&nbsp;고정<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.&nbsp;"&nbsp;현재&nbsp;행의&nbsp;위치에&nbsp;여전히&nbsp;머무르겠다.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.&nbsp;"&nbsp;현재&nbsp;열의&nbsp;위치에&nbsp;여전히&nbsp;머무르겠다.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID-&gt;REFRESH_TABLE_DISPLAY<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LS_STABLE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;OTHERS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아니면&nbsp;다른&nbsp;버튼인지<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;HANDLE_DATA_CHANGED<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM HANDLE_DATA_CHANGED<br />
&nbsp;&nbsp;USING&nbsp;PR_DATA_CHANGED&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_ALV_CHANGED_DATA_PROTOCOL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PR_SENDER&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;CL_GUI_ALV_GRID.<br />
<br />
<br />
&nbsp;&nbsp;DATA(LT_MOD)&nbsp;=&nbsp;PR_DATA_CHANGED-&gt;MT_MOD_CELLS[].<br />
<br />
&nbsp;&nbsp;IF&nbsp;LT_MOD[]&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;GV_CHANGED&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT_0160<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT_0160 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER_3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON3'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID_3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER_3<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV_0160<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV_0160 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_3-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_STRUCTURE_NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SDT050'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_SORT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FILTER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;REFRESH_ALV_0160<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM REFRESH_ALV_0160 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STABLE&nbsp;TYPE&nbsp;LVC_S_STBL.<br />
&nbsp;&nbsp;LS_STABLE-ROW&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;LS_STABLE-COL&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_3-&gt;REFRESH_TABLE_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_STABLE&nbsp;=&nbsp;LS_STABLE&nbsp;&nbsp;"&nbsp;With&nbsp;Stable&nbsp;Rows/Columns<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SOFT_REFRESH&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Without&nbsp;Sort,&nbsp;Filter,&nbsp;etc.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FINISHED&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Display&nbsp;was&nbsp;Ended&nbsp;(by&nbsp;Export)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MOVE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MOVE_DATA .<br />
<br />
&nbsp;&nbsp;"&nbsp;헤더는&nbsp;아이템의&nbsp;판매오더&nbsp;번호로&nbsp;찾는다.<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;VBELN&nbsp;=&nbsp;GS_DISPLAY2-VBELN.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;[FI]&nbsp;고객&nbsp;테이블<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_KNA1-BPCUS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-BPCUS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;[BP]&nbsp;고객명<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;[SD]&nbsp;판매오더&nbsp;Header<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT040-VBELN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-VBELN.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;번호<br />
&nbsp;&nbsp;ZEA_SDT040-CUSCODE&nbsp;&nbsp;=&nbsp;GS_DISPLAY-CUSCODE.&nbsp;&nbsp;&nbsp;"&nbsp;[BP]&nbsp;고객코드<br />
&nbsp;&nbsp;ZEA_SDT040-SADDR&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-SADDR.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매&nbsp;배송지&nbsp;주소<br />
&nbsp;&nbsp;ZEA_SDT040-VDATU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-VDATU.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;배송&nbsp;요청일<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;[SD]&nbsp;판매오더&nbsp;Item<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT050-MATNR&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MATNR.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;ZEA_SDT060.<br />
&nbsp;&nbsp;CLEAR&nbsp;ZEA_SDT110.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;[SD]&nbsp;출고오더&nbsp;Header<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-VBELN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-VBELN.&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;번호<br />
&nbsp;&nbsp;ZEA_SDT060-DQDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-VDATU.<br />
&nbsp;&nbsp;ZEA_SDT060-DADAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-VDATU&nbsp;.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;[MM]&nbsp;자재&nbsp;텍스트&nbsp;테이블<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_MMT020-MAKTX&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MAKTX.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY3.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY3.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA_2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA_2 .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY-VBELN.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;VBELN.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_DATA .<br />
<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;알고리즘<br />
*&&nbsp;1)&nbsp;ZEA_SDT060에서&nbsp;판매오더&nbsp;번호를&nbsp;찾지&nbsp;못했을&nbsp;경우&nbsp;-&gt;&nbsp;무조건&nbsp;채번<br />
*&&nbsp;2)&nbsp;ZEA_SDT060에서&nbsp;판매오더&nbsp;번호를&nbsp;찾았을&nbsp;경우<br />
*&&nbsp;3)&nbsp;ZEA_SDT060에&nbsp;판매오더&nbsp;번호가&nbsp;같고&nbsp;고객번호가&nbsp;같을&nbsp;때,<br />
*&&nbsp;4-1)&nbsp;해당&nbsp;되는&nbsp;데이터&nbsp;값을&nbsp;찾고,&nbsp;찾은&nbsp;데이터의&nbsp;저장되어&nbsp;있는&nbsp;출고&nbsp;요청일과<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;새로&nbsp;입력한&nbsp;출고일(ZEA_SDT060-RQDAT)&nbsp;이&nbsp;같으면&nbsp;-&gt;&nbsp;채번&nbsp;X,&nbsp;인덱스&nbsp;증가<br />
*&&nbsp;4-2)&nbsp;해당&nbsp;되는&nbsp;데이터&nbsp;값을&nbsp;찾고,&nbsp;찾은&nbsp;데이터의&nbsp;저장되어&nbsp;있는&nbsp;출고&nbsp;요청일과<br />
*&&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;새로&nbsp;입력한&nbsp;출고일(ZEA_SDT060-RQDAT)&nbsp;이&nbsp;다르면&nbsp;&nbsp;-&gt;&nbsp;채번<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;LV_COUNT&nbsp;TYPE&nbsp;I.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_MMT190<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;EQ&nbsp;ZEA_SDT050-MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;ZEA_SDT060-WERKS.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;"&nbsp;출고&nbsp;헤더에서&nbsp;판매오더번호&nbsp;기준으로&nbsp;검색<br />
&nbsp;&nbsp;SELECT&nbsp;SBELNR&nbsp;VBELN&nbsp;RQDAT&nbsp;CUSCODE&nbsp;WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT060<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_CHECK<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY2-VBELN.<br />
<br />
&nbsp;&nbsp;DESCRIBE&nbsp;TABLE&nbsp;GT_CHECK&nbsp;LINES&nbsp;GV_LINES.<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1.&nbsp;전체&nbsp;수량&nbsp;비교&nbsp;-&gt;&nbsp;IF<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-AUQUA&nbsp;&gt;&nbsp;GS_MMT190-CALQTY.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;GS_MMT190에&nbsp;DEC_TABLE_DATA를&nbsp;통해서&nbsp;값이&nbsp;들어가&nbsp;있음.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E037.&nbsp;"&nbsp;재고가&nbsp;부족합니다.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2.&nbsp;필요수량에서&nbsp;배치의&nbsp;보유&nbsp;수량만큼&nbsp;제거(보유&nbsp;수량이&nbsp;같거나&nbsp;적을&nbsp;때만&nbsp;제거)<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;배치의&nbsp;보유수량이&nbsp;많으면&nbsp;필요한&nbsp;만큼만&nbsp;제거.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;GV_LINES&nbsp;EQ&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;출고&nbsp;문서번호를&nbsp;무조건&nbsp;채번해야되는&nbsp;경우<br />
&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_NUMBER.<br />
&nbsp;&nbsp;ELSE.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;경우의&nbsp;수에&nbsp;따라&nbsp;채번을&nbsp;할지&nbsp;/&nbsp;Index&nbsp;만&nbsp;올릴지<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_CHECK&nbsp;INTO&nbsp;GS_CHECK<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;RQDAT&nbsp;=&nbsp;ZEA_SDT060-RQDAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;동일한&nbsp;출고일자,&nbsp;플랜트가&nbsp;있음&nbsp;=&gt;&nbsp;해당&nbsp;출고&nbsp;문서의&nbsp;인덱스&nbsp;추가<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;NOT_CREATE_NUMBER&nbsp;USING&nbsp;GS_CHECK-SBELNR.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;동일한&nbsp;출고일자,&nbsp;플랜트가&nbsp;없음&nbsp;=&gt;&nbsp;신규&nbsp;출고&nbsp;문서번호&nbsp;생성<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_NUMBER.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
***&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;채번&nbsp;하지않고&nbsp;출하&nbsp;아이템&nbsp;테이블에&nbsp;인덱스만&nbsp;추가하여&nbsp;DB&nbsp;저장<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;&nbsp;ZEA_SDT060-VBELN&nbsp;EQ&nbsp;GS_CHECK-VBELN&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-CUSCODE&nbsp;EQ&nbsp;GS_CHECK-CUSCODE&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;EQ&nbsp;GS_CHECK-RQDAT&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST&nbsp;EQ&nbsp;GS_CHECK-WERKS.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;NOT_CREATE_NUMBER.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;출하&nbsp;요청일이&nbsp;다르고,&nbsp;출하되는&nbsp;플랜트도&nbsp;다르면&nbsp;새로운&nbsp;출고&nbsp;문서번호&nbsp;채번<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;ZEA_SDT060-VBELN&nbsp;EQ&nbsp;GS_CHECK-VBELN&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-CUSCODE&nbsp;EQ&nbsp;GS_CHECK-CUSCODE&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;NE&nbsp;GS_CHECK-RQDAT&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST&nbsp;NE&nbsp;GS_CHECK-WERKS.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_NUMBER.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;출하&nbsp;요청일은&nbsp;같지만,&nbsp;출하되는&nbsp;플랜트가&nbsp;다를&nbsp;경우&nbsp;출고&nbsp;문서번호&nbsp;채번<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;ZEA_SDT060-VBELN&nbsp;EQ&nbsp;GS_CHECK-VBELN&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-CUSCODE&nbsp;EQ&nbsp;GS_CHECK-CUSCODE&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;EQ&nbsp;GS_CHECK-RQDAT&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST&nbsp;NE&nbsp;GS_CHECK-WERKS.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_NUMBER.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;출하&nbsp;요청일이&nbsp;다르지만,&nbsp;출하되는&nbsp;플랜트는&nbsp;동일할&nbsp;경우&nbsp;출고&nbsp;문서번호&nbsp;채번<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;ZEA_SDT060-VBELN&nbsp;EQ&nbsp;GS_CHECK-VBELN&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT040-CUSCODE&nbsp;EQ&nbsp;GS_CHECK-CUSCODE&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;NE&nbsp;GS_CHECK-RQDAT&nbsp;AND<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GV_LIST&nbsp;EQ&nbsp;GS_CHECK-WERKS.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_NUMBER.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INVOICE_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INVOICE_FILTER .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INVOICE_OK_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INVOICE_OK_FILTER .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INVOICE_NO_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INVOICE_NO_FILTER .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_DATA_CASE2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_DATA_CASE2 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
&nbsp;&nbsp;DATA&nbsp;LT_SDT110&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT110.<br />
&nbsp;&nbsp;DATA&nbsp;LS_SDT110&nbsp;TYPE&nbsp;ZEA_SDT110.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;LV_YEAR&nbsp;TYPE&nbsp;N&nbsp;LENGTH&nbsp;4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;LV_CUSCODE&nbsp;TYPE&nbsp;ZEA_SDT110-CUSCODE.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'001'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_VBELN'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;number&nbsp;range&nbsp;object<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-VBELN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;free&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;not&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;is&nbsp;not&nbsp;internal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Object&nbsp;not&nbsp;defined&nbsp;in&nbsp;TNRO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;used&nbsp;up.&nbsp;Change&nbsp;not&nbsp;possible.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffer&nbsp;is&nbsp;full<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'00'&nbsp;IN&nbsp;ZEA_SDT060-VBELN&nbsp;WITH&nbsp;'SB'.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;CUSCODE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_CUSCODE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;EQ&nbsp;GS_DISPLAY-MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;GS_DISPLAY-WERKS.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT110-CUSCODE&nbsp;=&nbsp;LV_CUSCODE.<br />
<br />
&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;ZEA_SDT060-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;ZEA_SDT060-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;ZEA_SDT060-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
&nbsp;&nbsp;ZEA_SDT060-VBELN&nbsp;=&nbsp;GS_DISPLAY-VBELN.<br />
&nbsp;&nbsp;ZEA_SDT060-CUSCODE&nbsp;=&nbsp;GS_DISPLAY-CUSCODE.<br />
&nbsp;&nbsp;ZEA_SDT060-ADRNR&nbsp;=&nbsp;GS_DISPLAY-SADDR.<br />
&nbsp;&nbsp;ZEA_SDT060-RETSU&nbsp;=&nbsp;'출고&nbsp;완료'.<br />
&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;=&nbsp;ZEA_SDT060-RQDAT.<br />
&nbsp;&nbsp;ZEA_SDT060-REDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;ZEA_SDT060-DQDAT&nbsp;=&nbsp;SY-DATUM&nbsp;+&nbsp;3.<br />
&nbsp;&nbsp;ZEA_SDT060-DADAT&nbsp;=&nbsp;SY-DATUM&nbsp;+&nbsp;3.<br />
&nbsp;&nbsp;ZEA_SDT060-DESTU&nbsp;=&nbsp;'배송중'.<br />
&nbsp;&nbsp;ZEA_SDT060-STATUS&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;ZEA_SDT110-POSNR&nbsp;=&nbsp;'0000000010'.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT060.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_DATA_CASE1<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_DATA_CASE1 .<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT2_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT2_0100 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER_2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON2'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID_2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER_2<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT2_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT2_0100 .<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT_0100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT2_0100.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT2_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT2_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE2.<br />
<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GV_SAVE2&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
<br />
&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;최적화<br />
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZEBRA<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'B'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;단위&nbsp;선택<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T01.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV2_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV2_0100 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_2-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT2_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT2_0100 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'자재명'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C500'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'STATUS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ICON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;=&nbsp;'출고&nbsp;문서&nbsp;유/무'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-ICON&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AUQUA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C300'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'NETPR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C310'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AUAMO'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-EMPHASIZE&nbsp;=&nbsp;'C310'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA_LISTBOX<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA_LISTBOX .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;DISTINCT&nbsp;WERKS&nbsp;PNAME1<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_T001W<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_LIST.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT_0160<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT_0160 .<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT_0100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DISPLAY2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT2_0160.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT2_0160<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT2_0160 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT&nbsp;INTO&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'자재명'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AUQUA'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-QFIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'NETPR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'AUAMO'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'ICON'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'STATUS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;=&nbsp;ABAP_ON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SBELNR'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-NO_OUT&nbsp;=&nbsp;ABAP_ON.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT&nbsp;FROM&nbsp;GS_FIELDCAT.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT_0160<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT_0160 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE3.<br />
<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GV_SAVE2&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
<br />
&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;최적화<br />
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZEBRA<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'B'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;단위&nbsp;선택<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T01.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_NUMBER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_NUMBER .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_MSG&nbsp;TYPE&nbsp;STRING.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
&nbsp;&nbsp;DATA&nbsp;LS_SDT110&nbsp;TYPE&nbsp;ZEA_SDT110.&nbsp;&nbsp;"&nbsp;출고문서&nbsp;아이템<br />
<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'NUMBER_GET_NEXT'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NR_RANGE_NR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'01'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_SBELNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;number&nbsp;range&nbsp;object<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-SBELNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;free&nbsp;number<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;not&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NUMBER_RANGE_NOT_INTERN&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;range&nbsp;is&nbsp;not&nbsp;internal<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OBJECT_NOT_FOUND&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Object&nbsp;not&nbsp;defined&nbsp;in&nbsp;TNRO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;&gt;&nbsp;0<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;QUANTITY_IS_NOT_1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Number&nbsp;of&nbsp;numbers&nbsp;requested&nbsp;must&nbsp;be&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTERVAL_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Interval&nbsp;used&nbsp;up.&nbsp;Change&nbsp;not&nbsp;possible.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BUFFER_OVERFLOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Buffer&nbsp;is&nbsp;full<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;REPLACE&nbsp;FIRST&nbsp;OCCURRENCE&nbsp;OF&nbsp;'00'&nbsp;IN&nbsp;ZEA_SDT060-SBELNR&nbsp;WITH&nbsp;'SL'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-SBELNR(2)&nbsp;=&nbsp;'SL'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT060-VBELN&nbsp;&nbsp;=&nbsp;.&nbsp;이미&nbsp;화면에&nbsp;출력중<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-CUSCODE&nbsp;&nbsp;=&nbsp;ZEA_SDT040-CUSCODE.<br />
&nbsp;&nbsp;ZEA_SDT060-ADRNR&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-SADDR.<br />
&nbsp;&nbsp;ZEA_SDT060-WERKS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;출고&nbsp;요청일이&nbsp;오늘보다&nbsp;늦을&nbsp;경우&nbsp;-&gt;&nbsp;출고대기<br />
*&nbsp;출고&nbsp;요청일&nbsp;=&nbsp;오늘&nbsp;날짜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;출고완료<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;ZEA_SDT060-RQDAT&nbsp;LE&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-RQDAT.&nbsp;"&nbsp;출고요청일<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-REDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.&nbsp;"&nbsp;출고일<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RETSU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'출고&nbsp;완료'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-DESTU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'배송중'.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-RQDAT.&nbsp;"&nbsp;출고요청일<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-REDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-RQDAT.&nbsp;"&nbsp;출고일<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-RETSU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'출고&nbsp;대기'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT060-DESTU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'배송&nbsp;대기'.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ZEA_SDT060-DQDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;ZEA_SDT040-VDATU.&nbsp;"&nbsp;이미&nbsp;화면에&nbsp;출력중&nbsp;배송&nbsp;요청일<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT060-DADAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"&nbsp;이미&nbsp;화면에&nbsp;출력중<br />
*&nbsp;&nbsp;ZEA_SDT060-STATUS&nbsp;&nbsp;&nbsp;=&nbsp;?<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;ZEA_SDT060-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;ZEA_SDT060-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT060&nbsp;.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'출고&nbsp;문서&nbsp;데이터&nbsp;추가에&nbsp;실패했습니다.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*---&nbsp;출하&nbsp;운송&nbsp;아이템&nbsp;테이블에&nbsp;저장<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_SDT060&nbsp;&nbsp;TO&nbsp;LS_SDT110.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;LS_SDT110.<br />
<br />
&nbsp;&nbsp;LS_SDT110-SBELNR&nbsp;&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
&nbsp;&nbsp;LS_SDT110-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;'0010'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LS_SDT110-VBELN&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-VBELN.<br />
*&nbsp;&nbsp;LS_SDT110-CUSCODE&nbsp;=&nbsp;ZEA_SDT060-CUSCODE.<br />
*&nbsp;&nbsp;LS_SDT110-ADRNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-ADRNR.<br />
*&nbsp;&nbsp;LS_SDT110-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_SDT110-MATNR&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MATNR.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LS_SDT110-AUQUA&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-AUQUA.<br />
*&nbsp;&nbsp;LS_SDT110-MEINS&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MEINS.<br />
*&nbsp;&nbsp;LS_SDT110-STATUS&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-STATUS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_SDT110-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;LS_SDT110-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;LS_SDT110-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT110&nbsp;FROM&nbsp;LS_SDT110.&nbsp;"&nbsp;출하&nbsp;운송&nbsp;아이템에&nbsp;Insert<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'출고&nbsp;문서&nbsp;데이터&nbsp;추가에&nbsp;실패했습니다.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;판매&nbsp;오더&nbsp;아이템&nbsp;상태플래그에&nbsp;업데이트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT050&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;POSNR&nbsp;EQ&nbsp;GS_DISPLAY2-POSNR.<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;ICON&nbsp;DESCENDING.<br />
<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
<br />
&nbsp;&nbsp;"&nbsp;판매오더&nbsp;아이템의&nbsp;아이콘&nbsp;변경<br />
&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2&nbsp;TRANSPORTING&nbsp;ICON&nbsp;SBELNR&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY2-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;POSNR&nbsp;EQ&nbsp;GS_DISPLAY2-POSNR.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;COUNT(*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;&nbsp;EQ&nbsp;ZEA_SDT060-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;STATUS&nbsp;NE&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'I'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;헤더의&nbsp;아이콘&nbsp;변경<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;WITH&nbsp;KEY&nbsp;VBELN&nbsp;=&nbsp;GS_DISPLAY2-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;헤더의&nbsp;아이콘&nbsp;변경<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;WITH&nbsp;KEY&nbsp;VBELN&nbsp;=&nbsp;GS_DISPLAY2-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;PERFORM&nbsp;SBELNR_DATA.<br />
*&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
<br />
*&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GO_ALV_GRID_1-&gt;REFRESH_TABLE_DISPLAY(&nbsp;IS_STABLE&nbsp;=&nbsp;VALUE&nbsp;#(&nbsp;ROW&nbsp;=&nbsp;'X'&nbsp;COL&nbsp;=&nbsp;'X'&nbsp;)&nbsp;).<br />
&nbsp;&nbsp;GO_ALV_GRID_2-&gt;REFRESH_TABLE_DISPLAY(&nbsp;IS_STABLE&nbsp;=&nbsp;VALUE&nbsp;#(&nbsp;ROW&nbsp;=&nbsp;'X'&nbsp;COL&nbsp;=&nbsp;'X'&nbsp;)&nbsp;).<br />
<br />
&nbsp;&nbsp;LV_MSG&nbsp;=&nbsp;|출고&nbsp;문서&nbsp;번호&nbsp;{&nbsp;ZEA_SDT060-SBELNR&nbsp;}&nbsp;가&nbsp;생성되었습니다.&nbsp;|.<br />
<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;IS_HEAD&nbsp;TYPE&nbsp;ZEA_MMT090,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ITEM&nbsp;TYPE&nbsp;ZEA_MMY100.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;EV_RETURN(1),&nbsp;LV_RETURN(1).<br />
   </div>
   <div class="codeComment">
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;LV_SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
   </div>
   <div class="codeComment">
*<br />
*&nbsp;[오류보고]&nbsp;2024.05.04&nbsp;:&nbsp;FI&nbsp;테스트를&nbsp;위해서&nbsp;실행하였으나,&nbsp;MM함수&nbsp;Exporting&nbsp;IS_HEAD,&nbsp;IT_ITEM&nbsp;내보내는&nbsp;값이&nbsp;없음.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(자재문서번호는&nbsp;EXPORTING&nbsp;시&nbsp;제외하고&nbsp;테스트&nbsp;중)<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zea_mm_sdfg/zea_mm_sdfg.html">'ZEA_MM_SDFG'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IV_SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR&nbsp;&nbsp;&nbsp;"출고문서번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IV_POSNR&nbsp;&nbsp;=&nbsp;LS_SDT110-POSNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"출고문서&nbsp;품목번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_HEAD&nbsp;&nbsp;&nbsp;=&nbsp;IS_HEAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[MM]&nbsp;자재문서&nbsp;Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ITEM&nbsp;&nbsp;&nbsp;=&nbsp;IT_ITEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"자재문서&nbsp;ITEM&nbsp;테이블타입<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EV_RETURN&nbsp;=&nbsp;LV_RETURN.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Message&nbsp;Type('S':성공,&nbsp;'E':실패)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zea_fi_wl/zea_fi_wl.html">'ZEA_FI_WL'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_HEAD&nbsp;=&nbsp;IS_HEAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;[MM]&nbsp;자재문서&nbsp;Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ITEM&nbsp;=&nbsp;IT_ITEM.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재문서&nbsp;ITEM&nbsp;테이블타입<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IV_MBLNR&nbsp;=&nbsp;IV_MBLNR.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재문서&nbsp;번호<br />
<br />
<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;LV_MSG&nbsp;TYPE&nbsp;'S'.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S016&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*<br />
*<br />
*<br />
*<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
*&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
*&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA<br />
*&nbsp;&nbsp;WHERE&nbsp;A~STATUS2&nbsp;=&nbsp;'X'.<br />
*<br />
*&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
*<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-STATUS&nbsp;EQ&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY-STATUS&nbsp;EQ&nbsp;'I'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY.<br />
**&nbsp;&nbsp;ENDLOOP.<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
*&nbsp;&nbsp;PERFORM&nbsp;SELECT_DISPLAY_DATA.<br />
**&nbsp;&nbsp;PERFORM&nbsp;MODIFY_DISPLAY_DATA.<br />
**&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
**--------------------------------------------------------------------*<br />
*<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
*&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;SELECT&nbsp;A~STATUS&nbsp;A~VBELN&nbsp;A~POSNR&nbsp;A~MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~MAKTX&nbsp;A~AUQUA&nbsp;A~MEINS&nbsp;A~NETPR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AUAMO&nbsp;A~WAERS<br />
*&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A<br />
*&nbsp;JOIN&nbsp;ZEA_SDT040&nbsp;AS&nbsp;B<br />
*&nbsp;&nbsp;&nbsp;ON&nbsp;B~VBELN&nbsp;EQ&nbsp;A~VBELN<br />
*&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C<br />
*&nbsp;&nbsp;&nbsp;ON&nbsp;C~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
*&nbsp;&nbsp;AND&nbsp;SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
*&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA2<br />
*&nbsp;WHERE&nbsp;A~VBELN&nbsp;EQ&nbsp;LS_SDT110-VBELN.<br />
*<br />
*&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;STATUS&nbsp;VBELN.<br />
*<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
*&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY2_DATA.<br />
*<br />
**&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-STATUS&nbsp;EQ&nbsp;'X'.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY2-STATUS&nbsp;EQ&nbsp;''.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2.<br />
**&nbsp;&nbsp;ENDLOOP.<br />
*<br />
*<br />
*&nbsp;&nbsp;DATA(LV_COUNT2)&nbsp;=&nbsp;REDUCE&nbsp;I(&nbsp;INIT&nbsp;COUNT&nbsp;=&nbsp;0&nbsp;FOR&nbsp;WA&nbsp;IN&nbsp;GT_DISPLAY2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;(&nbsp;STATUS&nbsp;=&nbsp;'X'&nbsp;)&nbsp;NEXT&nbsp;COUNT&nbsp;=&nbsp;COUNT&nbsp;+&nbsp;1&nbsp;).<br />
*&nbsp;&nbsp;DATA(LV_COUNT3)&nbsp;=&nbsp;LINES(&nbsp;GT_DISPLAY2&nbsp;).<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;LV_COUNT2&nbsp;EQ&nbsp;LV_COUNT3.<br />
*<br />
**---&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;테이블&nbsp;STATUS에&nbsp;값&nbsp;저장&nbsp;로직<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;ZEA_SDT040<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
*<br />
**--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
*&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;GT_DATA.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
*&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
*&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
*&nbsp;&nbsp;ENDIF.<br />
*<br />
*&nbsp;&nbsp;PERFORM&nbsp;SELECT_DISPLAY_DATA.<br />
*&nbsp;&nbsp;PERFORM&nbsp;MODIFY_DISPLAY_DATA.<br />
*&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
*<br />
*<br />
*<br />
*&nbsp;&nbsp;IF&nbsp;LV_SUBRC&nbsp;EQ&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S015.&nbsp;"데이터가&nbsp;성공적으로&nbsp;저장되었습니다.<br />
*&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S016&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
*&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;NOT_CREATE_NUMBER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM NOT_CREATE_NUMBER USING PV_SBELNR TYPE ZEA_SDT060-SBELNR.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LV_MSG2&nbsp;TYPE&nbsp;STRING.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;MAX(&nbsp;POSNR&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT110<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;ZEA_SDT110-POSNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SBELNR&nbsp;EQ&nbsp;PV_SBELNR.<br />
<br />
<br />
&nbsp;&nbsp;ZEA_SDT060-SBELNR&nbsp;=&nbsp;PV_SBELNR.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT060-VBELN&nbsp;&nbsp;=&nbsp;.&nbsp;이미&nbsp;화면에&nbsp;출력중<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-CUSCODE&nbsp;&nbsp;=&nbsp;ZEA_SDT040-CUSCODE.<br />
&nbsp;&nbsp;ZEA_SDT060-ADRNR&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-SADDR.<br />
&nbsp;&nbsp;ZEA_SDT060-WERKS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
&nbsp;&nbsp;ZEA_SDT060-RETSU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'출고&nbsp;완료'.<br />
&nbsp;&nbsp;ZEA_SDT060-RQDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DATUM.&nbsp;"&nbsp;출고요청일<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT060-REDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;.&nbsp;"&nbsp;출고일<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-DQDAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;"&nbsp;이미&nbsp;화면에&nbsp;출력중&nbsp;배송&nbsp;요청일<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT060-DADAT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;"&nbsp;이미&nbsp;화면에&nbsp;출력중<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-DESTU&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'배송중'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;ZEA_SDT060-STATUS&nbsp;&nbsp;&nbsp;=&nbsp;?<br />
   </div>
   <div class="code">
&nbsp;&nbsp;ZEA_SDT060-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;ZEA_SDT060-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;ZEA_SDT060-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
<br />
   </div>
   <div class="codeComment">
*---&nbsp;출하&nbsp;운송&nbsp;아이템&nbsp;테이블에&nbsp;저장<br />
   </div>
   <div class="code">
&nbsp;&nbsp;DATA&nbsp;LS_SDT110&nbsp;TYPE&nbsp;ZEA_SDT110.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;ZEA_SDT060&nbsp;&nbsp;TO&nbsp;LS_SDT110.<br />
&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;LS_SDT110.<br />
<br />
&nbsp;&nbsp;LS_SDT110-SBELNR&nbsp;&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
&nbsp;&nbsp;LS_SDT110-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT110-POSNR&nbsp;+&nbsp;10.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LS_SDT110-VBELN&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-VBELN.<br />
*&nbsp;&nbsp;LS_SDT110-CUSCODE&nbsp;=&nbsp;ZEA_SDT060-CUSCODE.<br />
*&nbsp;&nbsp;LS_SDT110-ADRNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-ADRNR.<br />
*&nbsp;&nbsp;LS_SDT110-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_SDT110-MATNR&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MATNR.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;LS_SDT110-AUQUA&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-AUQUA.<br />
*&nbsp;&nbsp;LS_SDT110-MEINS&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MEINS.<br />
*&nbsp;&nbsp;LS_SDT110-STATUS&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-STATUS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LS_SDT110-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
&nbsp;&nbsp;LS_SDT110-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
&nbsp;&nbsp;LS_SDT110-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
<br />
<br />
&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT110&nbsp;FROM&nbsp;LS_SDT110.&nbsp;"&nbsp;출하&nbsp;운송&nbsp;아이템에&nbsp;Insert<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;'출고&nbsp;문서&nbsp;데이터&nbsp;추가에&nbsp;실패했습니다.'&nbsp;TYPE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;판매&nbsp;오더&nbsp;아이템&nbsp;상태플래그에&nbsp;업데이트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT050&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;POSNR&nbsp;EQ&nbsp;GS_DISPLAY2-POSNR.<br />
<br />
&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
<br />
&nbsp;&nbsp;"&nbsp;판매오더&nbsp;아이템의&nbsp;아이콘&nbsp;변경<br />
&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2&nbsp;TRANSPORTING&nbsp;ICON&nbsp;SBELNR&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY2-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;POSNR&nbsp;EQ&nbsp;GS_DISPLAY2-POSNR.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;COUNT(*)<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050<br />
&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;&nbsp;EQ&nbsp;ZEA_SDT060-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;STATUS&nbsp;NE&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'I'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;헤더의&nbsp;아이콘&nbsp;변경<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;WITH&nbsp;KEY&nbsp;VBELN&nbsp;=&nbsp;GS_DISPLAY2-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
   </div>
   <div class="codeComment">
*--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;헤더의&nbsp;아이콘&nbsp;변경<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY&nbsp;WITH&nbsp;KEY&nbsp;VBELN&nbsp;=&nbsp;GS_DISPLAY2-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY&nbsp;INDEX&nbsp;SY-TABIX.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;ICON.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;LV_MSG2&nbsp;=&nbsp;|출고&nbsp;문서&nbsp;번호&nbsp;{&nbsp;PV_SBELNR&nbsp;}&nbsp;가&nbsp;생성되었습니다.&nbsp;|.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;IS_HEAD&nbsp;&nbsp;TYPE&nbsp;ZEA_MMT090,<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ITEM&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_MMT100.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ITEM&nbsp;&nbsp;TYPE&nbsp;ZEA_MMY100.<br />
<br />
&nbsp;&nbsp;&nbsp;DATA:&nbsp;EV_RETURN(1),&nbsp;LV_RETURN(1).<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zea_mm_sdfg/zea_mm_sdfg.html">'ZEA_MM_SDFG'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IV_SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR&nbsp;&nbsp;&nbsp;"출고문서번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IV_POSNR&nbsp;&nbsp;=&nbsp;LS_SDT110-POSNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"출고문서&nbsp;품목번호<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ES_HEAD&nbsp;&nbsp;&nbsp;=&nbsp;IS_HEAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[MM]&nbsp;자재문서&nbsp;Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ITEM&nbsp;&nbsp;&nbsp;=&nbsp;IT_ITEM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"자재문서&nbsp;ITEM&nbsp;테이블타입<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EV_RETURN&nbsp;=&nbsp;LV_RETURN.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Message&nbsp;Type('S':성공,&nbsp;'E':실패)<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;call&nbsp;function&nbsp;<a&nbsp;href&nbsp;="zea_fi_wl/zea_fi_wl.html">'ZEA_FI_WL'</a><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_HEAD&nbsp;=&nbsp;IS_HEAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;[MM]&nbsp;자재문서&nbsp;Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_ITEM&nbsp;=&nbsp;IT_ITEM.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재문서&nbsp;ITEM&nbsp;테이블타입<br />
<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S016&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;PERFORM&nbsp;SBELNR_DATA.<br />
*&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;PV_SBELNR.<br />
<br />
*&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;PV_SBELNR.<br />
*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
<br />
<br />
<br />
   </div>
   <div class="codeComment">
**<br />
***&nbsp;&nbsp;DATA&nbsp;LV_MSG&nbsp;TYPE&nbsp;STRING.<br />
**<br />
**&nbsp;&nbsp;DATA&nbsp;LV_SUBRC&nbsp;TYPE&nbsp;I.<br />
***&nbsp;&nbsp;DATA&nbsp;LV_SBELNR&nbsp;TYPE&nbsp;ZEA_SDT060-SBELNR.<br />
**&nbsp;&nbsp;DATA&nbsp;LT_SDT110&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT110.<br />
**&nbsp;&nbsp;DATA&nbsp;LS_SDT110&nbsp;TYPE&nbsp;ZEA_SDT110.<br />
**<br />
**&nbsp;&nbsp;DATA&nbsp;LT_SDT040&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;ZEA_SDT040.<br />
**&nbsp;&nbsp;DATA&nbsp;LS_SDT040&nbsp;TYPE&nbsp;ZEA_SDT040.<br />
**<br />
**&nbsp;&nbsp;DATA&nbsp;LT_INDEX_ROWS&nbsp;TYPE&nbsp;LVC_T_ROW.<br />
**&nbsp;&nbsp;DATA&nbsp;LS_INDEX_ROW&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_INDEX_ROWS.<br />
**<br />
**&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_3-&gt;GET_SELECTED_ROWS<br />
**&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_INDEX_ROWS&nbsp;=&nbsp;LT_INDEX_ROWS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Indexes&nbsp;of&nbsp;Selected&nbsp;Rows<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_ROW_NO&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Numeric&nbsp;IDs&nbsp;of&nbsp;Selected&nbsp;Rows<br />
**&nbsp;&nbsp;&nbsp;&nbsp;.<br />
**<br />
***&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;SBELNR<br />
***&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;LV_SBELNR<br />
***&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT060<br />
***&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;GS_DISPLAY-VBELN.<br />
**<br />
**&nbsp;&nbsp;SELECT&nbsp;MAX(&nbsp;POSNR&nbsp;)<br />
**&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT110<br />
**&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;ZEA_SDT110-POSNR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SBELNR&nbsp;EQ&nbsp;PV_SBELNR.<br />
**<br />
**&nbsp;&nbsp;ZEA_SDT110-POSNR&nbsp;=&nbsp;ZEA_SDT110-POSNR&nbsp;+&nbsp;10.<br />
**&nbsp;&nbsp;ZEA_SDT060-SBELNR&nbsp;=&nbsp;PV_SBELNR.<br />
**<br />
***---&nbsp;출하&nbsp;운송&nbsp;아이템&nbsp;테이블에&nbsp;저장<br />
***&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
**<br />
**&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;LS_SDT110.<br />
**<br />
**&nbsp;&nbsp;LS_SDT110-SBELNR&nbsp;&nbsp;=&nbsp;PV_SBELNR.<br />
**&nbsp;&nbsp;LS_SDT110-POSNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT110-POSNR.<br />
**&nbsp;&nbsp;LS_SDT110-VBELN&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT060-VBELN.<br />
**&nbsp;&nbsp;LS_SDT110-CUSCODE&nbsp;=&nbsp;ZEA_SDT040-CUSCODE.<br />
**&nbsp;&nbsp;LS_SDT110-ADRNR&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY-SADDR.<br />
**&nbsp;&nbsp;LS_SDT110-WERKS&nbsp;&nbsp;&nbsp;=&nbsp;GV_LIST.<br />
**&nbsp;&nbsp;LS_SDT110-MATNR&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT050-MATNR.<br />
**&nbsp;&nbsp;LS_SDT110-MEINS&nbsp;&nbsp;&nbsp;=&nbsp;GS_DISPLAY2-MEINS.<br />
**&nbsp;&nbsp;LS_SDT110-ERDAT&nbsp;=&nbsp;SY-DATUM.<br />
**&nbsp;&nbsp;LS_SDT110-ERNAM&nbsp;=&nbsp;SY-UNAME.<br />
**&nbsp;&nbsp;LS_SDT110-ERZET&nbsp;=&nbsp;SY-UZEIT.<br />
**<br />
**<br />
**&nbsp;&nbsp;INSERT&nbsp;ZEA_SDT110&nbsp;FROM&nbsp;LS_SDT110.&nbsp;"&nbsp;출하&nbsp;운송&nbsp;아이템에&nbsp;Insert<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;LV_SUBRC&nbsp;=&nbsp;4.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
***&nbsp;&nbsp;ENDLOOP.<br />
**<br />
***---&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;테이블&nbsp;STATUS에&nbsp;값&nbsp;저장&nbsp;로직<br />
**&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
**&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;ZEA_SDT040<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
**<br />
***--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
**&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'I'<br />
**&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
**<br />
***---&nbsp;판매&nbsp;오더&nbsp;아이템&nbsp;테이블&nbsp;STATUS에&nbsp;값&nbsp;저장&nbsp;로직<br />
**&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050<br />
**&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;ZEA_SDT050<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN.<br />
**<br />
***--&nbsp;판매&nbsp;오더&nbsp;아이템&nbsp;상태플래그에&nbsp;업데이트<br />
**&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT050&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT060-VBELN<br />
**&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;POSNR&nbsp;EQ&nbsp;LS_SDT110-POSNR.<br />
**<br />
**&nbsp;&nbsp;SELECT&nbsp;*<br />
**&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
**&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
**&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA.<br />
**<br />
**&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
**<br />
***&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-STATUS&nbsp;EQ&nbsp;'X'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY-STATUS&nbsp;EQ&nbsp;'I'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY.<br />
***&nbsp;&nbsp;ENDLOOP.<br />
**&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
**&nbsp;&nbsp;PERFORM&nbsp;SELECT_DISPLAY_DATA.<br />
***&nbsp;&nbsp;PERFORM&nbsp;MODIFY_DISPLAY_DATA.<br />
***&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
***--------------------------------------------------------------------*<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
**&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
**<br />
**&nbsp;&nbsp;SELECT&nbsp;A~STATUS&nbsp;A~VBELN&nbsp;A~POSNR&nbsp;A~MATNR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~MAKTX&nbsp;A~AUQUA&nbsp;A~MEINS&nbsp;A~NETPR<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AUAMO&nbsp;A~WAERS<br />
**&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A<br />
**&nbsp;JOIN&nbsp;ZEA_SDT040&nbsp;AS&nbsp;B<br />
**&nbsp;&nbsp;&nbsp;ON&nbsp;B~VBELN&nbsp;EQ&nbsp;A~VBELN<br />
**&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C<br />
**&nbsp;&nbsp;&nbsp;ON&nbsp;C~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
**&nbsp;&nbsp;AND&nbsp;SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
**&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA2<br />
**&nbsp;WHERE&nbsp;A~VBELN&nbsp;EQ&nbsp;LS_SDT110-VBELN.<br />
**<br />
**&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;STATUS&nbsp;VBELN.<br />
**<br />
**&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
**<br />
**&nbsp;&nbsp;PERFORM&nbsp;SELECT_DISPLAY_DATA.<br />
**&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY2_DATA.<br />
**<br />
***&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-STATUS&nbsp;EQ&nbsp;'X'.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY2-STATUS&nbsp;EQ&nbsp;''.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
***<br />
***&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2.<br />
***&nbsp;&nbsp;ENDLOOP.<br />
**<br />
**<br />
**&nbsp;&nbsp;DATA(LV_COUNT2)&nbsp;=&nbsp;REDUCE&nbsp;I(&nbsp;INIT&nbsp;COUNT&nbsp;=&nbsp;0&nbsp;FOR&nbsp;WA&nbsp;IN&nbsp;GT_DISPLAY2<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;(&nbsp;STATUS&nbsp;=&nbsp;'X'&nbsp;)&nbsp;NEXT&nbsp;COUNT&nbsp;=&nbsp;COUNT&nbsp;+&nbsp;1&nbsp;).<br />
**&nbsp;&nbsp;DATA(LV_COUNT3)&nbsp;=&nbsp;LINES(&nbsp;GT_DISPLAY2&nbsp;).<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;LV_COUNT2&nbsp;EQ&nbsp;LV_COUNT3.<br />
**<br />
***---&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;테이블&nbsp;STATUS에&nbsp;값&nbsp;저장&nbsp;로직<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;ZEA_SDT040<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
**<br />
***--&nbsp;판매&nbsp;오더&nbsp;헤더&nbsp;상태플래그에&nbsp;업데이트<br />
**&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_SDT040&nbsp;SET&nbsp;STATUS&nbsp;=&nbsp;'X'<br />
**&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;VBELN&nbsp;EQ&nbsp;ZEA_SDT040-VBELN.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;REFRESH&nbsp;GT_DATA.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SELECT&nbsp;*<br />
**&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
**&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
**&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
**&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DATA&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
**<br />
**&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;SELECT_DISPLAY_DATA.<br />
**<br />
***&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MODIFY_DISPLAY_DATA.<br />
***&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MAKE_DISPLAY_DATA.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
**&nbsp;&nbsp;PERFORM&nbsp;MODIFY_DISPLAY_DATA.<br />
**&nbsp;&nbsp;PERFORM&nbsp;REFRESH_ALV_0100.<br />
**<br />
**<br />
**&nbsp;&nbsp;IF&nbsp;LV_SUBRC&nbsp;EQ&nbsp;0.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;COMMIT&nbsp;WORK&nbsp;AND&nbsp;WAIT.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S015.&nbsp;"데이터가&nbsp;성공적으로&nbsp;저장되었습니다.<br />
**&nbsp;&nbsp;ELSE.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;ROLLBACK&nbsp;WORK.<br />
**&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S016&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.&nbsp;"데이터&nbsp;저장&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
**&nbsp;&nbsp;ENDIF.<br />
**<br />
***&nbsp;&nbsp;LV_MSG&nbsp;=&nbsp;|출고&nbsp;문서번호&nbsp;{&nbsp;PV_SBELNR&nbsp;}&nbsp;이&nbsp;생성되었습니다.|.<br />
***&nbsp;&nbsp;MESSAGE&nbsp;LV_MSG&nbsp;TYPE&nbsp;'S'.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_DISPLAY2_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DISPLAY2_DATA .<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;DATA&nbsp;LS_STYLE&nbsp;TYPE&nbsp;LVC_S_STYL.<br />
*<br />
*&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY2&nbsp;INTO&nbsp;GS_DISPLAY2.<br />
*<br />
**신규&nbsp;필드------------------------------------------------------------*<br />
*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-STATUS&nbsp;=&nbsp;'X'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY2-STATUS&nbsp;=&nbsp;'I'.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
*<br />
**--------------------------------------------------------------------*<br />
*&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY2&nbsp;FROM&nbsp;GS_DISPLAY2.<br />
*<br />
*&nbsp;&nbsp;ENDLOOP.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DATA2&nbsp;INTO&nbsp;GS_DATA2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CLEAR&nbsp;GS_DISPLAY2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MOVE-CORRESPONDING&nbsp;GS_DATA2&nbsp;TO&nbsp;GS_DISPLAY2.<br />
<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-STATUS&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY2-STATUS&nbsp;=&nbsp;''.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-SBELNR&nbsp;=&nbsp;ZEA_SDT060-SBELNR.<br />
<br />
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;GS_DISPLAY2&nbsp;TO&nbsp;GT_DISPLAY2.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY2&nbsp;BY&nbsp;ICON&nbsp;ASCENDING.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&<br />
*&&nbsp;&nbsp;아래는&nbsp;재고량&nbsp;검색을&nbsp;위한&nbsp;서브루틴들<br />
*&<br />
*&---------------------------------------------------------------------*<br />
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_OBJECT4_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_OBJECT4_0100 .<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_CONTAINER_4<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CONTAINER_NAME&nbsp;=&nbsp;'CCON4'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E020.&nbsp;"&nbsp;Custom&nbsp;Container&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;OBJECT&nbsp;GO_ALV_GRID_4<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_PARENT&nbsp;=&nbsp;GO_CONTAINER_4<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;NE&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E021.&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;생성&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_FIELDCAT4_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_FIELDCAT4_0100 .<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;GET_FIELDCAT4_0100&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;USING&nbsp;&nbsp;&nbsp;&nbsp;GT_DATA4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;GT_FIELDCAT4.<br />
<br />
&nbsp;&nbsp;PERFORM&nbsp;MAKE_FIELDCAT4_0100.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;GET_FIELDCAT4_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM GET_FIELDCAT4_0100  USING PT_TAB TYPE STANDARD TABLE<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING&nbsp;PT_FCAT&nbsp;TYPE&nbsp;LVC_T_FCAT.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LO_DREF&nbsp;TYPE&nbsp;REF&nbsp;TO&nbsp;DATA.<br />
<br />
&nbsp;&nbsp;CREATE&nbsp;DATA&nbsp;LO_DREF&nbsp;LIKE&nbsp;PT_TAB.<br />
&nbsp;&nbsp;FIELD-SYMBOLS&nbsp;&lt;LT_TAB&gt;&nbsp;TYPE&nbsp;TABLE.<br />
&nbsp;&nbsp;ASSIGN&nbsp;LO_DREF-&gt;*&nbsp;TO&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;TRY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;CL_SALV_TABLE=&gt;FACTORY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_SALV_TABLE&nbsp;=&nbsp;DATA(LR_TABLE)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T_TABLE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;&lt;LT_TAB&gt;.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CATCH&nbsp;CX_SALV_MSG.&nbsp;"&nbsp;ALV:&nbsp;General&nbsp;Error&nbsp;Class&nbsp;with&nbsp;Message<br />
&nbsp;&nbsp;ENDTRY.<br />
<br />
&nbsp;&nbsp;PT_FCAT&nbsp;=&nbsp;CL_SALV_CONTROLLER_METADATA=&gt;GET_LVC_FIELDCATALOG(<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_COLUMNS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LR_TABLE-&gt;GET_COLUMNS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R_AGGREGATIONS&nbsp;=&nbsp;LR_TABLE-&gt;GET_AGGREGATIONS(&nbsp;)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;).<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_FIELDCAT4_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_FIELDCAT4_0100 .<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_FIELDCAT4&nbsp;INTO&nbsp;GS_FIELDCAT4.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CASE&nbsp;GS_FIELDCAT4-FIELDNAME.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MATNR'.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT-COLTEXT&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'자재명'.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;0.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-NO_OUT&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MAKTX'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-EMPHASIZE&nbsp;=&nbsp;'C500'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WERKS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'PNAME1'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-EMPHASIZE&nbsp;=&nbsp;'C500'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SCODE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'CALQTY'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-QFIELDNAME&nbsp;=&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-EMPHASIZE&nbsp;=&nbsp;'C300'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'MEINS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;6.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'SUM_VALUE'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;7.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-CFIELDNAME&nbsp;=&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-NO_OUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHEN&nbsp;'WAERS'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-COL_POS&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;8.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_FIELDCAT4-NO_OUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.<br />
<br />
<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDCASE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_FIELDCAT4&nbsp;FROM&nbsp;GS_FIELDCAT4.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SET_ALV_LAYOUT4_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SET_ALV_LAYOUT4_0100 .<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_LAYOUT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_VARIANT.<br />
&nbsp;&nbsp;CLEAR&nbsp;GV_SAVE2.<br />
<br />
&nbsp;&nbsp;GS_VARIANT-REPORT&nbsp;=&nbsp;SY-REPID.<br />
&nbsp;&nbsp;GV_SAVE2&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;"&nbsp;''&nbsp;:&nbsp;Layout&nbsp;저장불가<br />
<br />
&nbsp;&nbsp;GS_LAYOUT-CWIDTH_OPT&nbsp;=&nbsp;'A'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;최적화<br />
&nbsp;&nbsp;GS_LAYOUT-ZEBRA&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ABAP_ON.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ZEBRA<br />
&nbsp;&nbsp;GS_LAYOUT-SEL_MODE&nbsp;&nbsp;&nbsp;=&nbsp;'B'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;열&nbsp;단위&nbsp;선택<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;GS_LAYOUT-GRID_TITLE&nbsp;=&nbsp;TEXT-T01.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;TITLE&nbsp;TEXT<br />
   </div>
   <div class="code">
&nbsp;&nbsp;GS_LAYOUT-INFO_FNAME&nbsp;=&nbsp;'COLOR'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;행&nbsp;색상<br />
&nbsp;&nbsp;GS_LAYOUT-STYLEFNAME&nbsp;=&nbsp;'STYLE'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;스타일<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DISPLAY_ALV4_0100<br />
*&---------------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
FORM DISPLAY_ALV4_0100 .<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_4-&gt;SET_TABLE_FOR_FIRST_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_VARIANT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_VARIANT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;I_SAVE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GV_SAVE2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IS_LAYOUT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GS_LAYOUT<br />
&nbsp;&nbsp;&nbsp;&nbsp;CHANGING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_OUTTAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_DATA4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IT_FIELDCATALOG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;GT_FIELDCAT4<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INVALID_PARAMETER_COMBINATION&nbsp;=&nbsp;1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PROGRAM_ERROR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TOO_MANY_LINES&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;4.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;ALV&nbsp;Grid&nbsp;에&nbsp;데이터를&nbsp;전달하는&nbsp;중&nbsp;오류가&nbsp;발생했습니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E023.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA_MMT190<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA_MMT190 .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~WERKS&nbsp;EQ&nbsp;A~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;C~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA4<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~MATNR&nbsp;LIKE&nbsp;'30%'.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재코드가&nbsp;30으로&nbsp;시작하는&nbsp;데이터만&nbsp;조회<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DATA4&nbsp;BY&nbsp;MATNR&nbsp;WERKS&nbsp;SCODE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA_CONDITION<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA_CONDITION .<br />
<br />
&nbsp;&nbsp;RANGES&nbsp;R_SCODE&nbsp;FOR&nbsp;ZEA_MMT190-SCODE.<br />
&nbsp;&nbsp;RANGES&nbsp;R_WERKS&nbsp;FOR&nbsp;ZEA_MMT190-WERKS.<br />
&nbsp;&nbsp;RANGES&nbsp;R_MATNR&nbsp;FOR&nbsp;ZEA_MMT190-MATNR.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;R_SCODE[].<br />
&nbsp;&nbsp;CLEAR&nbsp;R_SCODE.<br />
&nbsp;&nbsp;REFRESH&nbsp;R_WERKS[].<br />
&nbsp;&nbsp;CLEAR&nbsp;R_WERKS.<br />
&nbsp;&nbsp;REFRESH&nbsp;R_MATNR[].<br />
&nbsp;&nbsp;CLEAR&nbsp;R_MATNR.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZEA_MMT190-SCODE&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_SCODE-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_SCODE-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_SCODE-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_MMT190-SCODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_SCODE.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;ZEA_MMT190-WERKS&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_WERKS-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_WERKS-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_WERKS-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_MMT190-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_WERKS.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;ZEA_MMT190-MATNR&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_MATNR-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_MATNR-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_MATNR-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_MMT190-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_MATNR.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;ON&nbsp;B~WERKS&nbsp;EQ&nbsp;A~WERKS<br />
&nbsp;&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C<br />
&nbsp;&nbsp;ON&nbsp;C~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DATA4<br />
&nbsp;&nbsp;WHERE&nbsp;A~SCODE&nbsp;IN&nbsp;R_SCODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~WERKS&nbsp;IN&nbsp;R_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~MATNR&nbsp;IN&nbsp;R_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~MATNR&nbsp;LIKE&nbsp;'30%'.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DATA4&nbsp;BY&nbsp;MATNR&nbsp;WERKS&nbsp;SCODE.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;CLEAR&nbsp;ZEA_MMT190-MATNR.<br />
*&nbsp;&nbsp;CLEAR&nbsp;ZEA_MMT190-WERKS.<br />
*&nbsp;&nbsp;CLEAR&nbsp;ZEA_T001W-PNAME1.<br />
*&nbsp;&nbsp;CLEAR&nbsp;ZEA_MMT020-MAKTX.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;INVOICE_ING_FILTER<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM INVOICE_ING_FILTER .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_FILTER.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;GS_FILTER.<br />
&nbsp;&nbsp;GS_FILTER-FIELDNAME&nbsp;=&nbsp;'ICON'.<br />
&nbsp;&nbsp;GS_FILTER-SIGN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;GS_FILTER-OPTION&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;GS_FILTER-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;APPEND&nbsp;GS_FILTER&nbsp;TO&nbsp;GT_FILTER.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DATA_SDT040<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DATA_SDT040 .<br />
<br />
&nbsp;&nbsp;RANGES&nbsp;R_VBELN&nbsp;FOR&nbsp;ZEA_SDT050-VBELN.<br />
&nbsp;&nbsp;RANGES&nbsp;R_CUSCODE&nbsp;FOR&nbsp;ZEA_SDT040-CUSCODE.<br />
&nbsp;&nbsp;RANGES&nbsp;R_VDATU&nbsp;FOR&nbsp;ZEA_SDT040-VDATU.<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;R_VBELN[].<br />
&nbsp;&nbsp;CLEAR&nbsp;R_VBELN.<br />
&nbsp;&nbsp;REFRESH&nbsp;R_CUSCODE[].<br />
&nbsp;&nbsp;CLEAR&nbsp;R_CUSCODE.<br />
&nbsp;&nbsp;REFRESH&nbsp;R_VDATU[].<br />
&nbsp;&nbsp;CLEAR&nbsp;R_VDATU.<br />
<br />
&nbsp;&nbsp;IF&nbsp;ZEA_SDT050-VBELN&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_VBELN-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_VBELN-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_VBELN-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT050-VBELN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_VBELN.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;ZEA_SDT040-CUSCODE&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_CUSCODE-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_CUSCODE-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_CUSCODE-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-CUSCODE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_CUSCODE.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;IF&nbsp;ZEA_SDT040-VDATU&nbsp;IS&nbsp;NOT&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_VDATU-SIGN&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_VDATU-OPTION&nbsp;&nbsp;=&nbsp;'EQ'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;R_VDATU-LOW&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;ZEA_SDT040-VDATU.<br />
&nbsp;&nbsp;&nbsp;&nbsp;APPEND&nbsp;R_VDATU.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;JOIN&nbsp;ZEA_SDT050&nbsp;AS&nbsp;C<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~VBELN&nbsp;EQ&nbsp;C~VBELN<br />
   </div>
   <div class="code">
&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY<br />
&nbsp;WHERE&nbsp;A~VBELN&nbsp;&nbsp;&nbsp;IN&nbsp;R_VBELN<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;A~CUSCODE&nbsp;IN&nbsp;R_CUSCODE<br />
&nbsp;&nbsp;&nbsp;AND&nbsp;A~VDATU&nbsp;&nbsp;&nbsp;IN&nbsp;R_VDATU<br />
&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;A~STATUS2&nbsp;=&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MAKE_DISPLAY_DATA2<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MAKE_DISPLAY_DATA2 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STYLE&nbsp;TYPE&nbsp;LVC_S_STYL.<br />
<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
*&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY2.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MODIFY_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MODIFY_DISPLAY_DATA .<br />
<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LS_STYLE&nbsp;TYPE&nbsp;LVC_S_STYL.<br />
<br />
&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_DISPLAY&nbsp;INTO&nbsp;GS_DISPLAY.<br />
<br />
   </div>
   <div class="codeComment">
*신규&nbsp;필드------------------------------------------------------------*<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;'X'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_DISPLAY-STATUS&nbsp;=&nbsp;'I'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_YELLOW.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY-ICON&nbsp;=&nbsp;ICON_LED_RED.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="codeComment">
*--------------------------------------------------------------------*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DISPLAY&nbsp;FROM&nbsp;GS_DISPLAY.<br />
<br />
&nbsp;&nbsp;ENDLOOP.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SELECT_DISPLAY_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SELECT_DISPLAY_DATA .<br />
<br />
&nbsp;&nbsp;REFRESH&nbsp;GT_DISPLAY.<br />
<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT040&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_KNA1&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~CUSCODE&nbsp;EQ&nbsp;A~CUSCODE<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;GT_DISPLAY<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~STATUS2&nbsp;=&nbsp;'X'.<br />
<br />
<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_DISPLAY&nbsp;BY&nbsp;VBELN&nbsp;CUSCODE.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CREATE_DATA_0100<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CREATE_DATA_0100 .<br />
<br />
&nbsp;&nbsp;DATA&nbsp;LT_INDEX_ROWS&nbsp;TYPE&nbsp;LVC_T_ROW.<br />
&nbsp;&nbsp;DATA&nbsp;LS_INDEX_ROW&nbsp;&nbsp;TYPE&nbsp;LVC_S_ROW.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;METHOD&nbsp;GO_ALV_GRID_2-&gt;GET_SELECTED_ROWS<br />
&nbsp;&nbsp;&nbsp;&nbsp;IMPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ET_INDEX_ROWS&nbsp;=&nbsp;LT_INDEX_ROWS.<br />
<br />
&nbsp;&nbsp;IF&nbsp;LT_INDEX_ROWS[]&nbsp;IS&nbsp;INITIAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;아이템만&nbsp;한&nbsp;줄&nbsp;선택하도록&nbsp;안내<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;TEXT-M01:&nbsp;라인을&nbsp;선택하세요.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'W'&nbsp;WITH&nbsp;'최소&nbsp;한&nbsp;행이상&nbsp;선택하세요'.<br />
<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_INDEX_ROWS&nbsp;INTO&nbsp;LS_INDEX_ROW&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DISPLAY2&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_DISPLAY2&nbsp;&nbsp;INDEX&nbsp;LS_INDEX_ROW-INDEX.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-ICON&nbsp;EQ&nbsp;ICON_LED_GREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;이미&nbsp;생성된&nbsp;출고&nbsp;문서입니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;S032&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_MC_POPUP_CONFIRM&nbsp;'출고&nbsp;문서&nbsp;생성'&nbsp;'출고&nbsp;문서를&nbsp;생성하시겠습니까?'&nbsp;GV_ANSWER.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CHECK&nbsp;GV_ANSWER&nbsp;=&nbsp;'1'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;MOVE_DATA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;SCREEN&nbsp;0160&nbsp;STARTING&nbsp;AT&nbsp;50&nbsp;5.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;SBELNR_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM SBELNR_DATA .<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;A~STATUS,&nbsp;A~VBELN,&nbsp;A~POSNR,&nbsp;A~MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;C~MAKTX&nbsp;,A~AUQUA&nbsp;,A~MEINS&nbsp;,A~NETPR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;A~AUAMO&nbsp;,A~WAERS,&nbsp;B~SBELNR<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;D~SBELNR<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT050&nbsp;AS&nbsp;A&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;판매오더&nbsp;헤더<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;C&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;자재&nbsp;TEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;C~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;SPRAS&nbsp;EQ&nbsp;@SY-LANGU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEFT&nbsp;OUTER&nbsp;JOIN&nbsp;ZEA_SDT110&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~VBELN&nbsp;EQ&nbsp;A~VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;CORRESPONDING&nbsp;FIELDS&nbsp;OF&nbsp;TABLE&nbsp;@GT_DATA2<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~VBELN&nbsp;EQ&nbsp;@GS_DISPLAY-VBELN.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;GT_DATA2&nbsp;BY&nbsp;STATUS&nbsp;POSNR.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;MMT190_F4_HELP<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM MMT190_F4_HELP .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_RETURN_TAB&nbsp;TYPE&nbsp;DDSHRETVAL&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_RETURN_TAB&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_RETURN_TAB.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_DSELC&nbsp;TYPE&nbsp;DSELC&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DSELC&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_DSELC.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_VALUE&nbsp;&nbsp;TYPE&nbsp;SEAHLPRES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_VALUE&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;SEAHLPRES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_FIELD&nbsp;&nbsp;TYPE&nbsp;DFIES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDS&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;DFIES.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;BEGIN&nbsp;OF&nbsp;LT190_MATNR&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MATNR&nbsp;TYPE&nbsp;ZEA_MMT190-MATNR,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAKTX&nbsp;TYPE&nbsp;ZEA_MMT020-MAKTX,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LT190_MATNR.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_MAP&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;DSELC&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;LT190_MATNR,&nbsp;LT190_MATNR[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_VALUE,&nbsp;LT_VALUE[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDS,&nbsp;LT_FIELDS[].<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;DISTINCT&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~MAKTX<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT190_MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_MMT020&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;B~MATNR&nbsp;EQ&nbsp;A~MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;B~SPRAS&nbsp;EQ&nbsp;SY-LANGU<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;A~MATNR&nbsp;LIKE&nbsp;'30%'.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;LT190_MATNR&nbsp;BY&nbsp;MATNR.<br />
<br />
&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'F4IF_INT_TABLE_VALUE_REQUEST'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETFIELD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'MATNR'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;return&nbsp;field&nbsp;in&nbsp;FIELD_TAB<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPPROG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-REPID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Current&nbsp;program<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Screen&nbsp;number<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPROFIELD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_MMT010-MATNR'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'판가&nbsp;생성'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Title&nbsp;for&nbsp;the&nbsp;hit&nbsp;list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Value&nbsp;return:&nbsp;C:&nbsp;cell&nbsp;by&nbsp;cell,&nbsp;S:&nbsp;structured<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELD_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_FIELDS[]<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT190_MATNR[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Table&nbsp;of&nbsp;values:&nbsp;entries&nbsp;cell&nbsp;by&nbsp;cell<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_RETURN_TAB[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPFLD_MAPPING&nbsp;=&nbsp;LT_MAP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER_ERROR&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Incorrect&nbsp;parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_VALUES_FOUND&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;No&nbsp;values&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_RETURN_TAB&nbsp;INTO&nbsp;LS_RETURN_TAB&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT190-MATNR&nbsp;=&nbsp;LS_RETURN_TAB-FIELDVAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT190_MATNR&nbsp;WITH&nbsp;KEY&nbsp;MATNR&nbsp;=&nbsp;ZEA_MMT190-MATNR&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT190-MATNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT190_MATNR-MATNR.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT020-MAKTX&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT190_MATNR-MAKTX.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT010-STPRS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_MATNR-STPRS.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_SDT090-NETPR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_MATNR-STPRS&nbsp;*&nbsp;4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT010-WAERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_MATNR-WAERS.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DEC_TABLE_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DEC_TABLE_DATA .<br />
<br />
&nbsp;&nbsp;"&nbsp;삭제&nbsp;플래그&nbsp;값&nbsp;없는&nbsp;것들만&nbsp;조회하고&nbsp;배치번호로&nbsp;정렬<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;GS_MMT190<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;EQ&nbsp;ZEA_SDT050-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;ZEA_SDT060-WERKS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;LVORM&nbsp;EQ&nbsp;''.<br />
<br />
*&nbsp;&nbsp;SORT&nbsp;GT_MMT190&nbsp;BY&nbsp;CHARG.<br />
<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_MMT190&nbsp;INTO&nbsp;GS_MMT190<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;MATNR&nbsp;=&nbsp;ZEA_SDT050-MATNR<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;=&nbsp;ZEA_SDT060-WERKS.<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-AUQUA&nbsp;&gt;&nbsp;GS_MMT190-CALQTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E037.&nbsp;"&nbsp;재고가&nbsp;부족합니다.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;GS_MMT190-CALQTY&nbsp;=&nbsp;GS_MMT190-CALQTY&nbsp;-&nbsp;GS_DISPLAY2-AUQUA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_MMT190&nbsp;SET&nbsp;CALQTY&nbsp;=&nbsp;GS_MMT190-CALQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;ZEA_SDT050-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;ZEA_SDT060-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;"&nbsp;itab&nbsp;GS_DISPLAY4에도&nbsp;바로&nbsp;반영되게&nbsp;해야할듯.<br />
<br />
&nbsp;&nbsp;GS_DATA4-CALQTY&nbsp;=&nbsp;GS_MMT190-CALQTY.<br />
&nbsp;&nbsp;MODIFY&nbsp;GT_DATA4&nbsp;FROM&nbsp;GS_DATA4&nbsp;TRANSPORTING&nbsp;CALQTY&nbsp;WHERE&nbsp;WERKS&nbsp;EQ&nbsp;ZEA_SDT060-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;EQ&nbsp;GS_DISPLAY2-MATNR.<br />
   </div>
   <div class="codeComment">
*<br />
*&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_DATA4&nbsp;INTO&nbsp;GS_DATA4&nbsp;WITH&nbsp;KEY&nbsp;CALQTY&nbsp;=&nbsp;GS_DATA4-CALQTY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DATA4-CALQTY&nbsp;=&nbsp;GS_DATA4-CALQTY&nbsp;-&nbsp;GS_DISPLAY2-AUQUA.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MODIFY&nbsp;GT_DATA4&nbsp;FROM&nbsp;GS_DATA4&nbsp;TRANSPORTING&nbsp;CALQTY.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
<br />
*&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'SAPGUI_SET_FUNCTIONCODE'<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUNCTIONCODE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ENTE'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Function&nbsp;code<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FUNCTION_NOT_SUPPORTED&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Not&nbsp;supported&nbsp;on&nbsp;this&nbsp;front&nbsp;end&nbsp;platform<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;2<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;&lt;&gt;&nbsp;0.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;ID&nbsp;SY-MSGID&nbsp;TYPE&nbsp;SY-MSGTY&nbsp;NUMBER&nbsp;SY-MSGNO<br />
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;SY-MSGV1&nbsp;SY-MSGV2&nbsp;SY-MSGV3&nbsp;SY-MSGV4.<br />
*&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
   </div>
   <div class="code">
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;DEC_BATCH_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM DEC_BATCH_DATA .<br />
<br />
&nbsp;&nbsp;"&nbsp;삭제&nbsp;플래그&nbsp;값&nbsp;없는&nbsp;것들만&nbsp;조회하고&nbsp;배치번호로&nbsp;정렬<br />
&nbsp;&nbsp;SELECT&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT070<br />
&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;GT_MMT070<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;LVORM&nbsp;EQ&nbsp;''.<br />
<br />
&nbsp;&nbsp;SORT&nbsp;GT_MMT070&nbsp;BY&nbsp;CHARG.<br />
<br />
<br />
&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;GT_MMT070&nbsp;INTO&nbsp;GS_MMT070<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WITH&nbsp;KEY&nbsp;MATNR&nbsp;=&nbsp;ZEA_SDT050-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;=&nbsp;ZEA_SDT060-WERKS.<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;1.&nbsp;전체&nbsp;수량&nbsp;비교&nbsp;-&gt;&nbsp;IF<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-AUQUA&nbsp;&gt;&nbsp;GS_MMT190-CALQTY.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;GS_MMT190에&nbsp;DEC_TABLE_DATA를&nbsp;통해서&nbsp;값이&nbsp;들어가&nbsp;있음.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;E037.&nbsp;"&nbsp;재고가&nbsp;부족합니다.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;2.&nbsp;필요수량에서&nbsp;배치의&nbsp;보유&nbsp;수량만큼&nbsp;제거(보유&nbsp;수량이&nbsp;같거나&nbsp;적을&nbsp;때만&nbsp;제거)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;배치의&nbsp;보유수량이&nbsp;많으면&nbsp;필요한&nbsp;만큼만&nbsp;제거.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_MMT070-REMQTY&nbsp;GT&nbsp;GS_DISPLAY2-AUQUA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MMT070-REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY&nbsp;-&nbsp;GS_DISPLAY2-AUQUA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-AUQUA&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_MMT070&nbsp;SET&nbsp;REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;GS_MMT070-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;GS_MMT070-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CHARG&nbsp;=&nbsp;GS_MMT070-CHARG.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;배치번호&nbsp;제일&nbsp;빠른거&nbsp;읽어&nbsp;와서&nbsp;WHERE&nbsp;절에&nbsp;?<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_MMT070-REMQTY&nbsp;EQ&nbsp;GS_DISPLAY2-AUQUA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MMT070-REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY&nbsp;-&nbsp;GS_DISPLAY2-AUQUA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-AUQUA&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_MMT070&nbsp;SET&nbsp;REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVORM&nbsp;&nbsp;=&nbsp;'X'&nbsp;"&nbsp;배치번호&nbsp;제일&nbsp;빠른것&nbsp;'만'&nbsp;삭제<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;GS_MMT070-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;GS_MMT070-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CHARG&nbsp;=&nbsp;GS_MMT070-CHARG.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_MMT070-REMQTY&nbsp;LT&nbsp;GS_DISPLAY2-AUQUA.<br />
<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOOP&nbsp;AT&nbsp;GT_MMT070&nbsp;INTO&nbsp;GS_MMT070&nbsp;WHERE&nbsp;MATNR&nbsp;EQ&nbsp;GS_DISPLAY2-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;EQ&nbsp;ZEA_SDT060-WERKS.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;LOOP&nbsp;탈출을&nbsp;GS_DISPLAY2가&nbsp;0&nbsp;이&nbsp;됐을때&nbsp;탈출&nbsp;하게.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_DISPLAY2-AUQUA&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;LOOP를&nbsp;돌면서&nbsp;배치번호가&nbsp;다음으로&nbsp;넘어가게는&nbsp;어떻게?<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;SELECT&nbsp;를&nbsp;계속&nbsp;해줘야하나?&nbsp;LOOP안에&nbsp;SELECT는&nbsp;문제가&nbsp;많은데<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;GS_MMT070-REMQTY&nbsp;LT&nbsp;GS_DISPLAY2-AUQUA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-AUQUA&nbsp;=&nbsp;GS_DISPLAY2-AUQUA&nbsp;-&nbsp;GS_MMT070-REMQTY.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MMT070-REMQTY&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_MMT070&nbsp;SET&nbsp;REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVORM&nbsp;&nbsp;=&nbsp;'X'&nbsp;"&nbsp;배치번호&nbsp;제일&nbsp;빠른것&nbsp;'만'&nbsp;삭제<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;GS_MMT070-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;GS_MMT070-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CHARG&nbsp;=&nbsp;GS_MMT070-CHARG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LVORM&nbsp;NE&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_MMT070-REMQTY&nbsp;EQ&nbsp;GS_DISPLAY2-AUQUA.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MMT070-REMQTY&nbsp;=&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-AUQUA&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_MMT070&nbsp;SET&nbsp;REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LVORM&nbsp;&nbsp;=&nbsp;'X'&nbsp;"&nbsp;배치번호&nbsp;제일&nbsp;빠른것&nbsp;'만'&nbsp;삭제<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;GS_MMT070-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;GS_MMT070-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CHARG&nbsp;=&nbsp;GS_MMT070-CHARG<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;LVORM&nbsp;NE&nbsp;'X'.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;3.&nbsp;필요수량이&nbsp;0이&nbsp;아닌경우&nbsp;2의&nbsp;과정을&nbsp;반복<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;&nbsp;&nbsp;&nbsp;만약,&nbsp;필요수량이&nbsp;0인경우&nbsp;종료.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSEIF&nbsp;GS_MMT070-REMQTY&nbsp;GT&nbsp;GS_DISPLAY2-AUQUA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_MMT070-REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY&nbsp;-&nbsp;GS_DISPLAY2-AUQUA.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GS_DISPLAY2-AUQUA&nbsp;=&nbsp;0.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;UPDATE&nbsp;ZEA_MMT070&nbsp;SET&nbsp;REMQTY&nbsp;=&nbsp;GS_MMT070-REMQTY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AENAM&nbsp;&nbsp;=&nbsp;SY-UNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEDAT&nbsp;&nbsp;=&nbsp;SY-DATUM<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AEZET&nbsp;&nbsp;=&nbsp;SY-UZEIT<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;MATNR&nbsp;=&nbsp;GS_MMT070-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;=&nbsp;GS_MMT070-WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CHARG&nbsp;=&nbsp;GS_MMT070-CHARG.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDLOOP.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ELSE.<br />
<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;T001W_F4HELP<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM T001W_F4HELP .<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_RETURN_TAB&nbsp;TYPE&nbsp;DDSHRETVAL&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_RETURN_TAB&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_RETURN_TAB.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_DSELC&nbsp;TYPE&nbsp;DSELC&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_DSELC&nbsp;LIKE&nbsp;LINE&nbsp;OF&nbsp;LT_DSELC.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LS_VALUE&nbsp;&nbsp;TYPE&nbsp;SEAHLPRES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_VALUE&nbsp;&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;SEAHLPRES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LS_FIELD&nbsp;&nbsp;TYPE&nbsp;DFIES,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDS&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;DFIES.<br />
<br />
&nbsp;&nbsp;DATA&nbsp;:&nbsp;BEGIN&nbsp;OF&nbsp;LT001W_WERKS&nbsp;OCCURS&nbsp;0,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WERKS&nbsp;&nbsp;TYPE&nbsp;ZEA_MMT190-WERKS,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PNAME1&nbsp;TYPE&nbsp;ZEA_T001W-PNAME1,<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END&nbsp;OF&nbsp;LT001W_WERKS.<br />
<br />
&nbsp;&nbsp;DATA:&nbsp;LT_MAP&nbsp;TYPE&nbsp;TABLE&nbsp;OF&nbsp;DSELC&nbsp;WITH&nbsp;HEADER&nbsp;LINE.<br />
<br />
&nbsp;&nbsp;CLEAR&nbsp;:&nbsp;LT001W_WERKS,&nbsp;LT001W_WERKS[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_VALUE,&nbsp;LT_VALUE[],<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LT_FIELDS,&nbsp;LT_FIELDS[].<br />
<br />
&nbsp;&nbsp;SELECT&nbsp;A~WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;B~PNAME1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;INTO&nbsp;TABLE&nbsp;LT001W_WERKS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_MMT190&nbsp;AS&nbsp;A<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;JOIN&nbsp;ZEA_T001W&nbsp;&nbsp;AS&nbsp;B<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ON&nbsp;A~WERKS&nbsp;EQ&nbsp;B~WERKS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;SORT&nbsp;LT001W_WERKS&nbsp;BY&nbsp;WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;DELETE&nbsp;ADJACENT&nbsp;DUPLICATES&nbsp;FROM&nbsp;LT001W_WERKS&nbsp;COMPARING&nbsp;ALL&nbsp;FIELDS.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;CALL&nbsp;FUNCTION&nbsp;'F4IF_INT_TABLE_VALUE_REQUEST'<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXPORTING<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETFIELD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'WERKS'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Name&nbsp;of&nbsp;return&nbsp;field&nbsp;in&nbsp;FIELD_TAB<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPPROG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-REPID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Current&nbsp;program<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;SY-DYNNR&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Screen&nbsp;number<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPROFIELD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'ZEA_MMT010-MATNR'<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WINDOW_TITLE&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'플랜트&nbsp;선택'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Title&nbsp;for&nbsp;the&nbsp;hit&nbsp;list<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_ORG&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;'S'&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Value&nbsp;return:&nbsp;C:&nbsp;cell&nbsp;by&nbsp;cell,&nbsp;S:&nbsp;structured<br />
&nbsp;&nbsp;&nbsp;&nbsp;TABLES<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FIELD_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_FIELDS[]<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VALUE_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT001W_WERKS[]&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Table&nbsp;of&nbsp;values:&nbsp;entries&nbsp;cell&nbsp;by&nbsp;cell<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;RETURN_TAB&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT_RETURN_TAB[]<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DYNPFLD_MAPPING&nbsp;=&nbsp;LT_MAP<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;EXCEPTIONS<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PARAMETER_ERROR&nbsp;=&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;Incorrect&nbsp;parameter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;NO_VALUES_FOUND&nbsp;=&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"&nbsp;No&nbsp;values&nbsp;found<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;OTHERS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;3.<br />
<br />
&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT_RETURN_TAB&nbsp;INTO&nbsp;LS_RETURN_TAB&nbsp;INDEX&nbsp;1.<br />
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT190-WERKS&nbsp;=&nbsp;LS_RETURN_TAB-FIELDVAL.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ&nbsp;TABLE&nbsp;LT001W_WERKS&nbsp;WITH&nbsp;KEY&nbsp;WERKS&nbsp;=&nbsp;ZEA_MMT190-WERKS&nbsp;BINARY&nbsp;SEARCH.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_MMT190-WERKS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT001W_WERKS-WERKS.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ZEA_T001W-PNAME1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=&nbsp;LT001W_WERKS-PNAME1.<br />
<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LEAVE&nbsp;SCREEN.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
<br />
ENDFORM.<br />
   </div>
   <div class="codeComment">
*&---------------------------------------------------------------------*<br />
*&&nbsp;Form&nbsp;CHECK_DATA<br />
*&---------------------------------------------------------------------*<br />
   </div>
   <div class="code">
FORM CHECK_DATA .<br />
   </div>
   <div class="codeComment">
*<br />
   </div>
   <div class="code">
&nbsp;&nbsp;IF&nbsp;GV_LIST&nbsp;IS&nbsp;INITIAL.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;WITH&nbsp;'출고할&nbsp;플랜트&nbsp;위치를&nbsp;설정하세요.'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;EXIT.<br />
&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;SELECT&nbsp;SINGLE&nbsp;*<br />
&nbsp;&nbsp;&nbsp;&nbsp;FROM&nbsp;ZEA_SDT110<br />
&nbsp;&nbsp;&nbsp;&nbsp;WHERE&nbsp;SBELNR&nbsp;&nbsp;EQ&nbsp;ZEA_SDT060-SBELNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;MATNR&nbsp;&nbsp;&nbsp;EQ&nbsp;ZEA_SDT050-MATNR<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;VBELN&nbsp;&nbsp;&nbsp;EQ&nbsp;ZEA_SDT060-VBELN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;WERKS&nbsp;&nbsp;&nbsp;EQ&nbsp;ZEA_SDT060-WERKS.<br />
   </div>
   <div class="codeComment">
*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;AND&nbsp;CUSCODE&nbsp;EQ&nbsp;ZEA_SDT040-CUSCODE.<br />
<br />
   </div>
   <div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;SY-SUBRC&nbsp;EQ&nbsp;0.<br />
&nbsp;&nbsp;&nbsp;&nbsp;MESSAGE&nbsp;I000&nbsp;DISPLAY&nbsp;LIKE&nbsp;'E'&nbsp;WITH&nbsp;'동일한&nbsp;출고&nbsp;정보가&nbsp;존재합니다'.<br />
&nbsp;&nbsp;&nbsp;&nbsp;ELSE.<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;PERFORM&nbsp;CREATE_DATA.<br />
&nbsp;&nbsp;ENDIF.<br />
&nbsp;&nbsp;ENDIF.<br />
ENDFORM.<br />
            </div>
          </td>
        </tr>
      </table>
      </td>
      </tr>
   <tr>
<td class="footer">Extracted by Mass Download version 1.5.0 - E.G.Mellodew. 1998-2024. Sap Release 754</td>
   </tr>
</table>
</body>
</html>
